[0m20:50:02.946509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e72ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4215a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb470cc80>]}


============================== 20:50:02.953028 | e626ce2a-6a4e-4d40-bd2e-b07e685b3f64 ==============================
[0m20:50:02.953028 [info ] [MainThread]: Running with dbt=1.9.6
[0m20:50:02.953536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:02.955495 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m20:50:02.956285 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.04566917, "process_in_blocks": "8656", "process_kernel_time": 0.12023, "process_mem_max_rss": "103224", "process_out_blocks": "5154", "process_user_time": 1.732323}
[0m20:50:02.956706 [debug] [MainThread]: Command `dbt build` failed at 20:50:02.956588 after 0.05 seconds
[0m20:50:02.957076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3d0a750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb45332f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3e73920>]}
[0m20:50:02.957553 [debug] [MainThread]: Flushing usage events
[0m20:50:03.590142 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:53:49.039687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d66ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff916d1ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91ba4bf0>]}


============================== 20:53:49.045855 | ba83f05a-e998-4ac4-bc6c-1a39d50b7be5 ==============================
[0m20:53:49.045855 [info ] [MainThread]: Running with dbt=1.9.6
[0m20:53:49.046350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:53:49.048374 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'default'
[0m20:53:49.049150 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.043461625, "process_in_blocks": "0", "process_kernel_time": 0.095039, "process_mem_max_rss": "103356", "process_out_blocks": "5154", "process_user_time": 1.713714}
[0m20:53:49.049622 [debug] [MainThread]: Command `dbt build` failed at 20:53:49.049544 after 0.04 seconds
[0m20:53:49.049918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d66ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff917c5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92244050>]}
[0m20:53:49.050249 [debug] [MainThread]: Flushing usage events
[0m20:53:49.659572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:56:44.319019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e2aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9702db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9a97b00>]}


============================== 20:56:44.325163 | 6be6bae0-f75f-42e3-aeb2-61c03ae7f25b ==============================
[0m20:56:44.325163 [info ] [MainThread]: Running with dbt=1.9.6
[0m20:56:44.325658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:56:44.450833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb94c6420>]}
[0m20:56:44.486038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb935f230>]}
[0m20:56:44.486667 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:56:44.539490 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m20:56:44.540358 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:56:44.540702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90d11c0>]}
[0m20:56:45.104719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81cffb0>]}
[0m20:56:45.144897 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:56:45.148404 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:56:45.195115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81d8f50>]}
[0m20:56:45.195536 [info ] [MainThread]: Found 3 models, 433 macros
[0m20:56:45.197026 [info ] [MainThread]: 
[0m20:56:45.197444 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:56:45.197834 [info ] [MainThread]: 
[0m20:56:45.198340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:56:45.201136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_analytics'
[0m20:56:45.226275 [debug] [ThreadPool]: Using postgres connection "list_analytics"
[0m20:56:45.226633 [debug] [ThreadPool]: On list_analytics: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics"} */

    select distinct nspname from pg_namespace
  
[0m20:56:45.226874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:56:45.233482 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m20:56:45.234504 [debug] [ThreadPool]: On list_analytics: Close
[0m20:56:45.235143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_analytics, now create_analytics_car_sales_dbt_public)
[0m20:56:45.235527 [debug] [ThreadPool]: Creating schema "database: "analytics"
schema: "car_sales_dbt_public"
"
[0m20:56:45.241144 [debug] [ThreadPool]: Using postgres connection "create_analytics_car_sales_dbt_public"
[0m20:56:45.241464 [debug] [ThreadPool]: On create_analytics_car_sales_dbt_public: BEGIN
[0m20:56:45.241721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:45.245678 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:56:45.245974 [debug] [ThreadPool]: Using postgres connection "create_analytics_car_sales_dbt_public"
[0m20:56:45.246284 [debug] [ThreadPool]: On create_analytics_car_sales_dbt_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_analytics_car_sales_dbt_public"} */
create schema if not exists "car_sales_dbt_public"
[0m20:56:45.246905 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m20:56:45.247636 [debug] [ThreadPool]: On create_analytics_car_sales_dbt_public: COMMIT
[0m20:56:45.247910 [debug] [ThreadPool]: Using postgres connection "create_analytics_car_sales_dbt_public"
[0m20:56:45.248154 [debug] [ThreadPool]: On create_analytics_car_sales_dbt_public: COMMIT
[0m20:56:45.248758 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m20:56:45.249013 [debug] [ThreadPool]: On create_analytics_car_sales_dbt_public: Close
[0m20:56:45.250173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_analytics_car_sales_dbt_public, now list_analytics_car_sales_dbt_public)
[0m20:56:45.292326 [debug] [ThreadPool]: Using postgres connection "list_analytics_car_sales_dbt_public"
[0m20:56:45.292778 [debug] [ThreadPool]: On list_analytics_car_sales_dbt_public: BEGIN
[0m20:56:45.293052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:56:45.297237 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:56:45.297548 [debug] [ThreadPool]: Using postgres connection "list_analytics_car_sales_dbt_public"
[0m20:56:45.298127 [debug] [ThreadPool]: On list_analytics_car_sales_dbt_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_analytics_car_sales_dbt_public"} */
select
      'analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'car_sales_dbt_public'
    union all
    select
      'analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'car_sales_dbt_public'
    union all
    select
      'analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'car_sales_dbt_public'
  
[0m20:56:45.300236 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:56:45.301176 [debug] [ThreadPool]: On list_analytics_car_sales_dbt_public: ROLLBACK
[0m20:56:45.301711 [debug] [ThreadPool]: On list_analytics_car_sales_dbt_public: Close
[0m20:56:45.305509 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.305811 [debug] [MainThread]: On master: BEGIN
[0m20:56:45.306060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:56:45.309774 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:56:45.310111 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.310448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:56:45.312396 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m20:56:45.313197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbad63e00>]}
[0m20:56:45.313570 [debug] [MainThread]: On master: ROLLBACK
[0m20:56:45.313909 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.314152 [debug] [MainThread]: On master: BEGIN
[0m20:56:45.314569 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:56:45.314865 [debug] [MainThread]: On master: COMMIT
[0m20:56:45.315089 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.315302 [debug] [MainThread]: On master: COMMIT
[0m20:56:45.315623 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:45.315901 [debug] [MainThread]: On master: Close
[0m20:56:45.320280 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m20:56:45.320714 [info ] [Thread-1 (]: 1 of 3 START sql view model car_sales_dbt_public.stg_car_sales ................. [RUN]
[0m20:56:45.321116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_analytics_car_sales_dbt_public, now model.car_sales_dbt.stg_car_sales)
[0m20:56:45.321628 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m20:56:45.326873 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m20:56:45.328731 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m20:56:45.353259 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m20:56:45.354894 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:56:45.355187 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m20:56:45.355460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:56:45.359592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:56:45.359959 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:56:45.360246 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "analytics"."car_sales_dbt_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m20:56:45.360718 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "public.car_sales" does not exist
LINE 12:   public.car_sales
           ^

[0m20:56:45.361062 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m20:56:45.361603 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m20:56:45.364413 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "public.car_sales" does not exist
  LINE 12:   public.car_sales
             ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m20:56:45.365784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6be6bae0-f75f-42e3-aeb2-61c03ae7f25b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8141280>]}
[0m20:56:45.366530 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model car_sales_dbt_public.stg_car_sales ........ [[31mERROR[0m in 0.04s]
[0m20:56:45.367154 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m20:56:45.367686 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "public.car_sales" does not exist
  LINE 12:   public.car_sales
             ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m20:56:45.368670 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m20:56:45.369015 [info ] [Thread-1 (]: 2 of 3 SKIP relation car_sales_dbt_public.dim_car .............................. [[33mSKIP[0m]
[0m20:56:45.369367 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m20:56:45.369656 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m20:56:45.369874 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m20:56:45.370169 [info ] [Thread-1 (]: 3 of 3 SKIP relation car_sales_dbt_public.fact_sales ........................... [[33mSKIP[0m]
[0m20:56:45.370720 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m20:56:45.371003 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m20:56:45.371852 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.372114 [debug] [MainThread]: On master: BEGIN
[0m20:56:45.372347 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:56:45.376220 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:56:45.376519 [debug] [MainThread]: On master: COMMIT
[0m20:56:45.376845 [debug] [MainThread]: Using postgres connection "master"
[0m20:56:45.377159 [debug] [MainThread]: On master: COMMIT
[0m20:56:45.377526 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:56:45.377791 [debug] [MainThread]: On master: Close
[0m20:56:45.378112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:56:45.378345 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m20:56:45.378656 [info ] [MainThread]: 
[0m20:56:45.378963 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m20:56:45.379852 [debug] [MainThread]: Command end result
[0m20:56:45.398206 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:56:45.399593 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:56:45.403649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:56:45.403869 [info ] [MainThread]: 
[0m20:56:45.404111 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m20:56:45.404385 [info ] [MainThread]: 
[0m20:56:45.404735 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "public.car_sales" does not exist
  LINE 12:   public.car_sales
             ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m20:56:45.405122 [info ] [MainThread]: 
[0m20:56:45.405595 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m20:56:45.406651 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1230404, "process_in_blocks": "3800", "process_kernel_time": 0.133024, "process_mem_max_rss": "123588", "process_out_blocks": "8115", "process_user_time": 2.679503}
[0m20:56:45.406964 [debug] [MainThread]: Command `dbt build` failed at 20:56:45.406907 after 1.12 seconds
[0m20:56:45.407311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81c41a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ddd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90d1a90>]}
[0m20:56:45.407659 [debug] [MainThread]: Flushing usage events
[0m20:56:45.986890 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:15.119806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00dea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f77af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00dce90>]}


============================== 20:58:15.125979 | 33e2d36c-9b59-4c76-94cb-10005ce6c64a ==============================
[0m20:58:15.125979 [info ] [MainThread]: Running with dbt=1.9.6
[0m20:58:15.126507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:58:15.227170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cea4e0>]}
[0m20:58:15.262174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f6498e0>]}
[0m20:58:15.262758 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m20:58:15.311379 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m20:58:15.354985 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m20:58:15.355493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f981ac0>]}
[0m20:58:15.912755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e5262d0>]}
[0m20:58:15.952427 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:58:15.956056 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:58:15.999235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1d3590>]}
[0m20:58:15.999641 [info ] [MainThread]: Found 3 models, 433 macros
[0m20:58:16.001113 [info ] [MainThread]: 
[0m20:58:16.001445 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:58:16.001769 [info ] [MainThread]: 
[0m20:58:16.002215 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:58:16.005088 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m20:58:16.069910 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m20:58:16.070385 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:58:16.070675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:58:16.075775 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m20:58:16.076808 [debug] [ThreadPool]: On list_staging: Close
[0m20:58:16.077434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m20:58:16.077822 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m20:58:16.081719 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m20:58:16.081999 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m20:58:16.082246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:16.085858 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m20:58:16.086136 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m20:58:16.086465 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m20:58:16.087013 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m20:58:16.087719 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m20:58:16.087999 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m20:58:16.088251 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m20:58:16.089113 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m20:58:16.089461 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m20:58:16.090480 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m20:58:16.094591 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m20:58:16.094869 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m20:58:16.095113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:58:16.098478 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m20:58:16.098760 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m20:58:16.099035 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m20:58:16.101090 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m20:58:16.101866 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m20:58:16.102195 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m20:58:16.105127 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.105404 [debug] [MainThread]: On master: BEGIN
[0m20:58:16.105651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:58:16.109060 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m20:58:16.109355 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.109677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:58:16.125354 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m20:58:16.126197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e8ba270>]}
[0m20:58:16.126568 [debug] [MainThread]: On master: ROLLBACK
[0m20:58:16.126902 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.127141 [debug] [MainThread]: On master: BEGIN
[0m20:58:16.127550 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m20:58:16.127833 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.128082 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.128316 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.128613 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:16.128852 [debug] [MainThread]: On master: Close
[0m20:58:16.131719 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m20:58:16.132122 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.stg_car_sales ........................ [RUN]
[0m20:58:16.132628 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m20:58:16.132943 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m20:58:16.138095 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.139682 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m20:58:16.163168 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.164186 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.164483 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m20:58:16.164751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:16.168581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:58:16.168915 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.169253 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m20:58:16.170562 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m20:58:16.175339 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.175645 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m20:58:16.176200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:58:16.187411 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m20:58:16.187740 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.188022 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m20:58:16.188913 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m20:58:16.192942 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m20:58:16.196077 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m20:58:16.196386 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m20:58:16.196755 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m20:58:16.198385 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m20:58:16.199555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1ca570>]}
[0m20:58:16.200024 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public_public.stg_car_sales ................... [[32mCREATE VIEW[0m in 0.07s]
[0m20:58:16.200812 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m20:58:16.201664 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m20:58:16.202025 [info ] [Thread-1 (]: 2 of 3 START sql table model public_public.dim_car ............................. [RUN]
[0m20:58:16.202408 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now model.car_sales_dbt.dim_car)
[0m20:58:16.202715 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m20:58:16.205003 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m20:58:16.205872 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m20:58:16.220956 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m20:58:16.221765 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m20:58:16.222036 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m20:58:16.222313 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:16.226203 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:58:16.226610 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m20:58:16.226938 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  
    

  create  table "staging"."public_public"."dim_car__dbt_tmp"
  
  
    as
  
  (
    

select distinct
  make    as car_make,
  model   as car_model,
  year    as car_year,
  fuelType as car_fuel
from "staging"."public_public"."stg_car_sales"
  );
  
[0m20:58:16.227514 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 15:   make    as car_make,
           ^

[0m20:58:16.228005 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m20:58:16.228531 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m20:58:16.231224 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  column "make" does not exist
  LINE 15:   make    as car_make,
             ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m20:58:16.231690 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3e7a40>]}
[0m20:58:16.232201 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model public_public.dim_car .................... [[31mERROR[0m in 0.03s]
[0m20:58:16.232673 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m20:58:16.233203 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m20:58:16.233816 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  column "make" does not exist
  LINE 15:   make    as car_make,
             ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m20:58:16.234224 [info ] [Thread-1 (]: 3 of 3 START sql table model public_public.fact_sales .......................... [RUN]
[0m20:58:16.235650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m20:58:16.236009 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m20:58:16.238666 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m20:58:16.239574 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m20:58:16.241852 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m20:58:16.242623 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m20:58:16.242890 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m20:58:16.243147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:58:16.247078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m20:58:16.247565 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m20:58:16.247846 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m20:58:16.248398 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m20:58:16.248716 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m20:58:16.249288 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m20:58:16.251546 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m20:58:16.252064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33e2d36c-9b59-4c76-94cb-10005ce6c64a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cd03fe0>]}
[0m20:58:16.252724 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model public_public.fact_sales ................. [[31mERROR[0m in 0.02s]
[0m20:58:16.253523 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m20:58:16.253958 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m20:58:16.255169 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.255456 [debug] [MainThread]: On master: BEGIN
[0m20:58:16.255720 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:58:16.259615 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m20:58:16.259944 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.260178 [debug] [MainThread]: Using postgres connection "master"
[0m20:58:16.260435 [debug] [MainThread]: On master: COMMIT
[0m20:58:16.260766 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:58:16.261067 [debug] [MainThread]: On master: Close
[0m20:58:16.261396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:58:16.261626 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m20:58:16.261935 [info ] [MainThread]: 
[0m20:58:16.262208 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:58:16.263076 [debug] [MainThread]: Command end result
[0m20:58:16.280857 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m20:58:16.282418 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m20:58:16.286735 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m20:58:16.286989 [info ] [MainThread]: 
[0m20:58:16.287295 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m20:58:16.287660 [info ] [MainThread]: 
[0m20:58:16.288001 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  column "make" does not exist
  LINE 15:   make    as car_make,
             ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m20:58:16.288698 [info ] [MainThread]: 
[0m20:58:16.289081 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m20:58:16.289541 [info ] [MainThread]: 
[0m20:58:16.290002 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m20:58:16.290866 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2062452, "process_in_blocks": "0", "process_kernel_time": 0.144491, "process_mem_max_rss": "124188", "process_out_blocks": "8135", "process_user_time": 2.771419}
[0m20:58:16.291235 [debug] [MainThread]: Command `dbt build` failed at 20:58:16.291170 after 1.21 seconds
[0m20:58:16.291634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f78d7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9b7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f90e660>]}
[0m20:58:16.292188 [debug] [MainThread]: Flushing usage events
[0m20:58:16.892925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:07:08.773265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35c5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa34f2f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa346d400>]}


============================== 21:07:08.779720 | acbcbc51-eb62-4c80-8ad6-37df6c79b998 ==============================
[0m21:07:08.779720 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:07:08.780200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:07:08.882898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'acbcbc51-eb62-4c80-8ad6-37df6c79b998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa25f2120>]}
[0m21:07:08.919390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'acbcbc51-eb62-4c80-8ad6-37df6c79b998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa35766f0>]}
[0m21:07:08.920140 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:07:08.971157 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:07:09.026731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m21:07:09.027217 [debug] [MainThread]: Partial parsing: added file: car_sales_dbt://models/schema.yml
[0m21:07:09.027510 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:07:09.027793 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:07:09.028054 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:07:09.275723 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.car_sales_dbt.stg_car_sales' (models/stg_car_sales.sql) depends on a source named 'staging.car_sales' which was not found
[0m21:07:09.276774 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.538305, "process_in_blocks": "0", "process_kernel_time": 0.127175, "process_mem_max_rss": "115840", "process_out_blocks": "5157", "process_user_time": 2.179002}
[0m21:07:09.277216 [debug] [MainThread]: Command `dbt build` failed at 21:07:09.277111 after 0.54 seconds
[0m21:07:09.277584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3675eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa203fc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa203fcb0>]}
[0m21:07:09.277928 [debug] [MainThread]: Flushing usage events
[0m21:07:09.940962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:13:58.362030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84c03bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84a4d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84647e60>]}


============================== 21:13:58.368357 | 4daa6296-3cd0-47cf-a48a-827f1708a9d2 ==============================
[0m21:13:58.368357 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:13:58.368867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:13:58.470971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86182960>]}
[0m21:13:58.506384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843e9a30>]}
[0m21:13:58.507072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:13:58.556808 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:13:58.613718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m21:13:58.614288 [debug] [MainThread]: Partial parsing: added file: car_sales_dbt://models/schema.yml
[0m21:13:58.614660 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:13:58.615058 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:13:58.615433 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:13:58.967220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83328440>]}
[0m21:13:59.028886 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:13:59.032732 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:13:59.077193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f8da30>]}
[0m21:13:59.077599 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:13:59.079428 [info ] [MainThread]: 
[0m21:13:59.079750 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:13:59.080100 [info ] [MainThread]: 
[0m21:13:59.080577 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:13:59.083353 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:13:59.105762 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:13:59.106132 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:13:59.106396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:13:59.111314 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:13:59.112178 [debug] [ThreadPool]: On list_staging: Close
[0m21:13:59.112755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:13:59.113167 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:13:59.116945 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:13:59.117210 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:13:59.117449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:59.121107 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:13:59.121626 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:13:59.122025 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:13:59.122691 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:13:59.123387 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:13:59.123646 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:13:59.123899 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:13:59.124575 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:13:59.124812 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:13:59.125852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:13:59.130174 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:13:59.130445 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:13:59.130660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:13:59.134279 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:13:59.134592 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:13:59.134929 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:13:59.137063 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:13:59.137969 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:13:59.138318 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:13:59.141485 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.141744 [debug] [MainThread]: On master: BEGIN
[0m21:13:59.141999 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:13:59.145439 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:13:59.145689 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.146074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:13:59.161968 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:13:59.162828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f861e0>]}
[0m21:13:59.163202 [debug] [MainThread]: On master: ROLLBACK
[0m21:13:59.163534 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.163765 [debug] [MainThread]: On master: BEGIN
[0m21:13:59.164165 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:13:59.164454 [debug] [MainThread]: On master: COMMIT
[0m21:13:59.164696 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.164934 [debug] [MainThread]: On master: COMMIT
[0m21:13:59.165252 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:59.165488 [debug] [MainThread]: On master: Close
[0m21:13:59.168326 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:13:59.168725 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:13:59.169102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:13:59.169403 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:13:59.174838 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:13:59.178708 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:13:59.204221 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:13:59.205467 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:13:59.205781 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:13:59.206071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:13:59.210190 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:13:59.210508 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:13:59.210866 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        manufacturer       as make,
        model,
        sales_in_thousands as sales_thousands,
        __year_resale_value as resale_value_after_1y,
        vehicle_type,
        price_in_thousands  as price_thousands,
        engine_size,
        horsepower,
        wheelbase,
        width,
        length,
        curb_weight,
        fuel_capacity,
        fuel_efficiency,
        to_date(latest_launch, 'MM/DD/YYYY') as launch_date,
        power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m21:13:59.211435 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "manufacturer" does not exist
LINE 12:         manufacturer       as make,
                 ^
HINT:  Perhaps you meant to reference the column "car_sales.Manufacturer".

[0m21:13:59.211758 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:13:59.212407 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:13:59.215288 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "manufacturer" does not exist
  LINE 12:         manufacturer       as make,
                   ^
  HINT:  Perhaps you meant to reference the column "car_sales.Manufacturer".
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:13:59.216734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4daa6296-3cd0-47cf-a48a-827f1708a9d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850a4680>]}
[0m21:13:59.217677 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.stg_car_sales .............. [[31mERROR[0m in 0.05s]
[0m21:13:59.218458 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:13:59.218978 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "manufacturer" does not exist
  LINE 12:         manufacturer       as make,
                   ^
  HINT:  Perhaps you meant to reference the column "car_sales.Manufacturer".
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:13:59.220010 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:13:59.220387 [info ] [Thread-1 (]: 2 of 14 SKIP test not_null_stg_car_sales_make .................................. [[33mSKIP[0m]
[0m21:13:59.220722 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:13:59.221185 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:13:59.221449 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m21:13:59.221769 [info ] [Thread-1 (]: 3 of 14 SKIP test not_null_stg_car_sales_model ................................. [[33mSKIP[0m]
[0m21:13:59.222418 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:13:59.222694 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:13:59.222969 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m21:13:59.223286 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_stg_car_sales_year .................................. [[33mSKIP[0m]
[0m21:13:59.224045 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:13:59.224414 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5' to be skipped because of status 'skipped'. 
[0m21:13:59.225119 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:13:59.225412 [info ] [Thread-1 (]: 5 of 14 SKIP relation public_public.dim_car .................................... [[33mSKIP[0m]
[0m21:13:59.225767 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:13:59.226205 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:13:59.226419 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m21:13:59.226690 [info ] [Thread-1 (]: 6 of 14 SKIP relation public_public.fact_sales ................................. [[33mSKIP[0m]
[0m21:13:59.227486 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:13:59.227785 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:13:59.228020 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m21:13:59.228283 [info ] [Thread-1 (]: 7 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m21:13:59.229020 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:13:59.229358 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:13:59.229575 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m21:13:59.229831 [info ] [Thread-1 (]: 8 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m21:13:59.230338 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:13:59.230640 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:13:59.230875 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m21:13:59.231149 [info ] [Thread-1 (]: 9 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m21:13:59.231618 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:13:59.231907 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:13:59.232136 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m21:13:59.232398 [info ] [Thread-1 (]: 10 of 14 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m21:13:59.232945 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:13:59.233225 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:13:59.233427 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m21:13:59.233675 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m21:13:59.234158 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:13:59.234487 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:13:59.234696 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m21:13:59.234953 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m21:13:59.235430 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:13:59.235755 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:13:59.235978 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m21:13:59.236225 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m21:13:59.236735 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:13:59.237028 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:13:59.237242 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m21:13:59.237490 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m21:13:59.237973 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:13:59.238232 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m21:13:59.239125 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.239410 [debug] [MainThread]: On master: BEGIN
[0m21:13:59.239634 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:13:59.243634 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:13:59.244064 [debug] [MainThread]: On master: COMMIT
[0m21:13:59.244370 [debug] [MainThread]: Using postgres connection "master"
[0m21:13:59.244593 [debug] [MainThread]: On master: COMMIT
[0m21:13:59.244898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:13:59.245129 [debug] [MainThread]: On master: Close
[0m21:13:59.245439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:13:59.245655 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:13:59.245965 [info ] [MainThread]: 
[0m21:13:59.246338 [info ] [MainThread]: Finished running 2 table models, 11 data tests, 1 view model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m21:13:59.247199 [debug] [MainThread]: Command end result
[0m21:13:59.266405 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:13:59.267871 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:13:59.272113 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:13:59.272385 [info ] [MainThread]: 
[0m21:13:59.272661 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:13:59.273238 [info ] [MainThread]: 
[0m21:13:59.273612 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "manufacturer" does not exist
  LINE 12:         manufacturer       as make,
                   ^
  HINT:  Perhaps you meant to reference the column "car_sales.Manufacturer".
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:13:59.274134 [info ] [MainThread]: 
[0m21:13:59.274458 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=13 TOTAL=14
[0m21:13:59.275305 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9482962, "process_in_blocks": "0", "process_kernel_time": 0.165827, "process_mem_max_rss": "129168", "process_out_blocks": "8331", "process_user_time": 2.511383}
[0m21:13:59.275644 [debug] [MainThread]: Command `dbt build` failed at 21:13:59.275583 after 0.95 seconds
[0m21:13:59.275987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84eae960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff837435f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84778e60>]}
[0m21:13:59.276305 [debug] [MainThread]: Flushing usage events
[0m21:13:59.895758 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:04.593133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb99770e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9977080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9974140>]}


============================== 21:16:04.599346 | b28b5104-a9c3-4bc4-8402-a704679acc30 ==============================
[0m21:16:04.599346 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:16:04.599857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:16:04.700950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb888c7d0>]}
[0m21:16:04.736030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb87276b0>]}
[0m21:16:04.736629 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:04.785941 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:16:04.867144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:04.867700 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:16:05.132227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f671a0>]}
[0m21:16:05.191665 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:16:05.195208 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:16:05.239060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93daa50>]}
[0m21:16:05.239490 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:16:05.241496 [info ] [MainThread]: 
[0m21:16:05.241843 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:05.242168 [info ] [MainThread]: 
[0m21:16:05.242601 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:05.245494 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:16:05.267027 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:16:05.267376 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:16:05.267641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:05.272566 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:16:05.273471 [debug] [ThreadPool]: On list_staging: Close
[0m21:16:05.274059 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:16:05.274511 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:16:05.278434 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:05.278737 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:16:05.278994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:05.282750 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.283224 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:05.283533 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:16:05.284220 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:16:05.284965 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:16:05.285242 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:05.285487 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:16:05.286105 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:16:05.286357 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:16:05.287386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:16:05.291565 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:16:05.291828 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:16:05.292085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:05.295565 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:16:05.295862 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:16:05.296205 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:16:05.298288 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:16:05.299181 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:16:05.299528 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:16:05.303057 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.303323 [debug] [MainThread]: On master: BEGIN
[0m21:16:05.303563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:05.307265 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.307558 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.307905 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:05.323752 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:16:05.324623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7fe0320>]}
[0m21:16:05.324994 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:05.325330 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.325566 [debug] [MainThread]: On master: BEGIN
[0m21:16:05.325978 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:16:05.326257 [debug] [MainThread]: On master: COMMIT
[0m21:16:05.326504 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.326727 [debug] [MainThread]: On master: COMMIT
[0m21:16:05.327049 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:05.327282 [debug] [MainThread]: On master: Close
[0m21:16:05.330083 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:16:05.330526 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:16:05.330899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:16:05.331215 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:16:05.336676 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.337917 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:16:05.363606 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.364912 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.365247 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:16:05.365523 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:05.369734 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.370118 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.370472 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m21:16:05.372066 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:16:05.376673 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.376968 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m21:16:05.377566 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:16:05.387481 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:16:05.387776 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.388014 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:16:05.388675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:16:05.392883 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m21:16:05.396106 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:05.396385 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m21:16:05.396754 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:16:05.398448 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:16:05.399696 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b28b5104-a9c3-4bc4-8402-a704679acc30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6bbeb10>]}
[0m21:16:05.400214 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.07s]
[0m21:16:05.400675 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:16:05.401487 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:05.401792 [info ] [Thread-1 (]: 2 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m21:16:05.402186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m21:16:05.402465 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:05.410434 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:05.411625 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:05.423545 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:05.424921 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:05.425221 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m21:16:05.425491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:05.429417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.429706 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:05.430021 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m21:16:05.431108 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:05.433523 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m21:16:05.433942 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m21:16:05.434487 [info ] [Thread-1 (]: 2 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m21:16:05.434972 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:05.435618 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:05.436145 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m21:16:05.436541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m21:16:05.436843 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:05.440451 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:05.441370 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:05.443059 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:05.443888 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:05.444172 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m21:16:05.444431 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:05.448100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.448541 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:05.448809 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m21:16:05.449722 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:05.450764 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m21:16:05.451093 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m21:16:05.451495 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m21:16:05.451948 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:05.452489 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:05.452808 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m21:16:05.453485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m21:16:05.453805 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:05.456791 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:05.457683 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:05.460463 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:05.461295 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:05.461544 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m21:16:05.461765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:05.465511 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.466031 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:05.466291 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m21:16:05.466914 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "year" does not exist
LINE 16: select year
                ^

[0m21:16:05.467364 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m21:16:05.468161 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m21:16:05.471260 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_year (models/schema.yml)
  column "year" does not exist
  LINE 16: select year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_year.sql
[0m21:16:05.471723 [error] [Thread-1 (]: 4 of 14 ERROR not_null_stg_car_sales_year ...................................... [[31mERROR[0m in 0.02s]
[0m21:16:05.472455 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:05.472990 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_year (models/schema.yml)
  column "year" does not exist
  LINE 16: select year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_year.sql.
[0m21:16:05.474125 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:16:05.474504 [info ] [Thread-1 (]: 5 of 14 SKIP relation public_public.dim_car .................................... [[33mSKIP[0m]
[0m21:16:05.474958 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:16:05.475352 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:16:05.475667 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m21:16:05.475986 [info ] [Thread-1 (]: 6 of 14 SKIP relation public_public.fact_sales ................................. [[33mSKIP[0m]
[0m21:16:05.476943 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:16:05.477346 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:05.477581 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m21:16:05.477846 [info ] [Thread-1 (]: 7 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m21:16:05.478585 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:05.478883 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:05.479123 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m21:16:05.479411 [info ] [Thread-1 (]: 8 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m21:16:05.480079 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:05.480377 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:05.480589 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m21:16:05.480855 [info ] [Thread-1 (]: 9 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m21:16:05.481360 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:05.481633 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:05.481837 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m21:16:05.482112 [info ] [Thread-1 (]: 10 of 14 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m21:16:05.482580 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:05.482877 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:05.483103 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m21:16:05.483370 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m21:16:05.484160 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:05.484458 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:05.484691 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m21:16:05.484974 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m21:16:05.485470 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:05.485823 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:05.486075 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m21:16:05.486351 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m21:16:05.486860 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:05.487148 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:05.487350 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m21:16:05.487611 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m21:16:05.488125 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:05.488406 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m21:16:05.489340 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.489596 [debug] [MainThread]: On master: BEGIN
[0m21:16:05.489832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:05.493774 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:16:05.494298 [debug] [MainThread]: On master: COMMIT
[0m21:16:05.494567 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:05.494804 [debug] [MainThread]: On master: COMMIT
[0m21:16:05.495132 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:05.495365 [debug] [MainThread]: On master: Close
[0m21:16:05.495680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:05.495912 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5' was properly closed.
[0m21:16:05.496226 [info ] [MainThread]: 
[0m21:16:05.496498 [info ] [MainThread]: Finished running 2 table models, 11 data tests, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m21:16:05.497589 [debug] [MainThread]: Command end result
[0m21:16:05.516188 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:16:05.517644 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:16:05.522011 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:16:05.522274 [info ] [MainThread]: 
[0m21:16:05.522572 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:16:05.523287 [info ] [MainThread]: 
[0m21:16:05.523989 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_year (models/schema.yml)
  column "year" does not exist
  LINE 16: select year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_year.sql
[0m21:16:05.524435 [info ] [MainThread]: 
[0m21:16:05.524864 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=10 TOTAL=14
[0m21:16:05.526362 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9679709, "process_in_blocks": "0", "process_kernel_time": 0.127261, "process_mem_max_rss": "128452", "process_out_blocks": "8362", "process_user_time": 2.51917}
[0m21:16:05.526751 [debug] [MainThread]: Command `dbt build` failed at 21:16:05.526684 after 0.97 seconds
[0m21:16:05.527092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbe36f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83c98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb97f2e40>]}
[0m21:16:05.527505 [debug] [MainThread]: Flushing usage events
[0m21:16:06.087679 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:16:53.531915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c73b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1397b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ef2360>]}


============================== 21:16:53.538046 | 012fdc63-2344-438a-a14b-008a2f912ff5 ==============================
[0m21:16:53.538046 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:16:53.538562 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:53.639661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0e64ef0>]}
[0m21:16:53.675007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2eebd40>]}
[0m21:16:53.675595 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:16:53.724961 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:16:53.806501 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:16:53.807120 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:16:54.073351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f648320>]}
[0m21:16:54.132816 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:16:54.136568 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:16:54.181341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fb38080>]}
[0m21:16:54.181767 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:16:54.183543 [info ] [MainThread]: 
[0m21:16:54.183825 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:16:54.184134 [info ] [MainThread]: 
[0m21:16:54.184721 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:16:54.187660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:16:54.209743 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:16:54.210143 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:16:54.210426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:16:54.215356 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:16:54.216326 [debug] [ThreadPool]: On list_staging: Close
[0m21:16:54.216929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:16:54.217312 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:16:54.221239 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:54.221521 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:16:54.221769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:54.226196 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.226552 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:54.226844 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:16:54.227402 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:16:54.228139 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:16:54.228417 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:16:54.228678 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:16:54.229340 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.229590 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:16:54.230610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:16:54.234927 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:16:54.235200 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:16:54.235420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:16:54.238969 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.239279 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:16:54.239588 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:16:54.241676 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:16:54.242502 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:16:54.242833 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:16:54.245948 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.246205 [debug] [MainThread]: On master: BEGIN
[0m21:16:54.246434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:16:54.249870 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:16:54.250176 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.250524 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:16:54.266124 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:16:54.266893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fa01970>]}
[0m21:16:54.267249 [debug] [MainThread]: On master: ROLLBACK
[0m21:16:54.267576 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.267808 [debug] [MainThread]: On master: BEGIN
[0m21:16:54.268197 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:16:54.268459 [debug] [MainThread]: On master: COMMIT
[0m21:16:54.268687 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.268921 [debug] [MainThread]: On master: COMMIT
[0m21:16:54.269242 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.269484 [debug] [MainThread]: On master: Close
[0m21:16:54.272299 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:16:54.272701 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:16:54.273082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:16:54.273447 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:16:54.278988 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.280374 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:16:54.305894 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.307138 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.307428 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:16:54.307693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.311684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.311969 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.312335 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m21:16:54.313995 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:16:54.318510 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.318892 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m21:16:54.319531 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:16:54.329679 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:16:54.329991 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.330266 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:16:54.330971 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.335149 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m21:16:54.338291 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:16:54.338565 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m21:16:54.338940 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:16:54.340567 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:16:54.341723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9edacb30>]}
[0m21:16:54.342225 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.07s]
[0m21:16:54.342699 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:16:54.343628 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:54.343957 [info ] [Thread-1 (]: 2 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m21:16:54.344317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m21:16:54.344692 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:54.352516 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:54.353709 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:54.365532 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:54.366743 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:54.367063 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m21:16:54.367380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.371354 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.371649 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:16:54.371982 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.373031 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:54.375392 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m21:16:54.375773 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m21:16:54.376233 [info ] [Thread-1 (]: 2 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m21:16:54.376721 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:16:54.377229 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:54.377626 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m21:16:54.378156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m21:16:54.378489 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:54.381476 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:54.382326 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:54.383931 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:54.384663 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:54.384928 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m21:16:54.385147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.388743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.389072 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:16:54.389373 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.390342 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:54.391392 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m21:16:54.391720 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m21:16:54.392136 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m21:16:54.392603 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:16:54.393064 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:54.393547 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m21:16:54.393973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m21:16:54.394329 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:54.397188 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:54.398075 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:54.400829 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:54.401543 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:54.401835 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m21:16:54.402074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.405740 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.406112 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:16:54.406403 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.407499 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:54.408551 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m21:16:54.408959 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m21:16:54.409575 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.02s]
[0m21:16:54.410194 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:16:54.410960 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:16:54.411330 [info ] [Thread-1 (]: 5 of 14 START sql table model public_public.dim_car ............................ [RUN]
[0m21:16:54.411732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.dim_car)
[0m21:16:54.412006 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:16:54.414070 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:16:54.415120 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:16:54.430482 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:16:54.431478 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:16:54.431736 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:16:54.431970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.436171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.436506 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:16:54.436796 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  
    

  create  table "staging"."public_public"."dim_car__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    make,
    model,
    extract(year from launch_date) as launch_year,
    vehicle_type,
    engine_size,
    horsepower
from "staging"."public_public"."stg_car_sales"
  );
  
[0m21:16:54.439709 [debug] [Thread-1 (]: SQL status: SELECT 157 in 0.003 seconds
[0m21:16:54.444618 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:16:54.444884 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */
alter table "staging"."public_public"."dim_car__dbt_tmp" rename to "dim_car"
[0m21:16:54.445351 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:16:54.446310 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: COMMIT
[0m21:16:54.446568 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:16:54.446823 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: COMMIT
[0m21:16:54.447358 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.448882 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."dim_car__dbt_backup"
[0m21:16:54.450741 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:16:54.450996 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */
drop table if exists "staging"."public_public"."dim_car__dbt_backup" cascade
[0m21:16:54.451326 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:16:54.452162 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:16:54.452612 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddacc80>]}
[0m21:16:54.453074 [info ] [Thread-1 (]: 5 of 14 OK created sql table model public_public.dim_car ....................... [[32mSELECT 157[0m in 0.04s]
[0m21:16:54.453532 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:16:54.453930 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:16:54.454338 [info ] [Thread-1 (]: 6 of 14 START sql table model public_public.fact_sales ......................... [RUN]
[0m21:16:54.454800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m21:16:54.455146 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:16:54.457254 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:16:54.458049 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:16:54.460371 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:16:54.461006 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:16:54.461238 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:16:54.461446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.465163 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.465536 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:16:54.465826 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        make,
        model,
        date_trunc('month', launch_date) as sale_month,
        sales_thousands,
        price_thousands
    from "staging"."public_public"."stg_car_sales"
)

select
    sale_month,
    make,
    model,
    sum(sales_thousands)           as total_sales_thousands,
    avg(price_thousands)           as avg_price_thousands
from base
group by 1,2,3
order by 1 desc, 2, 3
  );
  
[0m21:16:54.468854 [debug] [Thread-1 (]: SQL status: SELECT 157 in 0.003 seconds
[0m21:16:54.471059 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:16:54.471311 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
alter table "staging"."public_public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m21:16:54.472125 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:16:54.473077 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:16:54.473322 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:16:54.473535 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:16:54.474035 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.475479 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."fact_sales__dbt_backup"
[0m21:16:54.475959 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:16:54.476200 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
drop table if exists "staging"."public_public"."fact_sales__dbt_backup" cascade
[0m21:16:54.476521 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:16:54.477317 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:16:54.477730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '012fdc63-2344-438a-a14b-008a2f912ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dddbec0>]}
[0m21:16:54.478161 [info ] [Thread-1 (]: 6 of 14 OK created sql table model public_public.fact_sales .................... [[32mSELECT 157[0m in 0.02s]
[0m21:16:54.478676 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:16:54.479052 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:54.479386 [info ] [Thread-1 (]: 7 of 14 START test dim_car_unique_key .......................................... [RUN]
[0m21:16:54.479846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.fact_sales, now test.car_sales_dbt.dim_car_unique_key.d5fdcff983)
[0m21:16:54.480175 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:54.484985 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:16:54.485856 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:54.488947 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:16:54.489678 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:16:54.489958 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: BEGIN
[0m21:16:54.490189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.494059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.494346 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:16:54.494673 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    concat(car_make, '-', car_model, '-', car_year) as unique_field,
    count(*) as n_records

from "staging"."public_public"."dim_car"
where concat(car_make, '-', car_model, '-', car_year) is not null
group by concat(car_make, '-', car_model, '-', car_year)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:16:54.495266 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                    ^

[0m21:16:54.495628 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: ROLLBACK
[0m21:16:54.496180 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: Close
[0m21:16:54.499471 [debug] [Thread-1 (]: Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql
[0m21:16:54.500000 [error] [Thread-1 (]: 7 of 14 ERROR dim_car_unique_key ............................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.500630 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:16:54.501013 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:54.501407 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'error'.  Reason: Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql.
[0m21:16:54.501714 [info ] [Thread-1 (]: 8 of 14 START test not_null_dim_car_car_make ................................... [RUN]
[0m21:16:54.502735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.dim_car_unique_key.d5fdcff983, now test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d)
[0m21:16:54.503117 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:54.550568 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:16:54.551773 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:54.553520 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:16:54.554229 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:16:54.554476 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: BEGIN
[0m21:16:54.554699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.558621 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.558969 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:16:54.559323 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_make
from "staging"."public_public"."dim_car"
where car_make is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.559841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 16: select car_make
                ^

[0m21:16:54.560176 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: ROLLBACK
[0m21:16:54.560698 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: Close
[0m21:16:54.562966 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql
[0m21:16:54.563413 [error] [Thread-1 (]: 8 of 14 ERROR not_null_dim_car_car_make ........................................ [[31mERROR[0m in 0.06s]
[0m21:16:54.564093 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:16:54.564451 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:54.564877 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql.
[0m21:16:54.565174 [info ] [Thread-1 (]: 9 of 14 START test not_null_dim_car_car_model .................................. [RUN]
[0m21:16:54.565953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d, now test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9)
[0m21:16:54.566245 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:54.569548 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:16:54.570434 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:54.572056 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:16:54.572893 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:16:54.573152 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: BEGIN
[0m21:16:54.573376 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.577282 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.577796 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:16:54.578123 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_model
from "staging"."public_public"."dim_car"
where car_model is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.578673 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_model" does not exist
LINE 16: select car_model
                ^

[0m21:16:54.579175 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: ROLLBACK
[0m21:16:54.579963 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: Close
[0m21:16:54.582284 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql
[0m21:16:54.582789 [error] [Thread-1 (]: 9 of 14 ERROR not_null_dim_car_car_model ....................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.583469 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:16:54.583866 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:54.584276 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql.
[0m21:16:54.584589 [info ] [Thread-1 (]: 10 of 14 START test not_null_dim_car_car_year .................................. [RUN]
[0m21:16:54.585429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9, now test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87)
[0m21:16:54.585777 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:54.589052 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:16:54.590019 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:54.591598 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:16:54.592359 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:16:54.592606 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: BEGIN
[0m21:16:54.592828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.597099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.597594 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:16:54.597859 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_year
from "staging"."public_public"."dim_car"
where car_year is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.598419 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_year" does not exist
LINE 16: select car_year
                ^

[0m21:16:54.598767 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: ROLLBACK
[0m21:16:54.599452 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: Close
[0m21:16:54.601459 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql
[0m21:16:54.602277 [error] [Thread-1 (]: 10 of 14 ERROR not_null_dim_car_car_year ....................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.602822 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:16:54.603185 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:54.603505 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql.
[0m21:16:54.603782 [info ] [Thread-1 (]: 11 of 14 START test fact_sales_car_relationship ................................ [RUN]
[0m21:16:54.604562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87, now test.car_sales_dbt.fact_sales_car_relationship.51322f6241)
[0m21:16:54.604890 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:54.611725 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:16:54.612654 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:54.614345 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:16:54.615204 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:16:54.615478 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: BEGIN
[0m21:16:54.615721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.619719 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.620181 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:16:54.620488 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select  as from_field
    from "staging"."public_public"."fact_sales"
    where  is not null
),

parent as (
    select car_model as to_field
    from "staging"."public_public"."dim_car"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.620917 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 15:     select  as from_field
                     ^

[0m21:16:54.621260 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: ROLLBACK
[0m21:16:54.621735 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: Close
[0m21:16:54.623619 [debug] [Thread-1 (]: Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql
[0m21:16:54.624114 [error] [Thread-1 (]: 11 of 14 ERROR fact_sales_car_relationship ..................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.624781 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:16:54.625213 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:54.625555 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'error'.  Reason: Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql.
[0m21:16:54.625842 [info ] [Thread-1 (]: 12 of 14 START test not_null_fact_sales_car_make ............................... [RUN]
[0m21:16:54.626646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.fact_sales_car_relationship.51322f6241, now test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c)
[0m21:16:54.626959 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:54.630349 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:16:54.631567 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:54.633458 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:16:54.634405 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:16:54.634692 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: BEGIN
[0m21:16:54.634961 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.638947 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.639273 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:16:54.639559 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_make
from "staging"."public_public"."fact_sales"
where car_make is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.640095 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 16: select car_make
                ^

[0m21:16:54.640464 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: ROLLBACK
[0m21:16:54.640853 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: Close
[0m21:16:54.642919 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:16:54.643737 [error] [Thread-1 (]: 12 of 14 ERROR not_null_fact_sales_car_make .................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.644408 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:16:54.644779 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:54.645184 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql.
[0m21:16:54.645470 [info ] [Thread-1 (]: 13 of 14 START test not_null_fact_sales_car_model .............................. [RUN]
[0m21:16:54.646291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c, now test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012)
[0m21:16:54.646597 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:54.649668 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:16:54.650565 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:54.653569 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:16:54.654322 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:16:54.654572 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: BEGIN
[0m21:16:54.654794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.658578 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.659088 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:16:54.659359 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_model
from "staging"."public_public"."fact_sales"
where car_model is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.659841 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_model" does not exist
LINE 16: select car_model
                ^

[0m21:16:54.660205 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: ROLLBACK
[0m21:16:54.660860 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: Close
[0m21:16:54.663354 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:16:54.663894 [error] [Thread-1 (]: 13 of 14 ERROR not_null_fact_sales_car_model ................................... [[31mERROR[0m in 0.02s]
[0m21:16:54.665118 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:16:54.665561 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:54.665921 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql.
[0m21:16:54.666303 [info ] [Thread-1 (]: 14 of 14 START test not_null_fact_sales_sale_month ............................. [RUN]
[0m21:16:54.667159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012, now test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6)
[0m21:16:54.667530 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:54.670762 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:16:54.671790 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:54.673658 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:16:54.674358 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:16:54.674620 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: BEGIN
[0m21:16:54.674850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:16:54.679099 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.679536 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:16:54.679819 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_month
from "staging"."public_public"."fact_sales"
where sale_month is null



  
  
      
    ) dbt_internal_test
[0m21:16:54.680647 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:16:54.681765 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: ROLLBACK
[0m21:16:54.682175 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: Close
[0m21:16:54.682769 [info ] [Thread-1 (]: 14 of 14 PASS not_null_fact_sales_sale_month ................................... [[32mPASS[0m in 0.02s]
[0m21:16:54.683241 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:16:54.684738 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.685006 [debug] [MainThread]: On master: BEGIN
[0m21:16:54.685214 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:16:54.688770 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:16:54.689130 [debug] [MainThread]: On master: COMMIT
[0m21:16:54.689410 [debug] [MainThread]: Using postgres connection "master"
[0m21:16:54.689726 [debug] [MainThread]: On master: COMMIT
[0m21:16:54.690075 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:16:54.690314 [debug] [MainThread]: On master: Close
[0m21:16:54.690621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:16:54.690846 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' was properly closed.
[0m21:16:54.691151 [info ] [MainThread]: 
[0m21:16:54.691452 [info ] [MainThread]: Finished running 2 table models, 11 data tests, 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m21:16:54.693241 [debug] [MainThread]: Command end result
[0m21:16:54.712752 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:16:54.714211 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:16:54.718655 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:16:54.718914 [info ] [MainThread]: 
[0m21:16:54.719200 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m21:16:54.719617 [info ] [MainThread]: 
[0m21:16:54.720004 [error] [MainThread]:   Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql
[0m21:16:54.720491 [info ] [MainThread]: 
[0m21:16:54.720841 [error] [MainThread]:   Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql
[0m21:16:54.721197 [info ] [MainThread]: 
[0m21:16:54.721597 [error] [MainThread]:   Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql
[0m21:16:54.721929 [info ] [MainThread]: 
[0m21:16:54.722368 [error] [MainThread]:   Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql
[0m21:16:54.722827 [info ] [MainThread]: 
[0m21:16:54.723114 [error] [MainThread]:   Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql
[0m21:16:54.723571 [info ] [MainThread]: 
[0m21:16:54.723886 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:16:54.724195 [info ] [MainThread]: 
[0m21:16:54.724995 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:16:54.725660 [info ] [MainThread]: 
[0m21:16:54.726246 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=7 SKIP=0 TOTAL=14
[0m21:16:54.727307 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2304815, "process_in_blocks": "0", "process_kernel_time": 0.151117, "process_mem_max_rss": "128300", "process_out_blocks": "8456", "process_user_time": 2.72511}
[0m21:16:54.727723 [debug] [MainThread]: Command `dbt build` failed at 21:16:54.727652 after 1.23 seconds
[0m21:16:54.728301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1397b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0ef2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bc1460>]}
[0m21:16:54.728617 [debug] [MainThread]: Flushing usage events
[0m21:16:55.222959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:18:58.509223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0598d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f9e1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa059bbc0>]}


============================== 21:18:58.515343 | b8db3193-7517-435e-9b01-2eb5151b2368 ==============================
[0m21:18:58.515343 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:18:58.515861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:18:58.619426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8db3193-7517-435e-9b01-2eb5151b2368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f89af30>]}
[0m21:18:58.655064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8db3193-7517-435e-9b01-2eb5151b2368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f1e9dc0>]}
[0m21:18:58.655762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:18:58.708063 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:18:58.791426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:18:58.792050 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:18:58.792469 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:18:58.792846 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:18:59.085494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8db3193-7517-435e-9b01-2eb5151b2368', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e178d40>]}
[0m21:18:59.145202 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:18:59.149035 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:18:59.191300 [error] [MainThread]: Encountered an error:
Found a cycle: model.car_sales_dbt.stg_car_sales
[0m21:18:59.192773 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 204, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 574, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/build.py", line 233, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.car_sales_dbt.stg_car_sales

[0m21:18:59.193699 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.72141296, "process_in_blocks": "0", "process_kernel_time": 0.128968, "process_mem_max_rss": "119372", "process_out_blocks": "7366", "process_user_time": 2.358423}
[0m21:18:59.194124 [debug] [MainThread]: Command `dbt build` failed at 21:18:59.194043 after 0.72 seconds
[0m21:18:59.194453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3d6b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddfec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dda8440>]}
[0m21:18:59.194781 [debug] [MainThread]: Flushing usage events
[0m21:18:59.743200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:19:36.205027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966355e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97cee030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96636090>]}


============================== 21:19:36.211170 | 4bc613c5-5ff6-47e1-9075-3096bc3781cc ==============================
[0m21:19:36.211170 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:19:36.211636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:19:36.314293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff960e44d0>]}
[0m21:19:36.351920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c0f800>]}
[0m21:19:36.352677 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:19:36.402495 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:19:36.484612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:19:36.485182 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:19:36.485605 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:19:36.485971 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:19:36.770804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9497c800>]}
[0m21:19:36.830408 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:19:36.833988 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:19:36.879462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951257c0>]}
[0m21:19:36.879883 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:19:36.881698 [info ] [MainThread]: 
[0m21:19:36.882048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:19:36.882375 [info ] [MainThread]: 
[0m21:19:36.882937 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:19:36.885867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:19:36.907838 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:19:36.908209 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:19:36.908473 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:19:36.913332 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:19:36.914286 [debug] [ThreadPool]: On list_staging: Close
[0m21:19:36.914851 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:19:36.915243 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:19:36.919044 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:19:36.919314 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:19:36.919551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:36.923591 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:19:36.924026 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:19:36.924320 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:19:36.924922 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:19:36.925618 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:19:36.925886 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:19:36.926145 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:19:36.926753 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:19:36.927014 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:19:36.927991 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:19:36.933351 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:19:36.933625 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:19:36.933840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:19:36.937864 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:19:36.938130 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:19:36.938392 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:19:36.940556 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:19:36.941423 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:19:36.941784 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:19:36.945119 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:36.945425 [debug] [MainThread]: On master: BEGIN
[0m21:19:36.945654 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:19:36.949158 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:19:36.949525 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:36.949839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:19:36.965950 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:19:36.966772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a22360>]}
[0m21:19:36.967127 [debug] [MainThread]: On master: ROLLBACK
[0m21:19:36.967456 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:36.967683 [debug] [MainThread]: On master: BEGIN
[0m21:19:36.968059 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:19:36.968333 [debug] [MainThread]: On master: COMMIT
[0m21:19:36.968578 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:36.968791 [debug] [MainThread]: On master: COMMIT
[0m21:19:36.969097 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:19:36.969323 [debug] [MainThread]: On master: Close
[0m21:19:36.972107 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:19:36.972499 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:19:36.972855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:19:36.973262 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:19:36.978752 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:19:36.982163 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:19:37.005983 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.007185 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.007481 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:19:37.007752 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.011726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.012144 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.012464 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m21:19:37.014165 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:19:37.018622 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.018914 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m21:19:37.019518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:19:37.029359 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:19:37.029686 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.029976 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:19:37.030697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:19:37.034906 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m21:19:37.038077 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:19:37.038343 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m21:19:37.038705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:19:37.040321 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:19:37.041613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98985310>]}
[0m21:19:37.042129 [info ] [Thread-1 (]: 1 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.07s]
[0m21:19:37.042598 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:19:37.043467 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:19:37.043857 [info ] [Thread-1 (]: 2 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m21:19:37.044266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m21:19:37.044609 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:19:37.050340 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:19:37.051434 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:19:37.063593 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:19:37.064750 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:19:37.065065 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m21:19:37.065355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.069623 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.069952 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:19:37.070336 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.071449 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:19:37.073748 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m21:19:37.074083 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m21:19:37.074516 [info ] [Thread-1 (]: 2 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m21:19:37.074917 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:19:37.075382 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:19:37.075756 [info ] [Thread-1 (]: 3 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m21:19:37.076289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m21:19:37.076624 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:19:37.080751 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:19:37.081605 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:19:37.083196 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:19:37.083851 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:19:37.084105 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m21:19:37.084321 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.087855 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.088237 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:19:37.088538 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.089520 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:19:37.090515 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m21:19:37.090837 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m21:19:37.091229 [info ] [Thread-1 (]: 3 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.02s]
[0m21:19:37.091606 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:19:37.091990 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:19:37.092284 [info ] [Thread-1 (]: 4 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m21:19:37.092661 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m21:19:37.093083 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:19:37.096245 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:19:37.097306 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:19:37.098899 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:19:37.099575 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:19:37.099818 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m21:19:37.100043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.103718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.104115 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:19:37.104417 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.105508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:19:37.106588 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m21:19:37.106913 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m21:19:37.107335 [info ] [Thread-1 (]: 4 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m21:19:37.107879 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:19:37.108835 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:19:37.109444 [info ] [Thread-1 (]: 5 of 14 START sql table model public_public.dim_car ............................ [RUN]
[0m21:19:37.109854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.dim_car)
[0m21:19:37.110149 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:19:37.112308 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:19:37.113184 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:19:37.128575 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:19:37.129469 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:19:37.129758 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:19:37.130045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.134147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.134512 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:19:37.134789 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  
    

  create  table "staging"."public_public"."dim_car__dbt_tmp"
  
  
    as
  
  (
    

select distinct
    make,
    model,
    extract(year from launch_date) as launch_year,
    vehicle_type,
    engine_size,
    horsepower
from "staging"."public_public"."stg_car_sales"
  );
  
[0m21:19:37.137900 [debug] [Thread-1 (]: SQL status: SELECT 157 in 0.003 seconds
[0m21:19:37.142936 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:19:37.143245 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */
alter table "staging"."public_public"."dim_car__dbt_tmp" rename to "dim_car"
[0m21:19:37.143731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:19:37.144717 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: COMMIT
[0m21:19:37.144976 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:19:37.145217 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: COMMIT
[0m21:19:37.145723 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:19:37.147237 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."dim_car__dbt_backup"
[0m21:19:37.149114 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:19:37.149369 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */
drop table if exists "staging"."public_public"."dim_car__dbt_backup" cascade
[0m21:19:37.149718 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:19:37.150577 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:19:37.151033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f7a0f20>]}
[0m21:19:37.151486 [info ] [Thread-1 (]: 5 of 14 OK created sql table model public_public.dim_car ....................... [[32mSELECT 157[0m in 0.04s]
[0m21:19:37.151888 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:19:37.152343 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:19:37.152721 [info ] [Thread-1 (]: 6 of 14 START sql table model public_public.fact_sales ......................... [RUN]
[0m21:19:37.153225 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m21:19:37.153535 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:19:37.155583 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:19:37.156314 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:19:37.158498 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:19:37.159104 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:19:37.159335 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:19:37.159550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.163218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.163686 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:19:37.163954 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        make,
        model,
        date_trunc('month', launch_date) as sale_month,
        sales_thousands,
        price_thousands
    from "staging"."public_public"."stg_car_sales"
)

select
    sale_month,
    make,
    model,
    sum(sales_thousands)           as total_sales_thousands,
    avg(price_thousands)           as avg_price_thousands
from base
group by 1,2,3
order by 1 desc, 2, 3
  );
  
[0m21:19:37.167010 [debug] [Thread-1 (]: SQL status: SELECT 157 in 0.003 seconds
[0m21:19:37.169720 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:19:37.169985 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
alter table "staging"."public_public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m21:19:37.170449 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:19:37.171376 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:19:37.171630 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:19:37.171845 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:19:37.172341 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:19:37.175170 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."fact_sales__dbt_backup"
[0m21:19:37.175647 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:19:37.175894 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
drop table if exists "staging"."public_public"."fact_sales__dbt_backup" cascade
[0m21:19:37.176242 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:19:37.177056 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:19:37.177469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bc613c5-5ff6-47e1-9075-3096bc3781cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f306d20>]}
[0m21:19:37.177902 [info ] [Thread-1 (]: 6 of 14 OK created sql table model public_public.fact_sales .................... [[32mSELECT 157[0m in 0.02s]
[0m21:19:37.178292 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:19:37.178743 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:19:37.179169 [info ] [Thread-1 (]: 7 of 14 START test dim_car_unique_key .......................................... [RUN]
[0m21:19:37.179681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.fact_sales, now test.car_sales_dbt.dim_car_unique_key.d5fdcff983)
[0m21:19:37.180063 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:19:37.232063 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:19:37.234088 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:19:37.235755 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:19:37.236553 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:19:37.236836 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: BEGIN
[0m21:19:37.237090 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.241485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.241792 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"
[0m21:19:37.242119 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.dim_car_unique_key.d5fdcff983"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    concat(car_make, '-', car_model, '-', car_year) as unique_field,
    count(*) as n_records

from "staging"."public_public"."dim_car"
where concat(car_make, '-', car_model, '-', car_year) is not null
group by concat(car_make, '-', car_model, '-', car_year)
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m21:19:37.242744 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                    ^

[0m21:19:37.243106 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: ROLLBACK
[0m21:19:37.243641 [debug] [Thread-1 (]: On test.car_sales_dbt.dim_car_unique_key.d5fdcff983: Close
[0m21:19:37.247792 [debug] [Thread-1 (]: Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql
[0m21:19:37.248407 [error] [Thread-1 (]: 7 of 14 ERROR dim_car_unique_key ............................................... [[31mERROR[0m in 0.07s]
[0m21:19:37.249249 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:19:37.249755 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:19:37.250226 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'error'.  Reason: Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql.
[0m21:19:37.250521 [info ] [Thread-1 (]: 8 of 14 START test not_null_dim_car_car_make ................................... [RUN]
[0m21:19:37.251495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.dim_car_unique_key.d5fdcff983, now test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d)
[0m21:19:37.251812 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:19:37.255041 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:19:37.256120 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:19:37.257725 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:19:37.258411 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:19:37.258668 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: BEGIN
[0m21:19:37.258895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.262798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.263196 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"
[0m21:19:37.263470 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_make
from "staging"."public_public"."dim_car"
where car_make is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.263978 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 16: select car_make
                ^

[0m21:19:37.264349 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: ROLLBACK
[0m21:19:37.264851 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d: Close
[0m21:19:37.266769 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql
[0m21:19:37.267250 [error] [Thread-1 (]: 8 of 14 ERROR not_null_dim_car_car_make ........................................ [[31mERROR[0m in 0.02s]
[0m21:19:37.268095 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:19:37.268526 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:19:37.268843 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql.
[0m21:19:37.269220 [info ] [Thread-1 (]: 9 of 14 START test not_null_dim_car_car_model .................................. [RUN]
[0m21:19:37.269890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d, now test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9)
[0m21:19:37.270284 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:19:37.273275 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:19:37.274130 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:19:37.275711 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:19:37.276669 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:19:37.276925 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: BEGIN
[0m21:19:37.277164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.281049 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.281475 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"
[0m21:19:37.281756 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_model
from "staging"."public_public"."dim_car"
where car_model is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.282229 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_model" does not exist
LINE 16: select car_model
                ^

[0m21:19:37.282531 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: ROLLBACK
[0m21:19:37.282946 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9: Close
[0m21:19:37.285311 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql
[0m21:19:37.285990 [error] [Thread-1 (]: 9 of 14 ERROR not_null_dim_car_car_model ....................................... [[31mERROR[0m in 0.02s]
[0m21:19:37.286815 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:19:37.287185 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:19:37.287535 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql.
[0m21:19:37.287830 [info ] [Thread-1 (]: 10 of 14 START test not_null_dim_car_car_year .................................. [RUN]
[0m21:19:37.288636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9, now test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87)
[0m21:19:37.289011 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:19:37.292196 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:19:37.293147 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:19:37.294762 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:19:37.295516 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:19:37.295769 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: BEGIN
[0m21:19:37.296006 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.299942 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.300312 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"
[0m21:19:37.300720 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_year
from "staging"."public_public"."dim_car"
where car_year is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.301246 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_year" does not exist
LINE 16: select car_year
                ^

[0m21:19:37.301615 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: ROLLBACK
[0m21:19:37.302158 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87: Close
[0m21:19:37.304384 [debug] [Thread-1 (]: Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql
[0m21:19:37.305169 [error] [Thread-1 (]: 10 of 14 ERROR not_null_dim_car_car_year ....................................... [[31mERROR[0m in 0.02s]
[0m21:19:37.306064 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:19:37.306516 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:19:37.307183 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql.
[0m21:19:37.307527 [info ] [Thread-1 (]: 11 of 14 START test fact_sales_car_relationship ................................ [RUN]
[0m21:19:37.308629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87, now test.car_sales_dbt.fact_sales_car_relationship.51322f6241)
[0m21:19:37.309091 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:19:37.313105 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:19:37.313936 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:19:37.315526 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:19:37.316237 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:19:37.316502 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: BEGIN
[0m21:19:37.316730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.321091 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.321432 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"
[0m21:19:37.321803 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.fact_sales_car_relationship.51322f6241"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select  as from_field
    from "staging"."public_public"."fact_sales"
    where  is not null
),

parent as (
    select car_model as to_field
    from "staging"."public_public"."dim_car"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.322292 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "as"
LINE 15:     select  as from_field
                     ^

[0m21:19:37.322627 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: ROLLBACK
[0m21:19:37.323143 [debug] [Thread-1 (]: On test.car_sales_dbt.fact_sales_car_relationship.51322f6241: Close
[0m21:19:37.325129 [debug] [Thread-1 (]: Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql
[0m21:19:37.325647 [error] [Thread-1 (]: 11 of 14 ERROR fact_sales_car_relationship ..................................... [[31mERROR[0m in 0.02s]
[0m21:19:37.326430 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:19:37.326916 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:19:37.327317 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'error'.  Reason: Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql.
[0m21:19:37.327621 [info ] [Thread-1 (]: 12 of 14 START test not_null_fact_sales_car_make ............................... [RUN]
[0m21:19:37.328389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.fact_sales_car_relationship.51322f6241, now test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c)
[0m21:19:37.328674 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:19:37.334073 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:19:37.335096 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:19:37.336700 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:19:37.337658 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:19:37.337942 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: BEGIN
[0m21:19:37.338202 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.342127 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.342474 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:19:37.342814 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_make
from "staging"."public_public"."fact_sales"
where car_make is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.343467 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 16: select car_make
                ^

[0m21:19:37.343753 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: ROLLBACK
[0m21:19:37.344214 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: Close
[0m21:19:37.346267 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:19:37.346672 [error] [Thread-1 (]: 12 of 14 ERROR not_null_fact_sales_car_make .................................... [[31mERROR[0m in 0.02s]
[0m21:19:37.347426 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:19:37.347859 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:19:37.348208 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql.
[0m21:19:37.348552 [info ] [Thread-1 (]: 13 of 14 START test not_null_fact_sales_car_model .............................. [RUN]
[0m21:19:37.349413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c, now test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012)
[0m21:19:37.349716 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:19:37.352805 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:19:37.353659 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:19:37.355225 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:19:37.356139 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:19:37.356380 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: BEGIN
[0m21:19:37.356602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.360432 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.360781 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:19:37.361118 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_model
from "staging"."public_public"."fact_sales"
where car_model is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.361609 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_model" does not exist
LINE 16: select car_model
                ^

[0m21:19:37.362088 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: ROLLBACK
[0m21:19:37.362531 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: Close
[0m21:19:37.364694 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:19:37.365111 [error] [Thread-1 (]: 13 of 14 ERROR not_null_fact_sales_car_model ................................... [[31mERROR[0m in 0.02s]
[0m21:19:37.366392 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:19:37.366925 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:19:37.367305 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql.
[0m21:19:37.367755 [info ] [Thread-1 (]: 14 of 14 START test not_null_fact_sales_sale_month ............................. [RUN]
[0m21:19:37.368718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012, now test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6)
[0m21:19:37.369268 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:19:37.372853 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:19:37.373815 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:19:37.375396 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:19:37.376143 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:19:37.376410 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: BEGIN
[0m21:19:37.376664 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:19:37.380499 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.380801 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:19:37.381063 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_month
from "staging"."public_public"."fact_sales"
where sale_month is null



  
  
      
    ) dbt_internal_test
[0m21:19:37.381808 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.000 seconds
[0m21:19:37.382940 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: ROLLBACK
[0m21:19:37.383291 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: Close
[0m21:19:37.383779 [info ] [Thread-1 (]: 14 of 14 PASS not_null_fact_sales_sale_month ................................... [[32mPASS[0m in 0.02s]
[0m21:19:37.384205 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:19:37.385528 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:37.385851 [debug] [MainThread]: On master: BEGIN
[0m21:19:37.386117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:19:37.389804 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:19:37.390243 [debug] [MainThread]: On master: COMMIT
[0m21:19:37.390482 [debug] [MainThread]: Using postgres connection "master"
[0m21:19:37.390714 [debug] [MainThread]: On master: COMMIT
[0m21:19:37.391043 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:19:37.391281 [debug] [MainThread]: On master: Close
[0m21:19:37.391594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:19:37.391832 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' was properly closed.
[0m21:19:37.392166 [info ] [MainThread]: 
[0m21:19:37.392481 [info ] [MainThread]: Finished running 2 table models, 11 data tests, 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m21:19:37.394193 [debug] [MainThread]: Command end result
[0m21:19:37.414448 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:19:37.415963 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:19:37.420498 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:19:37.420735 [info ] [MainThread]: 
[0m21:19:37.421067 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m21:19:37.421448 [info ] [MainThread]: 
[0m21:19:37.421871 [error] [MainThread]:   Database Error in test dim_car_unique_key (models/schema.yml)
  column "car_make" does not exist
  LINE 15:     concat(car_make, '-', car_model, '-', car_year) as uniqu...
                      ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/dim_car_unique_key.sql
[0m21:19:37.422217 [info ] [MainThread]: 
[0m21:19:37.422630 [error] [MainThread]:   Database Error in test not_null_dim_car_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_make.sql
[0m21:19:37.423203 [info ] [MainThread]: 
[0m21:19:37.423637 [error] [MainThread]:   Database Error in test not_null_dim_car_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_model.sql
[0m21:19:37.423907 [info ] [MainThread]: 
[0m21:19:37.424420 [error] [MainThread]:   Database Error in test not_null_dim_car_car_year (models/schema.yml)
  column "car_year" does not exist
  LINE 16: select car_year
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_dim_car_car_year.sql
[0m21:19:37.424926 [info ] [MainThread]: 
[0m21:19:37.425435 [error] [MainThread]:   Database Error in test fact_sales_car_relationship (models/schema.yml)
  syntax error at or near "as"
  LINE 15:     select  as from_field
                       ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/fact_sales_car_relationship.sql
[0m21:19:37.426243 [info ] [MainThread]: 
[0m21:19:37.426758 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:19:37.427049 [info ] [MainThread]: 
[0m21:19:37.427591 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:19:37.427847 [info ] [MainThread]: 
[0m21:19:37.428202 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=7 SKIP=0 TOTAL=14
[0m21:19:37.429199 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2591223, "process_in_blocks": "0", "process_kernel_time": 0.14628, "process_mem_max_rss": "128308", "process_out_blocks": "8452", "process_user_time": 2.776326}
[0m21:19:37.429595 [debug] [MainThread]: Command `dbt build` failed at 21:19:37.429527 after 1.26 seconds
[0m21:19:37.429986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96dcd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94907110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94d1db50>]}
[0m21:19:37.430383 [debug] [MainThread]: Flushing usage events
[0m21:19:37.957532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:21:06.174511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e74a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e65cd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e03bd10>]}


============================== 21:21:06.180784 | d4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7 ==============================
[0m21:21:06.180784 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:21:06.181287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m21:21:06.288408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ddef8c0>]}
[0m21:21:06.324223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e2176b0>]}
[0m21:21:06.324853 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:21:06.374807 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:21:06.458467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:21:06.459283 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m21:21:06.459704 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:21:06.460024 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:21:06.460311 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:21:06.736156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbf0500>]}
[0m21:21:06.795568 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:21:06.799404 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:21:06.843398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c967ec0>]}
[0m21:21:06.843820 [info ] [MainThread]: Found 3 models, 9 data tests, 1 source, 433 macros
[0m21:21:06.845590 [info ] [MainThread]: 
[0m21:21:06.845897 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:21:06.846256 [info ] [MainThread]: 
[0m21:21:06.846811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:21:06.849765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:21:06.871542 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:21:06.871920 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:21:06.872218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:21:06.877341 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:21:06.878288 [debug] [ThreadPool]: On list_staging: Close
[0m21:21:06.878853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:21:06.879233 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:21:06.883024 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:21:06.883294 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:21:06.883529 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:06.887600 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:21:06.888047 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:21:06.888408 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:21:06.888940 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:21:06.889670 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:21:06.889933 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:21:06.890184 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:21:06.890782 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:21:06.891053 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:21:06.892132 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:21:06.897638 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:21:06.897921 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:21:06.898157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:21:06.901795 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:21:06.902177 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:21:06.902509 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:21:06.904826 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:21:06.905734 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:21:06.906108 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:21:06.909424 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:06.909703 [debug] [MainThread]: On master: BEGIN
[0m21:21:06.909939 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:21:06.913507 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:21:06.913812 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:06.914255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:21:06.930161 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:21:06.931056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb76480>]}
[0m21:21:06.931420 [debug] [MainThread]: On master: ROLLBACK
[0m21:21:06.931754 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:06.931995 [debug] [MainThread]: On master: BEGIN
[0m21:21:06.932379 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:21:06.932658 [debug] [MainThread]: On master: COMMIT
[0m21:21:06.932894 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:06.933133 [debug] [MainThread]: On master: COMMIT
[0m21:21:06.933438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:06.933670 [debug] [MainThread]: On master: Close
[0m21:21:06.936533 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:21:06.936956 [info ] [Thread-1 (]: 1 of 12 START sql view model public_public.dim_car ............................. [RUN]
[0m21:21:06.937445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m21:21:06.937852 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:21:06.942574 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:21:06.945328 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:21:06.970429 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:21:06.971658 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:21:06.971946 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:21:06.972247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:06.976267 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:21:06.976617 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:21:06.976939 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m21:21:06.977422 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m21:21:06.977803 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m21:21:06.978265 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:21:06.981255 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:21:06.982657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c967ef0>]}
[0m21:21:06.983346 [error] [Thread-1 (]: 1 of 12 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m21:21:06.983996 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:21:06.984442 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:21:06.984842 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m21:21:06.985206 [info ] [Thread-1 (]: 2 of 12 START sql view model public_public.fact_sales .......................... [RUN]
[0m21:21:06.986601 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m21:21:06.986883 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:21:06.988484 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:21:06.989619 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:21:06.992272 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:21:06.993463 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:21:06.993830 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:21:06.994150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:06.998512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:21:06.998844 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:21:06.999159 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  create view "staging"."public_public"."fact_sales__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m21:21:06.999662 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m21:21:07.000147 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m21:21:07.001341 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:21:07.003407 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:21:07.003858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff977d2f90>]}
[0m21:21:07.004587 [error] [Thread-1 (]: 2 of 12 ERROR creating sql view model public_public.fact_sales ................. [[31mERROR[0m in 0.02s]
[0m21:21:07.005434 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:21:07.005807 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:21:07.006158 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m21:21:07.006487 [info ] [Thread-1 (]: 3 of 12 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:21:07.007394 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.fact_sales, now model.car_sales_dbt.stg_car_sales)
[0m21:21:07.007741 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:21:07.009273 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:21:07.010362 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:21:07.012843 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:21:07.014478 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:21:07.014791 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:21:07.015044 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:21:07.019512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:21:07.019952 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:21:07.020313 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m21:21:07.021415 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m21:21:07.021741 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:21:07.022313 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:21:07.024181 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:21:07.024588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4c94b5f-69c1-4ff8-b57e-58ef6c0dcdd7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ce389b0>]}
[0m21:21:07.025168 [error] [Thread-1 (]: 3 of 12 ERROR creating sql view model public_public.stg_car_sales .............. [[31mERROR[0m in 0.02s]
[0m21:21:07.025665 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:21:07.026053 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_launch_year.06b5a851ca
[0m21:21:07.026402 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:21:07.026787 [info ] [Thread-1 (]: 4 of 12 SKIP test not_null_dim_car_launch_year ................................. [[33mSKIP[0m]
[0m21:21:07.027686 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_launch_year.06b5a851ca
[0m21:21:07.028006 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m21:21:07.028232 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_launch_year.06b5a851ca' to be skipped because of status 'skipped'. 
[0m21:21:07.028596 [info ] [Thread-1 (]: 5 of 12 SKIP test not_null_dim_car_make ........................................ [[33mSKIP[0m]
[0m21:21:07.029316 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m21:21:07.029608 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m21:21:07.029846 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_make.a10286b91a' to be skipped because of status 'skipped'. 
[0m21:21:07.030127 [info ] [Thread-1 (]: 6 of 12 SKIP test not_null_dim_car_model ....................................... [[33mSKIP[0m]
[0m21:21:07.030666 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m21:21:07.030951 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m21:21:07.031278 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_model.c130eac0d8' to be skipped because of status 'skipped'. 
[0m21:21:07.031556 [info ] [Thread-1 (]: 7 of 12 SKIP test not_null_fact_sales_make ..................................... [[33mSKIP[0m]
[0m21:21:07.032139 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m21:21:07.032504 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m21:21:07.032750 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1' to be skipped because of status 'skipped'. 
[0m21:21:07.033030 [info ] [Thread-1 (]: 8 of 12 SKIP test not_null_fact_sales_model .................................... [[33mSKIP[0m]
[0m21:21:07.033659 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m21:21:07.033995 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:21:07.034278 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_model.3941a44e83' to be skipped because of status 'skipped'. 
[0m21:21:07.034550 [info ] [Thread-1 (]: 9 of 12 SKIP test not_null_fact_sales_sale_month ............................... [[33mSKIP[0m]
[0m21:21:07.035262 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:21:07.035540 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:21:07.035766 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m21:21:07.036056 [info ] [Thread-1 (]: 10 of 12 SKIP test not_null_stg_car_sales_make ................................. [[33mSKIP[0m]
[0m21:21:07.036763 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:21:07.037070 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:21:07.037298 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m21:21:07.037564 [info ] [Thread-1 (]: 11 of 12 SKIP test not_null_stg_car_sales_model ................................ [[33mSKIP[0m]
[0m21:21:07.038115 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:21:07.038472 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:21:07.038712 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m21:21:07.038969 [info ] [Thread-1 (]: 12 of 12 SKIP test not_null_stg_car_sales_year ................................. [[33mSKIP[0m]
[0m21:21:07.039619 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:21:07.039910 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5' to be skipped because of status 'skipped'. 
[0m21:21:07.041290 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:07.041545 [debug] [MainThread]: On master: BEGIN
[0m21:21:07.041784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:21:07.045788 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:21:07.046158 [debug] [MainThread]: On master: COMMIT
[0m21:21:07.046397 [debug] [MainThread]: Using postgres connection "master"
[0m21:21:07.046627 [debug] [MainThread]: On master: COMMIT
[0m21:21:07.046933 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:21:07.047180 [debug] [MainThread]: On master: Close
[0m21:21:07.047487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:21:07.047709 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:21:07.048028 [info ] [MainThread]: 
[0m21:21:07.048330 [info ] [MainThread]: Finished running 9 data tests, 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m21:21:07.049265 [debug] [MainThread]: Command end result
[0m21:21:07.069114 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:21:07.070545 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:21:07.074835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:21:07.075107 [info ] [MainThread]: 
[0m21:21:07.075393 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:21:07.075773 [info ] [MainThread]: 
[0m21:21:07.076239 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:21:07.076570 [info ] [MainThread]: 
[0m21:21:07.077059 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:21:07.077401 [info ] [MainThread]: 
[0m21:21:07.077843 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:21:07.078179 [info ] [MainThread]: 
[0m21:21:07.078563 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=9 TOTAL=12
[0m21:21:07.079513 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.94316864, "process_in_blocks": "0", "process_kernel_time": 0.138629, "process_mem_max_rss": "128024", "process_out_blocks": "8358", "process_user_time": 2.499323}
[0m21:21:07.079942 [debug] [MainThread]: Command `dbt build` failed at 21:21:07.079862 after 0.94 seconds
[0m21:21:07.080443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb634a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e798920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dd62210>]}
[0m21:21:07.080884 [debug] [MainThread]: Flushing usage events
[0m21:21:07.695216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:22:01.910167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b275160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b71e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c922b70>]}


============================== 21:22:01.916377 | 5e0fd55e-c52f-4a7d-a3d0-d91eaf600857 ==============================
[0m21:22:01.916377 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:22:01.916831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:22:02.017762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0fd55e-c52f-4a7d-a3d0-d91eaf600857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b949d00>]}
[0m21:22:02.052931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0fd55e-c52f-4a7d-a3d0-d91eaf600857', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b618b00>]}
[0m21:22:02.053531 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:22:02.104211 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:22:02.177282 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading car_sales_dbt: schema.yml - Runtime Error
    Contents of file 'models/schema.yml' are not valid. Dictionary expected.
[0m21:22:02.178220 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.30320483, "process_in_blocks": "0", "process_kernel_time": 0.111025, "process_mem_max_rss": "110764", "process_out_blocks": "5156", "process_user_time": 1.942443}
[0m21:22:02.178634 [debug] [MainThread]: Command `dbt build` failed at 21:22:02.178551 after 0.30 seconds
[0m21:22:02.179006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcea480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bd05130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a13ff50>]}
[0m21:22:02.179325 [debug] [MainThread]: Flushing usage events
[0m21:22:02.767600 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:23:42.632832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95fe9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90d13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90d1520>]}


============================== 21:23:42.639084 | ae8f582e-bfdc-4acc-b8ce-6360cd76d47d ==============================
[0m21:23:42.639084 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:23:42.639603 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:23:42.741320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8f582e-bfdc-4acc-b8ce-6360cd76d47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb855a930>]}
[0m21:23:42.776499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8f582e-bfdc-4acc-b8ce-6360cd76d47d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90da8a0>]}
[0m21:23:42.777123 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:23:42.826863 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:23:42.902074 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading car_sales_dbt: schema.yml - Runtime Error
    Syntax error near line 14
    ------------------------------
    11 |     transmission,
    12 |     owner
    13 | from {{ source('staging', 'car_sales') }};
    14 | version: 2
    15 | 
    16 | sources:
    17 |   - name: staging
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 14, column 8
[0m21:23:42.903028 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.30593035, "process_in_blocks": "0", "process_kernel_time": 0.11687, "process_mem_max_rss": "110892", "process_out_blocks": "5157", "process_user_time": 2.009774}
[0m21:23:42.903440 [debug] [MainThread]: Command `dbt build` failed at 21:23:42.903366 after 0.31 seconds
[0m21:23:42.903775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95fe9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95c15b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb81f56a0>]}
[0m21:23:42.904124 [debug] [MainThread]: Flushing usage events
[0m21:23:43.584777 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:24:44.348135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87397c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86aefc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8940f3b0>]}


============================== 21:24:44.354351 | df90bd34-3c33-4bf1-8774-93f2902b2b32 ==============================
[0m21:24:44.354351 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:24:44.354869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m21:24:44.459436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8704da30>]}
[0m21:24:44.494206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866e6600>]}
[0m21:24:44.494833 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:24:44.543620 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:24:44.627038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:24:44.627897 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m21:24:44.628266 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:24:44.628567 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:24:44.628870 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:24:44.892910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85369640>]}
[0m21:24:44.940262 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:24:44.944301 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:24:44.988706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84b70800>]}
[0m21:24:44.989141 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m21:24:44.990693 [info ] [MainThread]: 
[0m21:24:44.991019 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:24:44.991416 [info ] [MainThread]: 
[0m21:24:44.991946 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:24:44.994797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:24:45.018297 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:24:45.018709 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:24:45.018985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:24:45.023931 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:24:45.024860 [debug] [ThreadPool]: On list_staging: Close
[0m21:24:45.025443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:24:45.025832 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:24:45.029730 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:24:45.030006 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:24:45.030252 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:45.033684 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:24:45.033999 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:24:45.034255 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:24:45.034839 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:24:45.035484 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:24:45.035762 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:24:45.036004 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:24:45.036624 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:24:45.036873 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:24:45.037841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:24:45.042056 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:24:45.042357 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:24:45.042586 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:24:45.046264 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:24:45.046568 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:24:45.046837 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:24:45.049005 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:24:45.049890 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:24:45.050232 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:24:45.053504 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.053831 [debug] [MainThread]: On master: BEGIN
[0m21:24:45.054063 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:24:45.057530 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:24:45.057903 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.058238 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:24:45.073877 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:24:45.074717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8536a720>]}
[0m21:24:45.075078 [debug] [MainThread]: On master: ROLLBACK
[0m21:24:45.075419 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.075652 [debug] [MainThread]: On master: BEGIN
[0m21:24:45.076035 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:24:45.076320 [debug] [MainThread]: On master: COMMIT
[0m21:24:45.076571 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.076799 [debug] [MainThread]: On master: COMMIT
[0m21:24:45.077118 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:24:45.077360 [debug] [MainThread]: On master: Close
[0m21:24:45.080212 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:24:45.080647 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.stg_car_sales ........................ [RUN]
[0m21:24:45.081031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:24:45.081335 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:24:45.086644 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:24:45.087928 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:24:45.120688 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:24:45.122759 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:24:45.123708 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:24:45.124259 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:24:45.129633 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m21:24:45.130159 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:24:45.130547 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    -- Staging model for car_sales source
define view stg_car_sales as
select
    make,
    model,
    year as launch_year,
    fueltype,
    price,
    saledate,
    sellertype,
    transmission,
    owner
from "staging"."public"."car_sales";
  );
[0m21:24:45.131074 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "define"
LINE 8: define view stg_car_sales as
        ^

[0m21:24:45.131439 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:24:45.131855 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:24:45.134927 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "define"
  LINE 8: define view stg_car_sales as
          ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:24:45.136470 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df90bd34-3c33-4bf1-8774-93f2902b2b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87394470>]}
[0m21:24:45.137147 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public_public.stg_car_sales ............... [[31mERROR[0m in 0.05s]
[0m21:24:45.137800 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:24:45.138378 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "define"
  LINE 8: define view stg_car_sales as
          ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:24:45.141334 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:24:45.141849 [info ] [Thread-1 (]: 2 of 3 SKIP relation public_public.dim_car ..................................... [[33mSKIP[0m]
[0m21:24:45.142386 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:24:45.142814 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:24:45.143109 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m21:24:45.143459 [info ] [Thread-1 (]: 3 of 3 SKIP relation public_public.fact_sales .................................. [[33mSKIP[0m]
[0m21:24:45.144260 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:24:45.144626 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m21:24:45.145892 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.146218 [debug] [MainThread]: On master: BEGIN
[0m21:24:45.146509 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:24:45.150705 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:24:45.151326 [debug] [MainThread]: On master: COMMIT
[0m21:24:45.151594 [debug] [MainThread]: Using postgres connection "master"
[0m21:24:45.151864 [debug] [MainThread]: On master: COMMIT
[0m21:24:45.152192 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:24:45.152437 [debug] [MainThread]: On master: Close
[0m21:24:45.152774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:24:45.153008 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:24:45.153327 [info ] [MainThread]: 
[0m21:24:45.153617 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m21:24:45.154569 [debug] [MainThread]: Command end result
[0m21:24:45.173649 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:24:45.175342 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:24:45.180000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:24:45.180261 [info ] [MainThread]: 
[0m21:24:45.180534 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:24:45.181115 [info ] [MainThread]: 
[0m21:24:45.181646 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near "define"
  LINE 8: define view stg_car_sales as
          ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:24:45.182204 [info ] [MainThread]: 
[0m21:24:45.182572 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m21:24:45.183551 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.87038964, "process_in_blocks": "0", "process_kernel_time": 0.136838, "process_mem_max_rss": "127576", "process_out_blocks": "8139", "process_user_time": 2.473079}
[0m21:24:45.183969 [debug] [MainThread]: Command `dbt build` failed at 21:24:45.183898 after 0.87 seconds
[0m21:24:45.184286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86aefc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88fe24b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff866d1880>]}
[0m21:24:45.184674 [debug] [MainThread]: Flushing usage events
[0m21:24:45.698486 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:00.148473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b8b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b467e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819a0c80>]}


============================== 21:26:00.154519 | 7859592b-ba9a-4f8d-a2dc-2d541188f940 ==============================
[0m21:26:00.154519 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:26:00.155044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:26:00.255811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822d4680>]}
[0m21:26:00.291151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825ba7b0>]}
[0m21:26:00.291762 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:26:00.341068 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:26:00.410842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:26:00.411397 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:26:00.609907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80879550>]}
[0m21:26:00.658731 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:26:00.662320 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:26:00.705879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff801cdd60>]}
[0m21:26:00.706306 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m21:26:00.707870 [info ] [MainThread]: 
[0m21:26:00.708326 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:00.708687 [info ] [MainThread]: 
[0m21:26:00.709228 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:00.712091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:26:00.734906 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:26:00.735285 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:26:00.735567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:00.740563 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:26:00.741480 [debug] [ThreadPool]: On list_staging: Close
[0m21:26:00.742040 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:26:00.742429 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:26:00.746347 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:00.746630 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:26:00.746878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:00.750965 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:26:00.751396 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:00.751785 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:26:00.752362 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:26:00.753111 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:26:00.753409 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:00.753662 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:26:00.754295 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:26:00.754560 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:26:00.755564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:26:00.759849 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:26:00.760105 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:26:00.760314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:00.764118 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:26:00.764497 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:26:00.764769 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:26:00.767306 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:26:00.768198 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:26:00.768547 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:26:00.772979 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.773289 [debug] [MainThread]: On master: BEGIN
[0m21:26:00.773561 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:00.777234 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:26:00.777514 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.777816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:00.793809 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:26:00.794667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83eb6210>]}
[0m21:26:00.795032 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:00.795386 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.795634 [debug] [MainThread]: On master: BEGIN
[0m21:26:00.796039 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:26:00.796331 [debug] [MainThread]: On master: COMMIT
[0m21:26:00.796565 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.796787 [debug] [MainThread]: On master: COMMIT
[0m21:26:00.797087 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:00.797326 [debug] [MainThread]: On master: Close
[0m21:26:00.800109 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:26:00.800507 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.stg_car_sales ........................ [RUN]
[0m21:26:00.800858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:26:00.801142 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:26:00.806352 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:26:00.808561 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:26:00.832970 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:26:00.834665 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:26:00.834926 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:26:00.835155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:00.839184 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:26:00.839571 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:26:00.839906 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    -- Staging model for car_sales source
select
    make,
    model,
    year as launch_year,
    fueltype,
    price,
    saledate,
    sellertype,
    transmission,
    owner
from "staging"."public"."car_sales";
  );
[0m21:26:00.840409 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 18: from "staging"."public"."car_sales";
                                            ^

[0m21:26:00.840729 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:26:00.841169 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:26:00.844021 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near ";"
  LINE 18: from "staging"."public"."car_sales";
                                              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:26:00.845421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7859592b-ba9a-4f8d-a2dc-2d541188f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b5c70>]}
[0m21:26:00.846119 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public_public.stg_car_sales ............... [[31mERROR[0m in 0.04s]
[0m21:26:00.847038 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:26:00.847544 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near ";"
  LINE 18: from "staging"."public"."car_sales";
                                              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:26:00.848438 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:26:00.848745 [info ] [Thread-1 (]: 2 of 3 SKIP relation public_public.dim_car ..................................... [[33mSKIP[0m]
[0m21:26:00.849159 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:26:00.849553 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:26:00.849778 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m21:26:00.850040 [info ] [Thread-1 (]: 3 of 3 SKIP relation public_public.fact_sales .................................. [[33mSKIP[0m]
[0m21:26:00.850556 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:26:00.850863 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m21:26:00.851806 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.852069 [debug] [MainThread]: On master: BEGIN
[0m21:26:00.852320 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:00.856284 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:26:00.856666 [debug] [MainThread]: On master: COMMIT
[0m21:26:00.856990 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:00.857233 [debug] [MainThread]: On master: COMMIT
[0m21:26:00.857539 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:00.857768 [debug] [MainThread]: On master: Close
[0m21:26:00.858087 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:00.858325 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:26:00.858637 [info ] [MainThread]: 
[0m21:26:00.858908 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:26:00.859759 [debug] [MainThread]: Command end result
[0m21:26:00.877512 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:26:00.878854 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:26:00.882998 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:26:00.883315 [info ] [MainThread]: 
[0m21:26:00.883628 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:00.883926 [info ] [MainThread]: 
[0m21:26:00.884519 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  syntax error at or near ";"
  LINE 18: from "staging"."public"."car_sales";
                                              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:26:00.884856 [info ] [MainThread]: 
[0m21:26:00.885424 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m21:26:00.886314 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.77273446, "process_in_blocks": "0", "process_kernel_time": 0.126938, "process_mem_max_rss": "126256", "process_out_blocks": "8138", "process_user_time": 2.334867}
[0m21:26:00.886656 [debug] [MainThread]: Command `dbt build` failed at 21:26:00.886580 after 0.77 seconds
[0m21:26:00.887041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff825567b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81b467e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b5eb0>]}
[0m21:26:00.887433 [debug] [MainThread]: Flushing usage events
[0m21:26:01.475162 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:26:44.572606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ebc080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87c2bfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87671f70>]}


============================== 21:26:44.578823 | 91fef683-89c8-444d-9a2c-d024c891a58d ==============================
[0m21:26:44.578823 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:26:44.579328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:26:44.686287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870d82c0>]}
[0m21:26:44.723120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ebdc70>]}
[0m21:26:44.723905 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:26:44.773403 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:26:44.848113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:26:44.848757 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:26:44.849197 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:26:45.056983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860f68d0>]}
[0m21:26:45.106402 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:26:45.109993 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:26:45.154822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859bf4d0>]}
[0m21:26:45.155266 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m21:26:45.156854 [info ] [MainThread]: 
[0m21:26:45.157201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:26:45.157500 [info ] [MainThread]: 
[0m21:26:45.157969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:26:45.160838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:26:45.183208 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:26:45.183571 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:26:45.183842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:26:45.189103 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:26:45.190082 [debug] [ThreadPool]: On list_staging: Close
[0m21:26:45.190702 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:26:45.191082 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:26:45.195016 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:45.195291 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:26:45.195543 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:45.199454 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:26:45.199780 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:45.200115 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:26:45.200751 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:26:45.201539 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:26:45.201824 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:26:45.202072 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:26:45.202676 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:26:45.202988 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:26:45.203996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:26:45.209303 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:26:45.209582 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:26:45.209781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:26:45.213216 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:26:45.213576 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:26:45.213917 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:26:45.216076 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:26:45.216942 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:26:45.217281 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:26:45.220476 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.220779 [debug] [MainThread]: On master: BEGIN
[0m21:26:45.221016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:26:45.224306 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:26:45.224658 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.224976 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:26:45.241093 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:26:45.241901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff849ee000>]}
[0m21:26:45.242245 [debug] [MainThread]: On master: ROLLBACK
[0m21:26:45.242603 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.242829 [debug] [MainThread]: On master: BEGIN
[0m21:26:45.243208 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:26:45.243482 [debug] [MainThread]: On master: COMMIT
[0m21:26:45.243705 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.243920 [debug] [MainThread]: On master: COMMIT
[0m21:26:45.244212 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:45.244445 [debug] [MainThread]: On master: Close
[0m21:26:45.247213 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:26:45.247632 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.stg_car_sales ........................ [RUN]
[0m21:26:45.248018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:26:45.248443 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:26:45.253613 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:26:45.254874 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:26:45.279650 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:26:45.280812 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:26:45.281109 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:26:45.281396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:26:45.285360 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:26:45.285636 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:26:45.286079 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    -- Staging model for car_sales source
select
    make,
    model,
    year as launch_year,
    fueltype,
    price,
    saledate,
    sellertype,
    transmission,
    owner
from "staging"."public"."car_sales"
  );
[0m21:26:45.286650 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 9:     make,
            ^

[0m21:26:45.287011 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:26:45.287502 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:26:45.290288 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "make" does not exist
  LINE 9:     make,
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:26:45.291585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91fef683-89c8-444d-9a2c-d024c891a58d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85500f20>]}
[0m21:26:45.292165 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public_public.stg_car_sales ............... [[31mERROR[0m in 0.04s]
[0m21:26:45.292981 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:26:45.293566 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "make" does not exist
  LINE 9:     make,
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:26:45.294497 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:26:45.294806 [info ] [Thread-1 (]: 2 of 3 SKIP relation public_public.dim_car ..................................... [[33mSKIP[0m]
[0m21:26:45.295159 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:26:45.295477 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:26:45.295711 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m21:26:45.295988 [info ] [Thread-1 (]: 3 of 3 SKIP relation public_public.fact_sales .................................. [[33mSKIP[0m]
[0m21:26:45.296631 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:26:45.296919 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m21:26:45.297782 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.298028 [debug] [MainThread]: On master: BEGIN
[0m21:26:45.298262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:26:45.301944 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:26:45.302274 [debug] [MainThread]: On master: COMMIT
[0m21:26:45.302594 [debug] [MainThread]: Using postgres connection "master"
[0m21:26:45.302835 [debug] [MainThread]: On master: COMMIT
[0m21:26:45.303158 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:26:45.303407 [debug] [MainThread]: On master: Close
[0m21:26:45.303723 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:26:45.303959 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:26:45.304260 [info ] [MainThread]: 
[0m21:26:45.304661 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m21:26:45.305472 [debug] [MainThread]: Command end result
[0m21:26:45.323290 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:26:45.324783 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:26:45.328861 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:26:45.329080 [info ] [MainThread]: 
[0m21:26:45.329329 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:26:45.329589 [info ] [MainThread]: 
[0m21:26:45.330085 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "make" does not exist
  LINE 9:     make,
              ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:26:45.330446 [info ] [MainThread]: 
[0m21:26:45.330808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m21:26:45.331832 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.79493195, "process_in_blocks": "0", "process_kernel_time": 0.132214, "process_mem_max_rss": "126124", "process_out_blocks": "8137", "process_user_time": 2.408902}
[0m21:26:45.332564 [debug] [MainThread]: Command `dbt build` failed at 21:26:45.332461 after 0.80 seconds
[0m21:26:45.333031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8735ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87d32510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff870daf30>]}
[0m21:26:45.333489 [debug] [MainThread]: Flushing usage events
[0m21:26:45.840254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:27.558275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4896ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fd4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa17d40e0>]}


============================== 21:27:27.564455 | 478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63 ==============================
[0m21:27:27.564455 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:27:27.564951 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:27:27.667377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40ea120>]}
[0m21:27:27.702274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0c781d0>]}
[0m21:27:27.702883 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:27:27.751956 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:27:27.822548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:27:27.823102 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:27:28.021822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa05cfad0>]}
[0m21:27:28.070686 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:27:28.074283 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:27:28.118774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01cda90>]}
[0m21:27:28.119180 [info ] [MainThread]: Found 3 models, 1 source, 433 macros
[0m21:27:28.120756 [info ] [MainThread]: 
[0m21:27:28.121080 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:27:28.121403 [info ] [MainThread]: 
[0m21:27:28.121961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:27:28.124995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:27:28.147101 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:27:28.147470 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:27:28.147806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:28.152697 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:27:28.153649 [debug] [ThreadPool]: On list_staging: Close
[0m21:27:28.154249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:27:28.154617 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:27:28.158462 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:27:28.158746 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:27:28.158986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:28.162957 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.163273 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:27:28.163631 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:27:28.164248 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:27:28.164962 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:27:28.165256 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:27:28.165508 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:27:28.166129 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:27:28.166393 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:27:28.167589 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:27:28.171830 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:27:28.172098 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:27:28.172307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:27:28.175878 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.176291 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:27:28.176594 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:27:28.178721 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:27:28.179633 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:27:28.179987 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:27:28.184345 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.184641 [debug] [MainThread]: On master: BEGIN
[0m21:27:28.184896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:27:28.188390 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:27:28.188747 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.189095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:27:28.204918 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m21:27:28.205765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0b90440>]}
[0m21:27:28.206127 [debug] [MainThread]: On master: ROLLBACK
[0m21:27:28.206464 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.206694 [debug] [MainThread]: On master: BEGIN
[0m21:27:28.207081 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:27:28.207364 [debug] [MainThread]: On master: COMMIT
[0m21:27:28.207610 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.207829 [debug] [MainThread]: On master: COMMIT
[0m21:27:28.208144 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:28.208373 [debug] [MainThread]: On master: Close
[0m21:27:28.211112 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:27:28.211529 [info ] [Thread-1 (]: 1 of 3 START sql view model public_public.stg_car_sales ........................ [RUN]
[0m21:27:28.211902 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.stg_car_sales)
[0m21:27:28.212242 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:27:28.217463 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.218748 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:27:28.243306 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.244519 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.244811 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:27:28.245100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:28.249063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.249423 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.249749 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    select
    "Manufacturer" as make,
    "Model" as model,
    extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as launch_year,
    to_date("Latest_Launch", 'MM/DD/YYYY') as saledate,
    ("Price_in_thousands" * 1000)::numeric as price
from "staging"."public"."car_sales"
  );
[0m21:27:28.251153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m21:27:28.255473 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.255782 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m21:27:28.256366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:27:28.266312 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:27:28.266625 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.266901 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:27:28.267574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:27:28.271917 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m21:27:28.275105 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:27:28.275382 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m21:27:28.275734 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:27:28.277389 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:27:28.278666 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40e92b0>]}
[0m21:27:28.279205 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public_public.stg_car_sales ................... [[32mCREATE VIEW[0m in 0.07s]
[0m21:27:28.279680 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:27:28.280549 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:27:28.280952 [info ] [Thread-1 (]: 2 of 3 START sql view model public_public.dim_car .............................. [RUN]
[0m21:27:28.281331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now model.car_sales_dbt.dim_car)
[0m21:27:28.281733 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:27:28.283616 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:27:28.284681 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:27:28.286988 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:27:28.287679 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:27:28.287915 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:27:28.288152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:28.292497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.292814 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:27:28.293122 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    -- Dimension model for unique cars
select distinct
    make,
    model,
    launch_year,
    fueltype as vehicle_type,
    null::text as engine_size,
    null::int as horsepower
from "staging"."public_public"."stg_car_sales"
  );
[0m21:27:28.293737 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "fueltype" does not exist
LINE 12:     fueltype as vehicle_type,
             ^

[0m21:27:28.294073 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m21:27:28.294640 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:27:28.297647 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  column "fueltype" does not exist
  LINE 12:     fueltype as vehicle_type,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:27:28.298228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00dd5e0>]}
[0m21:27:28.298919 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public_public.dim_car ..................... [[31mERROR[0m in 0.02s]
[0m21:27:28.299737 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:27:28.300154 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:27:28.300507 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  column "fueltype" does not exist
  LINE 12:     fueltype as vehicle_type,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m21:27:28.300866 [info ] [Thread-1 (]: 3 of 3 START sql view model public_public.fact_sales ........................... [RUN]
[0m21:27:28.301641 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m21:27:28.301930 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:27:28.303993 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:27:28.304859 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:27:28.308433 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:27:28.309091 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:27:28.309327 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:27:28.309549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:27:28.313322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.313639 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:27:28.313931 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  create view "staging"."public_public"."fact_sales__dbt_tmp"
    
    
  as (
    -- Fact model aggregating sales by month, make, and model
select
    date_trunc('month', saledate)::date as sale_month,
    make,
    model,
    sum(price) / 1000.0 as total_sales_thousands,
    avg(price) / 1000.0 as avg_price_thousands
from "staging"."public_public"."stg_car_sales"
group by 1, 2, 3;
  );
[0m21:27:28.314370 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: group by 1, 2, 3;
                         ^

[0m21:27:28.314695 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m21:27:28.315198 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:27:28.317445 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near ";"
  LINE 15: group by 1, 2, 3;
                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:27:28.317881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '478b20eb-d3ef-4a3a-b3f8-5b4f063b3a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af4ac90>]}
[0m21:27:28.318396 [error] [Thread-1 (]: 3 of 3 ERROR creating sql view model public_public.fact_sales .................. [[31mERROR[0m in 0.02s]
[0m21:27:28.318808 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:27:28.319220 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near ";"
  LINE 15: group by 1, 2, 3;
                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m21:27:28.320332 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.320585 [debug] [MainThread]: On master: BEGIN
[0m21:27:28.320794 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:27:28.324329 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:27:28.324782 [debug] [MainThread]: On master: COMMIT
[0m21:27:28.325040 [debug] [MainThread]: Using postgres connection "master"
[0m21:27:28.325280 [debug] [MainThread]: On master: COMMIT
[0m21:27:28.325590 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:27:28.325833 [debug] [MainThread]: On master: Close
[0m21:27:28.326159 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:28.326397 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m21:27:28.326702 [info ] [MainThread]: 
[0m21:27:28.326987 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m21:27:28.327750 [debug] [MainThread]: Command end result
[0m21:27:28.344560 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:27:28.345977 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:27:28.349988 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:27:28.350218 [info ] [MainThread]: 
[0m21:27:28.350500 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m21:27:28.351168 [info ] [MainThread]: 
[0m21:27:28.351679 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  column "fueltype" does not exist
  LINE 12:     fueltype as vehicle_type,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:27:28.351958 [info ] [MainThread]: 
[0m21:27:28.352270 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  syntax error at or near ";"
  LINE 15: group by 1, 2, 3;
                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:27:28.352700 [info ] [MainThread]: 
[0m21:27:28.353231 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:27:28.354250 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8308832, "process_in_blocks": "0", "process_kernel_time": 0.126323, "process_mem_max_rss": "126408", "process_out_blocks": "8158", "process_user_time": 2.41118}
[0m21:27:28.354579 [debug] [MainThread]: Command `dbt build` failed at 21:27:28.354519 after 0.83 seconds
[0m21:27:28.354905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1fd4d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0823b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a62d50>]}
[0m21:27:28.355348 [debug] [MainThread]: Flushing usage events
[0m21:27:28.999929 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:27.736082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff867828d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86974fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86977b60>]}


============================== 21:28:27.742397 | 8f4bd13c-146a-442a-afd3-73b7269321dd ==============================
[0m21:28:27.742397 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:28:27.742926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:28:27.853694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f4bd13c-146a-442a-afd3-73b7269321dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8562a4e0>]}
[0m21:28:27.892946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f4bd13c-146a-442a-afd3-73b7269321dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8838f6b0>]}
[0m21:28:27.894114 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:28:27.949776 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:28:28.043184 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m21:28:28.043782 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:28:28.044205 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:28:28.044617 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:28:28.252865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f4bd13c-146a-442a-afd3-73b7269321dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff852171a0>]}
[0m21:28:28.301879 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:28:28.305620 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:28:28.348714 [error] [MainThread]: Encountered an error:
Found a cycle: model.car_sales_dbt.stg_car_sales
[0m21:28:28.350249 [error] [MainThread]: Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/cli/main.py", line 204, in build
    results = task.run()
              ^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 574, in run
    self._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/compile.py", line 133, in _runtime_initialize
    super()._runtime_initialize()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/runnable.py", line 170, in _runtime_initialize
    self.compile_manifest()
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/task/build.py", line 233, in compile_manifest
    self.graph: Graph = self.compiler.compile(self.manifest, add_test_edges=True)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 475, in compile
    linker.link_graph(manifest)
  File "/home/airflow/.local/lib/python3.12/site-packages/dbt/compilation.py", line 195, in link_graph
    raise RuntimeError("Found a cycle: {}".format(cycle))
RuntimeError: Found a cycle: model.car_sales_dbt.stg_car_sales

[0m21:28:28.351230 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6504676, "process_in_blocks": "0", "process_kernel_time": 0.14629, "process_mem_max_rss": "117776", "process_out_blocks": "7274", "process_user_time": 2.273516}
[0m21:28:28.351643 [debug] [MainThread]: Command `dbt build` failed at 21:28:28.351547 after 0.65 seconds
[0m21:28:28.351989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8646f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85200da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8519c0b0>]}
[0m21:28:28.352325 [debug] [MainThread]: Flushing usage events
[0m21:28:28.944230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:29:50.425223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8777f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8bb7ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8700140>]}


============================== 21:29:50.431483 | b5f4c1ef-673b-42dc-b40b-c795dcb03094 ==============================
[0m21:29:50.431483 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:29:50.432030 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:29:50.534225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa762e300>]}
[0m21:29:50.569156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8462a80>]}
[0m21:29:50.569752 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:29:50.620440 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:29:50.693406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:29:50.694236 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m21:29:50.694608 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:29:50.694914 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:29:50.695203 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:29:51.048634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa714b290>]}
[0m21:29:51.106639 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:29:51.110219 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:29:51.155543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa699b410>]}
[0m21:29:51.155969 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:29:51.157786 [info ] [MainThread]: 
[0m21:29:51.158065 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:29:51.158357 [info ] [MainThread]: 
[0m21:29:51.158870 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:29:51.161655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:29:51.184156 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:29:51.184557 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:29:51.184823 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:51.190211 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m21:29:51.191214 [debug] [ThreadPool]: On list_staging: Close
[0m21:29:51.191868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:29:51.192375 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:29:51.196872 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:29:51.197226 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:29:51.197506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:51.202477 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m21:29:51.202853 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:29:51.203141 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:29:51.203706 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:29:51.204436 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:29:51.204710 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:29:51.204995 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:29:51.205612 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.205839 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:29:51.206804 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:29:51.211073 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:29:51.211337 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:29:51.211548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:51.214973 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m21:29:51.215276 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:29:51.215646 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:29:51.217698 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m21:29:51.218565 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:29:51.218899 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:29:51.222134 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.222419 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.222678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:51.226045 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m21:29:51.226344 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.226667 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:29:51.242599 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:29:51.243689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa762c0b0>]}
[0m21:29:51.244099 [debug] [MainThread]: On master: ROLLBACK
[0m21:29:51.244433 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.244672 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.245062 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:29:51.245345 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.245586 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.245796 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.246108 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.246336 [debug] [MainThread]: On master: Close
[0m21:29:51.249560 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:29:51.249971 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m21:29:51.250336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m21:29:51.250856 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:29:51.255715 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:29:51.257336 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:29:51.283173 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:29:51.284380 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:29:51.284678 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:29:51.284950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.288946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.289260 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:29:51.289641 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m21:29:51.290200 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m21:29:51.290531 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m21:29:51.290967 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:29:51.293776 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:29:51.295155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e949b0>]}
[0m21:29:51.295818 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m21:29:51.296664 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:29:51.297027 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:29:51.297393 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m21:29:51.297753 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:29:51.299137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m21:29:51.299511 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:29:51.302225 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.303292 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:29:51.305701 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.306637 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.306987 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:29:51.307292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.311668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.312007 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.312349 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m21:29:51.314256 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m21:29:51.319125 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.319473 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m21:29:51.320072 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:29:51.330285 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:29:51.330680 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.330969 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m21:29:51.331924 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m21:29:51.336133 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m21:29:51.339393 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:29:51.339679 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m21:29:51.340058 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m21:29:51.341744 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:29:51.342203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaab9340>]}
[0m21:29:51.342689 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m21:29:51.343151 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:29:51.343688 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:29:51.344073 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m21:29:51.344552 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m21:29:51.344916 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:29:51.345154 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m21:29:51.345427 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m21:29:51.346007 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:29:51.346325 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:29:51.346578 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m21:29:51.346843 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m21:29:51.347365 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:29:51.347688 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:29:51.347913 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m21:29:51.348182 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m21:29:51.348746 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:29:51.349038 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:29:51.349254 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m21:29:51.349512 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m21:29:51.350101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m21:29:51.350384 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:29:51.356391 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:29:51.357395 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:29:51.369339 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:29:51.370264 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:29:51.370530 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m21:29:51.370754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.374794 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.375190 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m21:29:51.375459 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.376528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:29:51.378837 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m21:29:51.379208 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m21:29:51.379669 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m21:29:51.380119 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:29:51.380446 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:29:51.380783 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m21:29:51.381178 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m21:29:51.381459 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:29:51.384363 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:29:51.385203 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:29:51.386812 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:29:51.387468 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:29:51.387736 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m21:29:51.387955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.391451 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m21:29:51.391765 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m21:29:51.392172 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.393106 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:29:51.394084 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m21:29:51.394404 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m21:29:51.394796 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m21:29:51.395277 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:29:51.395860 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:29:51.396215 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m21:29:51.396906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m21:29:51.397260 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:29:51.400828 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:29:51.401760 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:29:51.404837 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:29:51.405496 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:29:51.405751 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m21:29:51.405972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.409874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.410201 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m21:29:51.410473 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.411629 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:29:51.412740 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m21:29:51.413158 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m21:29:51.413778 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.02s]
[0m21:29:51.414271 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:29:51.415078 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:29:51.415440 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m21:29:51.415827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m21:29:51.416196 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:29:51.463766 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:29:51.464852 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:29:51.480192 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:29:51.481049 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:29:51.481334 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:29:51.481609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.485671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.486008 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:29:51.486359 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        make,
        model,
        date_trunc('month', launch_date) as sale_month,
        sales_thousands,
        price_thousands
    from "staging"."public_public"."stg_car_sales"
)

select
    sale_month,
    make,
    model,
    sum(sales_thousands)           as total_sales_thousands,
    avg(price_thousands)           as avg_price_thousands
from base
group by 1,2,3
order by 1 desc, 2, 3
  );
  
[0m21:29:51.489479 [debug] [Thread-1 (]: SQL status: SELECT 157 in 0.003 seconds
[0m21:29:51.494499 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:29:51.494791 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
alter table "staging"."public_public"."fact_sales__dbt_tmp" rename to "fact_sales"
[0m21:29:51.495172 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m21:29:51.496088 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:29:51.496343 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:29:51.496573 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: COMMIT
[0m21:29:51.497248 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.498740 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."fact_sales__dbt_backup"
[0m21:29:51.500629 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:29:51.500877 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */
drop table if exists "staging"."public_public"."fact_sales__dbt_backup" cascade
[0m21:29:51.501211 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m21:29:51.502068 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:29:51.502498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5f4c1ef-673b-42dc-b40b-c795dcb03094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4101130>]}
[0m21:29:51.503012 [info ] [Thread-1 (]: 10 of 14 OK created sql table model public_public.fact_sales ................... [[32mSELECT 157[0m in 0.09s]
[0m21:29:51.503723 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:29:51.504601 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:29:51.504895 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m21:29:51.505313 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:29:51.505682 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:29:51.505901 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m21:29:51.506160 [info ] [Thread-1 (]: 12 of 14 START test not_null_fact_sales_car_make ............................... [RUN]
[0m21:29:51.506895 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.fact_sales, now test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c)
[0m21:29:51.507190 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:29:51.510113 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:29:51.511099 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:29:51.512779 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:29:51.513434 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:29:51.513693 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: BEGIN
[0m21:29:51.513920 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.517726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.518051 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"
[0m21:29:51.518473 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_make
from "staging"."public_public"."fact_sales"
where car_make is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.519279 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_make" does not exist
LINE 16: select car_make
                ^

[0m21:29:51.519626 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: ROLLBACK
[0m21:29:51.520066 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c: Close
[0m21:29:51.522301 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:29:51.522811 [error] [Thread-1 (]: 12 of 14 ERROR not_null_fact_sales_car_make .................................... [[31mERROR[0m in 0.02s]
[0m21:29:51.523566 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:29:51.524093 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:29:51.524494 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql.
[0m21:29:51.524850 [info ] [Thread-1 (]: 13 of 14 START test not_null_fact_sales_car_model .............................. [RUN]
[0m21:29:51.525559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c, now test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012)
[0m21:29:51.525990 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:29:51.529091 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:29:51.530122 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:29:51.531816 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:29:51.532468 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:29:51.532731 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: BEGIN
[0m21:29:51.532958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.537145 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.537439 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"
[0m21:29:51.537774 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select car_model
from "staging"."public_public"."fact_sales"
where car_model is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.538281 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "car_model" does not exist
LINE 16: select car_model
                ^

[0m21:29:51.538696 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: ROLLBACK
[0m21:29:51.539163 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012: Close
[0m21:29:51.541047 [debug] [Thread-1 (]: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:29:51.541545 [error] [Thread-1 (]: 13 of 14 ERROR not_null_fact_sales_car_model ................................... [[31mERROR[0m in 0.02s]
[0m21:29:51.542461 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:29:51.542959 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:29:51.543361 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql.
[0m21:29:51.543664 [info ] [Thread-1 (]: 14 of 14 START test not_null_fact_sales_sale_month ............................. [RUN]
[0m21:29:51.544410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012, now test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6)
[0m21:29:51.544962 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:29:51.548147 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:29:51.548977 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:29:51.550643 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:29:51.551396 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:29:51.551689 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: BEGIN
[0m21:29:51.551915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:51.555788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.556128 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"
[0m21:29:51.556422 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_month
from "staging"."public_public"."fact_sales"
where sale_month is null



  
  
      
    ) dbt_internal_test
[0m21:29:51.557227 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m21:29:51.559936 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: ROLLBACK
[0m21:29:51.560327 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6: Close
[0m21:29:51.560934 [info ] [Thread-1 (]: 14 of 14 PASS not_null_fact_sales_sale_month ................................... [[32mPASS[0m in 0.02s]
[0m21:29:51.561440 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:29:51.562712 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.562965 [debug] [MainThread]: On master: BEGIN
[0m21:29:51.563205 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:51.566975 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:29:51.567388 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.567661 [debug] [MainThread]: Using postgres connection "master"
[0m21:29:51.567903 [debug] [MainThread]: On master: COMMIT
[0m21:29:51.568247 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:29:51.568512 [debug] [MainThread]: On master: Close
[0m21:29:51.569015 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:51.569321 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' was properly closed.
[0m21:29:51.569891 [info ] [MainThread]: 
[0m21:29:51.570215 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m21:29:51.572363 [debug] [MainThread]: Command end result
[0m21:29:51.593810 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:29:51.595455 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:29:51.600151 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:29:51.600416 [info ] [MainThread]: 
[0m21:29:51.600750 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:29:51.601095 [info ] [MainThread]: 
[0m21:29:51.601672 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:29:51.602002 [info ] [MainThread]: 
[0m21:29:51.602533 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_make (models/schema.yml)
  column "car_make" does not exist
  LINE 16: select car_make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_make.sql
[0m21:29:51.602886 [info ] [MainThread]: 
[0m21:29:51.603451 [error] [MainThread]:   Database Error in test not_null_fact_sales_car_model (models/schema.yml)
  column "car_model" does not exist
  LINE 16: select car_model
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_fact_sales_car_model.sql
[0m21:29:51.603889 [info ] [MainThread]: 
[0m21:29:51.604229 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=5 TOTAL=14
[0m21:29:51.605651 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2146388, "process_in_blocks": "0", "process_kernel_time": 0.167633, "process_mem_max_rss": "129664", "process_out_blocks": "8418", "process_user_time": 2.744}
[0m21:29:51.606106 [debug] [MainThread]: Command `dbt build` failed at 21:29:51.606032 after 1.22 seconds
[0m21:29:51.606453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacdb7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8e4d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f04710>]}
[0m21:29:51.606849 [debug] [MainThread]: Flushing usage events
[0m21:29:52.279762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:31:36.061281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b9b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88664fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b99c70>]}


============================== 21:31:36.067348 | 548e8dd2-5fbf-463e-a9da-f790ec4e6b84 ==============================
[0m21:31:36.067348 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:31:36.067849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:31:36.170398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '548e8dd2-5fbf-463e-a9da-f790ec4e6b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872b71a0>]}
[0m21:31:36.205820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '548e8dd2-5fbf-463e-a9da-f790ec4e6b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88473290>]}
[0m21:31:36.206428 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:31:36.255744 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:31:36.332955 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading car_sales_dbt: schema.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | {{ config(materialized='view', schema='public') }}
    2  | 
    3  | select
    4  |     make           as car_make,
    5  |     model          as car_model,
    6  |     year           as car_year,
    
    Raw Error:
    ------------------------------
    did not find expected <document start>
      in "<unicode string>", line 3, column 1
[0m21:31:36.333893 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.30722347, "process_in_blocks": "0", "process_kernel_time": 0.110104, "process_mem_max_rss": "110804", "process_out_blocks": "5157", "process_user_time": 1.944849}
[0m21:31:36.334331 [debug] [MainThread]: Command `dbt build` failed at 21:31:36.334257 after 0.31 seconds
[0m21:31:36.334654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88e80320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8733a4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff872b5f10>]}
[0m21:31:36.335019 [debug] [MainThread]: Flushing usage events
[0m21:31:36.981806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:37:39.555320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb149b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11175f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb176aa80>]}


============================== 21:37:39.561497 | 771a7ebd-f153-4f82-9088-191e347a4667 ==============================
[0m21:37:39.561497 [info ] [MainThread]: Running with dbt=1.9.6
[0m21:37:39.562048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/airflow/.dbt', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:37:39.665481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb11175f0>]}
[0m21:37:39.703096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb12f67e0>]}
[0m21:37:39.703860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m21:37:39.755102 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m21:37:39.838889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m21:37:39.839760 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m21:37:39.840125 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m21:37:39.840457 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m21:37:39.840753 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m21:37:40.192535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf382570>]}
[0m21:37:40.258299 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:37:40.262440 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:37:40.310925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafb60410>]}
[0m21:37:40.311445 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m21:37:40.313350 [info ] [MainThread]: 
[0m21:37:40.313727 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:37:40.314187 [info ] [MainThread]: 
[0m21:37:40.314651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m21:37:40.317595 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m21:37:40.341804 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m21:37:40.342269 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m21:37:40.342559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:40.349495 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m21:37:40.350711 [debug] [ThreadPool]: On list_staging: Close
[0m21:37:40.351646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m21:37:40.352174 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m21:37:40.356699 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:37:40.357016 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m21:37:40.357262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:40.361703 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.362192 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:37:40.362531 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m21:37:40.363191 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m21:37:40.363967 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:37:40.364269 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m21:37:40.364524 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m21:37:40.365140 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m21:37:40.365393 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m21:37:40.366761 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m21:37:40.370940 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:37:40.371202 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m21:37:40.371406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:37:40.375053 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.375329 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m21:37:40.375646 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m21:37:40.378817 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m21:37:40.380048 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m21:37:40.380518 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m21:37:40.384066 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.384372 [debug] [MainThread]: On master: BEGIN
[0m21:37:40.384626 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:40.388412 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.388702 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.389077 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m21:37:40.404963 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m21:37:40.405797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3452480>]}
[0m21:37:40.406161 [debug] [MainThread]: On master: ROLLBACK
[0m21:37:40.406498 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.406734 [debug] [MainThread]: On master: BEGIN
[0m21:37:40.407123 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m21:37:40.407414 [debug] [MainThread]: On master: COMMIT
[0m21:37:40.407636 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.407863 [debug] [MainThread]: On master: COMMIT
[0m21:37:40.408179 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:40.408414 [debug] [MainThread]: On master: Close
[0m21:37:40.411444 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m21:37:40.411903 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m21:37:40.412377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m21:37:40.412921 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m21:37:40.418491 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m21:37:40.419881 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m21:37:40.446187 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m21:37:40.448518 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:37:40.448911 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m21:37:40.449254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:40.453452 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.453891 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m21:37:40.454197 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    

-- Raw staging view for the Car Sales CSV
select
    "Manufacturer"          as make,
    "Model"                 as model,
    extract(year from to_date("Latest_Launch", 'MM/DD/YYYY'))          as year,
    "Fuel_Type"             as fueltype,
    "Vehicle_type"          as vehicle_type,
    "Engine_size"           as engine_size,
    "Horsepower"            as horsepower,
    "Sales_in_thousands"    as sales_thousands,
    "Price_in_thousands"    as price_thousands,
    to_date("Latest_Launch", 'MM/DD/YYYY')                             as launch_date
from "staging"."public"."car_sales"
  );
[0m21:37:40.454862 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Fuel_Type" does not exist
LINE 14:     "Fuel_Type"             as fueltype,
             ^

[0m21:37:40.455173 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m21:37:40.455557 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m21:37:40.458535 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:37:40.459886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad513aa0>]}
[0m21:37:40.460672 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.05s]
[0m21:37:40.461537 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m21:37:40.461932 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m21:37:40.462384 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m21:37:40.462779 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.fact_sales .......................... [RUN]
[0m21:37:40.463942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.fact_sales)
[0m21:37:40.464277 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m21:37:40.466850 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m21:37:40.467995 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m21:37:40.471513 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m21:37:40.472196 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:37:40.472472 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m21:37:40.472703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:40.476778 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.477282 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m21:37:40.477681 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  create view "staging"."public_public"."fact_sales__dbt_tmp"
    
    
  as (
    

-- Raw staging view for the Car Sales CSV
select
    "Manufacturer"          as make,
    "Model"                 as model,
    extract(year from to_date("Latest_Launch", 'MM/DD/YYYY'))          as year,
    "Fuel_Type"             as fueltype,
    "Vehicle_type"          as vehicle_type,
    "Engine_size"           as engine_size,
    "Horsepower"            as horsepower,
    "Sales_in_thousands"    as sales_thousands,
    "Price_in_thousands"    as price_thousands,
    to_date("Latest_Launch", 'MM/DD/YYYY')                             as launch_date
from "staging"."public"."car_sales"
  );
[0m21:37:40.478374 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Fuel_Type" does not exist
LINE 14:     "Fuel_Type"             as fueltype,
             ^

[0m21:37:40.478894 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m21:37:40.479849 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m21:37:40.483013 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:37:40.483705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacb78620>]}
[0m21:37:40.484258 [error] [Thread-1 (]: 2 of 14 ERROR creating sql view model public_public.fact_sales ................. [[31mERROR[0m in 0.02s]
[0m21:37:40.484830 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m21:37:40.485308 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m21:37:40.485760 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m21:37:40.486127 [info ] [Thread-1 (]: 3 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m21:37:40.487319 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.fact_sales, now model.car_sales_dbt.stg_car_sales)
[0m21:37:40.487627 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m21:37:40.489886 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m21:37:40.491087 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m21:37:40.493791 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m21:37:40.494647 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:37:40.494905 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m21:37:40.495159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:37:40.499084 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.499467 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m21:37:40.499937 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

-- Raw staging view for the Car Sales CSV
select
    "Manufacturer"          as make,
    "Model"                 as model,
    extract(year from to_date("Latest_Launch", 'MM/DD/YYYY'))          as year,
    "Fuel_Type"             as fueltype,
    "Vehicle_type"          as vehicle_type,
    "Engine_size"           as engine_size,
    "Horsepower"            as horsepower,
    "Sales_in_thousands"    as sales_thousands,
    "Price_in_thousands"    as price_thousands,
    to_date("Latest_Launch", 'MM/DD/YYYY')                             as launch_date
from "staging"."public"."car_sales"
  );
[0m21:37:40.500808 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "Fuel_Type" does not exist
LINE 14:     "Fuel_Type"             as fueltype,
             ^

[0m21:37:40.501217 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m21:37:40.502056 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m21:37:40.504266 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:37:40.504712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '771a7ebd-f153-4f82-9088-191e347a4667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5d42c0>]}
[0m21:37:40.505283 [error] [Thread-1 (]: 3 of 14 ERROR creating sql view model public_public.stg_car_sales .............. [[31mERROR[0m in 0.02s]
[0m21:37:40.505789 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m21:37:40.506160 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.4fd037f97b
[0m21:37:40.506502 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m21:37:40.506798 [info ] [Thread-1 (]: 4 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m21:37:40.507717 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.4fd037f97b
[0m21:37:40.508051 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:37:40.508469 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.4fd037f97b' to be skipped because of status 'skipped'. 
[0m21:37:40.508813 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m21:37:40.509546 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m21:37:40.509864 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:37:40.510114 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m21:37:40.510411 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m21:37:40.510969 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m21:37:40.511309 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:37:40.511531 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m21:37:40.511794 [info ] [Thread-1 (]: 7 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m21:37:40.512470 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m21:37:40.512769 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:37:40.513006 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m21:37:40.513276 [info ] [Thread-1 (]: 8 of 14 SKIP test fact_sales_car_relationship .................................. [[33mSKIP[0m]
[0m21:37:40.513799 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m21:37:40.514128 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:37:40.514341 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m21:37:40.514595 [info ] [Thread-1 (]: 9 of 14 SKIP test not_null_fact_sales_car_make ................................. [[33mSKIP[0m]
[0m21:37:40.515149 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m21:37:40.515424 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:37:40.515631 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m21:37:40.515907 [info ] [Thread-1 (]: 10 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m21:37:40.516444 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m21:37:40.516764 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:37:40.516999 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m21:37:40.517271 [info ] [Thread-1 (]: 11 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m21:37:40.517762 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m21:37:40.518044 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:37:40.518258 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m21:37:40.518517 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_stg_car_sales_make ................................. [[33mSKIP[0m]
[0m21:37:40.519055 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m21:37:40.519353 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:37:40.519569 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m21:37:40.519825 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_stg_car_sales_model ................................ [[33mSKIP[0m]
[0m21:37:40.520469 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m21:37:40.520770 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:37:40.521006 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m21:37:40.521267 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_stg_car_sales_year ................................. [[33mSKIP[0m]
[0m21:37:40.521782 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m21:37:40.522127 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5' to be skipped because of status 'skipped'. 
[0m21:37:40.523188 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.523452 [debug] [MainThread]: On master: BEGIN
[0m21:37:40.523695 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:37:40.527755 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m21:37:40.528242 [debug] [MainThread]: On master: COMMIT
[0m21:37:40.528530 [debug] [MainThread]: Using postgres connection "master"
[0m21:37:40.528782 [debug] [MainThread]: On master: COMMIT
[0m21:37:40.529122 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m21:37:40.529373 [debug] [MainThread]: On master: Close
[0m21:37:40.529711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:40.529948 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m21:37:40.530299 [info ] [MainThread]: 
[0m21:37:40.530559 [info ] [MainThread]: Finished running 11 data tests, 3 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m21:37:40.531867 [debug] [MainThread]: Command end result
[0m21:37:40.551311 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m21:37:40.553029 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m21:37:40.557362 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m21:37:40.557604 [info ] [MainThread]: 
[0m21:37:40.557899 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m21:37:40.558313 [info ] [MainThread]: 
[0m21:37:40.558816 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m21:37:40.559172 [info ] [MainThread]: 
[0m21:37:40.559767 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m21:37:40.560312 [info ] [MainThread]: 
[0m21:37:40.560734 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  column "Fuel_Type" does not exist
  LINE 14:     "Fuel_Type"             as fueltype,
               ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m21:37:40.561190 [info ] [MainThread]: 
[0m21:37:40.561734 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=11 TOTAL=14
[0m21:37:40.562683 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.0426099, "process_in_blocks": "0", "process_kernel_time": 0.150003, "process_mem_max_rss": "129160", "process_out_blocks": "8332", "process_user_time": 2.606067}
[0m21:37:40.563043 [debug] [MainThread]: Command `dbt build` failed at 21:37:40.562948 after 1.04 seconds
[0m21:37:40.563394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0ed0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb168c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0f0ec30>]}
[0m21:37:40.563894 [debug] [MainThread]: Flushing usage events
[0m21:37:41.143915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:06:23.833927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81cbb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7db0c440>]}


============================== 08:06:23.840621 | 900a6ffe-4961-4bc2-9650-53a4f7dfde36 ==============================
[0m08:06:23.840621 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:06:23.841062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:06:23.967321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbf1520>]}
[0m08:06:24.002590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6defc0>]}
[0m08:06:24.003226 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:06:24.058365 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:06:24.147094 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m08:06:24.147963 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m08:06:24.148259 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m08:06:24.148519 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m08:06:24.148753 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m08:06:24.492498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c37b350>]}
[0m08:06:24.550633 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:06:24.554726 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:06:24.605543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c362d80>]}
[0m08:06:24.605957 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:06:24.607742 [info ] [MainThread]: 
[0m08:06:24.608081 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:06:24.608430 [info ] [MainThread]: 
[0m08:06:24.608960 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:06:24.611887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:06:24.637809 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:06:24.638230 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:06:24.638534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:06:24.643701 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:06:24.644704 [debug] [ThreadPool]: On list_staging: Close
[0m08:06:24.645272 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:06:24.645659 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:06:24.649735 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:06:24.650003 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:06:24.650237 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:24.653888 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.654150 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:06:24.654400 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:06:24.654993 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:06:24.655755 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:06:24.656050 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:06:24.656309 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:06:24.656920 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:06:24.657191 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:06:24.658210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:06:24.662110 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:06:24.662351 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:06:24.662584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:06:24.666248 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.666504 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:06:24.666735 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:06:24.669116 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:06:24.669934 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:06:24.670262 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:06:24.673255 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.673521 [debug] [MainThread]: On master: BEGIN
[0m08:06:24.673753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:06:24.677123 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:06:24.677420 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.677808 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:06:24.693897 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:06:24.694707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c3639e0>]}
[0m08:06:24.695050 [debug] [MainThread]: On master: ROLLBACK
[0m08:06:24.695377 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.695621 [debug] [MainThread]: On master: BEGIN
[0m08:06:24.695998 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:06:24.696282 [debug] [MainThread]: On master: COMMIT
[0m08:06:24.696538 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.696756 [debug] [MainThread]: On master: COMMIT
[0m08:06:24.697052 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:06:24.697276 [debug] [MainThread]: On master: Close
[0m08:06:24.700761 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:06:24.701165 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:06:24.701545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:06:24.701810 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:06:24.706367 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:06:24.707863 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:06:24.733968 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:06:24.735100 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:06:24.735358 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:06:24.735608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.739233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.739525 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:06:24.739805 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:06:24.740318 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:06:24.740630 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:06:24.741007 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:06:24.745141 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:06:24.746395 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e39c7a0>]}
[0m08:06:24.747101 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:06:24.747597 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:06:24.747883 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:06:24.748203 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:06:24.748539 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:06:24.749330 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:06:24.749604 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:06:24.752056 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.752830 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:06:24.755370 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.756167 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.756426 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:06:24.756672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.760604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.760937 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.761211 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:06:24.762967 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:06:24.767951 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.768277 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:06:24.768881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:06:24.778792 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:06:24.779103 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.779382 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:06:24.780246 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:06:24.784650 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:06:24.787930 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:06:24.788207 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:06:24.788610 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:06:24.790288 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:06:24.790776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffe9610>]}
[0m08:06:24.791274 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:06:24.791794 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:06:24.792156 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:06:24.792567 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:06:24.792999 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:06:24.793304 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:06:24.793545 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:06:24.793807 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:06:24.794356 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:06:24.794662 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:06:24.794870 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:06:24.795132 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:06:24.795655 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:06:24.795934 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:06:24.796146 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:06:24.796409 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:06:24.796892 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:06:24.797170 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:06:24.797379 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:06:24.797636 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:06:24.798110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:06:24.798381 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:06:24.804319 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:06:24.805533 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:06:24.817187 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:06:24.818357 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:06:24.818642 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:06:24.818925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.822826 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.823141 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:06:24.823390 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:06:24.824487 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:06:24.826744 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:06:24.827077 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:06:24.827500 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:06:24.827987 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:06:24.828272 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:06:24.828564 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:06:24.828909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:06:24.829160 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:06:24.832463 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:06:24.833290 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:06:24.834868 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:06:24.835653 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:06:24.835890 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:06:24.836114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.839622 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:06:24.839899 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:06:24.840142 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:06:24.841072 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:06:24.842105 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:06:24.842429 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:06:24.842840 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:06:24.843260 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:06:24.843542 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:06:24.843812 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:06:24.844201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:06:24.844517 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:06:24.847614 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:06:24.848555 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:06:24.851880 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:06:24.852583 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:06:24.852835 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:06:24.853066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.857655 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:06:24.857958 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:06:24.858210 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:06:24.859331 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:06:24.860415 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:06:24.860761 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:06:24.861302 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.02s]
[0m08:06:24.861872 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:06:24.862521 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:06:24.862862 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:06:24.863212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:06:24.863494 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:06:24.912216 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:06:24.913637 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:06:24.928923 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:06:24.929803 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:06:24.930077 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:06:24.930345 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:06:24.934311 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:06:24.934629 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:06:24.934881 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:06:24.935588 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:06:24.935862 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:06:24.936216 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:06:24.938028 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:06:24.938388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '900a6ffe-4961-4bc2-9650-53a4f7dfde36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c343b30>]}
[0m08:06:24.938850 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.08s]
[0m08:06:24.939306 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:06:24.939718 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:06:24.940364 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:06:24.940701 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:06:24.941192 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:06:24.941504 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:06:24.941722 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:06:24.941983 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:06:24.942494 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:06:24.942786 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:06:24.942998 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:06:24.943257 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:06:24.943724 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:06:24.944001 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:06:24.944210 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:06:24.944463 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:06:24.944960 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:06:24.945236 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:06:24.946185 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.946440 [debug] [MainThread]: On master: BEGIN
[0m08:06:24.946690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:06:24.950180 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:06:24.950461 [debug] [MainThread]: On master: COMMIT
[0m08:06:24.950727 [debug] [MainThread]: Using postgres connection "master"
[0m08:06:24.950956 [debug] [MainThread]: On master: COMMIT
[0m08:06:24.951266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:06:24.951505 [debug] [MainThread]: On master: Close
[0m08:06:24.951808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:06:24.952029 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:06:24.952307 [info ] [MainThread]: 
[0m08:06:24.952589 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m08:06:24.953703 [debug] [MainThread]: Command end result
[0m08:06:24.973873 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:06:24.975275 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:06:24.979526 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:06:24.979819 [info ] [MainThread]: 
[0m08:06:24.980127 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:06:24.980452 [info ] [MainThread]: 
[0m08:06:24.980813 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:06:24.981105 [info ] [MainThread]: 
[0m08:06:24.981421 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:06:24.981735 [info ] [MainThread]: 
[0m08:06:24.982063 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:06:24.982868 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1839898, "process_in_blocks": "45000", "process_kernel_time": 0.179702, "process_mem_max_rss": "129628", "process_out_blocks": "8392", "process_user_time": 2.755769}
[0m08:06:24.983163 [debug] [MainThread]: Command `dbt build` failed at 08:06:24.983107 after 1.18 seconds
[0m08:06:24.983434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff804b3080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7de50710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c679850>]}
[0m08:06:24.983705 [debug] [MainThread]: Flushing usage events
[0m08:06:25.526039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:16:37.529230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb93cc2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb913b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb913b080>]}


============================== 08:16:37.536945 | 9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9 ==============================
[0m08:16:37.536945 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:16:37.537485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:16:37.642393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb85e7740>]}
[0m08:16:37.678459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8d1f6b0>]}
[0m08:16:37.679251 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:16:37.730049 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:16:37.817451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:16:37.817945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:16:37.848797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb799c7a0>]}
[0m08:16:37.909953 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:16:37.913639 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:16:37.960113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7661310>]}
[0m08:16:37.960564 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:16:37.962493 [info ] [MainThread]: 
[0m08:16:37.962832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:16:37.963071 [info ] [MainThread]: 
[0m08:16:37.963486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:16:37.966337 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:16:37.991061 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:16:37.991495 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:16:37.991777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:16:37.996685 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:16:37.997610 [debug] [ThreadPool]: On list_staging: Close
[0m08:16:37.998196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:16:37.998579 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:16:38.002475 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:16:38.002753 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:16:38.003003 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:38.006709 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.006994 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:16:38.007267 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:16:38.007780 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:16:38.008480 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:16:38.008760 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:16:38.009007 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:16:38.009632 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:16:38.009887 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:16:38.010880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:16:38.015982 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:16:38.016284 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:16:38.016495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:16:38.019991 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:16:38.020273 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:16:38.020541 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:16:38.022682 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:16:38.023503 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:16:38.023854 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:16:38.026947 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.027216 [debug] [MainThread]: On master: BEGIN
[0m08:16:38.027466 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:16:38.031192 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.031444 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.031772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:16:38.047666 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:16:38.048510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ac8380>]}
[0m08:16:38.048867 [debug] [MainThread]: On master: ROLLBACK
[0m08:16:38.049241 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.049476 [debug] [MainThread]: On master: BEGIN
[0m08:16:38.049869 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:16:38.050117 [debug] [MainThread]: On master: COMMIT
[0m08:16:38.050349 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.050567 [debug] [MainThread]: On master: COMMIT
[0m08:16:38.050861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:16:38.051107 [debug] [MainThread]: On master: Close
[0m08:16:38.053907 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:16:38.054289 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:16:38.054657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:16:38.054970 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:16:38.059516 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:16:38.063828 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:16:38.087668 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:16:38.088931 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:16:38.089207 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:16:38.089476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.093023 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.093291 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:16:38.093572 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:16:38.094009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:16:38.094267 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:16:38.094618 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:16:38.097426 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:16:38.098627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6adb9e0>]}
[0m08:16:38.099087 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:16:38.099615 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:16:38.099957 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:16:38.100306 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:16:38.100671 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:16:38.101498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:16:38.101796 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:16:38.104128 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.104877 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:16:38.107211 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.107870 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.108129 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:16:38.108347 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.111894 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.112158 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.112424 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:16:38.114049 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:16:38.118471 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.118819 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:16:38.119275 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:16:38.128950 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:16:38.129241 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.129509 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:16:38.130167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:16:38.134121 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:16:38.137369 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:16:38.137632 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:16:38.137963 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:16:38.139549 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:16:38.140003 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaee9670>]}
[0m08:16:38.140475 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:16:38.140918 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:16:38.141246 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:16:38.141598 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:16:38.142001 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:16:38.142341 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:16:38.142563 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:16:38.142839 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:16:38.143325 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:16:38.143616 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:16:38.143832 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:16:38.144118 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:16:38.144596 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:16:38.144883 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:16:38.145123 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:16:38.145388 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:16:38.145830 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:16:38.146124 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:16:38.146328 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:16:38.146579 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:16:38.147051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:16:38.147329 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:16:38.156347 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:16:38.157460 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:16:38.169351 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:16:38.170653 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:16:38.170902 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:16:38.171138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.174631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:16:38.174871 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:16:38.175116 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:16:38.176069 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:16:38.178304 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:16:38.178628 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:16:38.179033 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:16:38.179445 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:16:38.179735 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:16:38.180009 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:16:38.180364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:16:38.180635 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:16:38.183688 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:16:38.184588 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:16:38.186241 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:16:38.187068 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:16:38.187317 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:16:38.187537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.191008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:16:38.191273 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:16:38.191521 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:16:38.192396 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:16:38.193401 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:16:38.193719 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:16:38.194136 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:16:38.194575 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:16:38.194872 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:16:38.195148 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:16:38.195446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:16:38.195734 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:16:38.198654 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:16:38.199538 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:16:38.201132 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:16:38.201740 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:16:38.201972 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:16:38.202228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.205624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:16:38.205864 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:16:38.206112 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:16:38.207127 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:16:38.208068 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:16:38.208394 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:16:38.208771 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:16:38.209149 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:16:38.209769 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:16:38.210158 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:16:38.210493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:16:38.210773 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:16:38.212940 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:16:38.213676 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:16:38.230363 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:16:38.231274 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:16:38.231565 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:16:38.231851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:16:38.235753 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.236005 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:16:38.236353 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:16:38.237043 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:16:38.237310 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:16:38.237672 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:16:38.239464 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:16:38.239838 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a00fc1f-1ef7-4ee5-b8d9-6dfba9fa89c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5f8ec30>]}
[0m08:16:38.240311 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:16:38.240700 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:16:38.241079 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:16:38.241969 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:16:38.242325 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:16:38.242632 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:16:38.242915 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:16:38.243157 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:16:38.243433 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:16:38.243925 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:16:38.244209 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:16:38.244437 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:16:38.244705 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:16:38.245165 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:16:38.245450 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:16:38.245661 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:16:38.245924 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:16:38.246463 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:16:38.246741 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:16:38.247562 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.247802 [debug] [MainThread]: On master: BEGIN
[0m08:16:38.248032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:16:38.251594 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:16:38.251847 [debug] [MainThread]: On master: COMMIT
[0m08:16:38.252084 [debug] [MainThread]: Using postgres connection "master"
[0m08:16:38.252321 [debug] [MainThread]: On master: COMMIT
[0m08:16:38.252624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:16:38.252850 [debug] [MainThread]: On master: Close
[0m08:16:38.253151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:16:38.253365 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:16:38.253646 [info ] [MainThread]: 
[0m08:16:38.253914 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:16:38.254964 [debug] [MainThread]: Command end result
[0m08:16:38.274899 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:16:38.276231 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:16:38.280771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:16:38.281024 [info ] [MainThread]: 
[0m08:16:38.281341 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:16:38.281592 [info ] [MainThread]: 
[0m08:16:38.281896 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:16:38.282152 [info ] [MainThread]: 
[0m08:16:38.282444 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:16:38.282697 [info ] [MainThread]: 
[0m08:16:38.282974 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:16:38.283687 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7896968, "process_in_blocks": "0", "process_kernel_time": 0.13187, "process_mem_max_rss": "123156", "process_out_blocks": "7519", "process_user_time": 2.393643}
[0m08:16:38.284003 [debug] [MainThread]: Command `dbt build` failed at 08:16:38.283942 after 0.79 seconds
[0m08:16:38.284288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9083350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbae57c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8fbc6b0>]}
[0m08:16:38.284535 [debug] [MainThread]: Flushing usage events
[0m08:16:39.595787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:18.818362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82181130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820d2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82183380>]}


============================== 08:17:18.824503 | 487ab865-9966-47a1-bbbb-fb2434d8e615 ==============================
[0m08:17:18.824503 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:17:18.824958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:17:18.927641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8105b530>]}
[0m08:17:18.963128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b910d0>]}
[0m08:17:18.963751 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:17:19.014225 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:17:19.099246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:17:19.099630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:17:19.130144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80f9c530>]}
[0m08:17:19.191221 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:17:19.194707 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:17:19.240361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80d75dc0>]}
[0m08:17:19.240817 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:17:19.242685 [info ] [MainThread]: 
[0m08:17:19.243010 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:17:19.243431 [info ] [MainThread]: 
[0m08:17:19.243873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:17:19.246648 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:17:19.269962 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:17:19.270398 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:17:19.270676 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:19.275637 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:17:19.276540 [debug] [ThreadPool]: On list_staging: Close
[0m08:17:19.277104 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:17:19.277465 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:17:19.281497 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:17:19.281824 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:17:19.282061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:19.285667 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.285976 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:17:19.286233 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:17:19.286792 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:17:19.287420 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:17:19.287674 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:17:19.287910 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:17:19.288497 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:17:19.288744 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:17:19.289675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:17:19.294644 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:17:19.294899 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:17:19.295129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:17:19.298603 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m08:17:19.298869 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:17:19.299096 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:17:19.301120 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:17:19.302009 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:17:19.302353 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:17:19.305276 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.305538 [debug] [MainThread]: On master: BEGIN
[0m08:17:19.305765 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:17:19.309161 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:17:19.309414 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.309730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:17:19.325421 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m08:17:19.326235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff800c49e0>]}
[0m08:17:19.326598 [debug] [MainThread]: On master: ROLLBACK
[0m08:17:19.326927 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.327160 [debug] [MainThread]: On master: BEGIN
[0m08:17:19.327549 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:17:19.328034 [debug] [MainThread]: On master: COMMIT
[0m08:17:19.328355 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.328609 [debug] [MainThread]: On master: COMMIT
[0m08:17:19.328981 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:17:19.329271 [debug] [MainThread]: On master: Close
[0m08:17:19.332773 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:17:19.333221 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:17:19.333635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:17:19.334045 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:17:19.338632 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:17:19.339900 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:17:19.364215 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:17:19.365284 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:17:19.365581 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:17:19.365847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.369840 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.370159 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:17:19.370453 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:17:19.370911 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:17:19.371188 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:17:19.371570 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:17:19.374216 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:17:19.375491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a19cd0>]}
[0m08:17:19.375978 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:17:19.376585 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:17:19.376950 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:17:19.377454 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:17:19.377798 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:17:19.378646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:17:19.378938 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:17:19.381383 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.382171 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:17:19.384616 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.385974 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.386354 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:17:19.386667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.390923 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.391537 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.391875 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:17:19.393713 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:17:19.398936 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.399277 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:17:19.399893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:17:19.410000 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:17:19.410304 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.410594 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:17:19.411453 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:17:19.415729 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:17:19.419038 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:17:19.419332 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:17:19.419682 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:17:19.421335 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:17:19.421801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844e9460>]}
[0m08:17:19.422268 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:17:19.422736 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:17:19.423105 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:17:19.423570 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:17:19.423898 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:17:19.424199 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:17:19.424452 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:17:19.424734 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:17:19.425250 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:17:19.425575 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:17:19.425801 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:17:19.426078 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:17:19.426698 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:17:19.426992 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:17:19.427216 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:17:19.427498 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:17:19.427984 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:17:19.428273 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:17:19.428511 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:17:19.428768 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:17:19.429302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:17:19.429612 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:17:19.438726 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:17:19.439692 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:17:19.451187 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:17:19.452234 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:17:19.452534 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:17:19.452802 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.456738 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.457046 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:17:19.457652 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:17:19.459074 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:17:19.461443 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:17:19.461800 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:17:19.462269 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:17:19.462745 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:17:19.463112 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:17:19.463469 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:17:19.463938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:17:19.464266 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:17:19.467275 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:17:19.468095 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:17:19.469761 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:17:19.470386 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:17:19.470625 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:17:19.470840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.474553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.474838 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:17:19.475081 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:17:19.476004 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:17:19.477032 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:17:19.477363 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:17:19.477757 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:17:19.478153 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:17:19.478416 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:17:19.478730 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:17:19.479134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:17:19.479577 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:17:19.482462 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:17:19.483165 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:17:19.484758 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:17:19.485379 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:17:19.485626 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:17:19.485847 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.489439 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.489763 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:17:19.490008 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:17:19.491045 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:17:19.492004 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:17:19.492332 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:17:19.492705 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:17:19.493153 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:17:19.493813 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:17:19.494229 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:17:19.494751 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:17:19.495006 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:17:19.497132 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:17:19.497794 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:17:19.513034 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:17:19.513805 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:17:19.514067 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:17:19.514333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:17:19.518150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.518501 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:17:19.518796 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:17:19.519483 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:17:19.519779 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:17:19.520136 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:17:19.522038 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:17:19.522421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '487ab865-9966-47a1-bbbb-fb2434d8e615', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b50b950>]}
[0m08:17:19.522870 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:17:19.523340 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:17:19.523730 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:17:19.524630 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:17:19.524932 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:17:19.525267 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:17:19.525567 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:17:19.525778 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:17:19.526048 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:17:19.526535 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:17:19.526823 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:17:19.527033 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:17:19.527300 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:17:19.527821 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:17:19.528102 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:17:19.528330 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:17:19.528589 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:17:19.529047 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:17:19.529346 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:17:19.531012 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.531256 [debug] [MainThread]: On master: BEGIN
[0m08:17:19.531592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:17:19.535750 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:17:19.536149 [debug] [MainThread]: On master: COMMIT
[0m08:17:19.536403 [debug] [MainThread]: Using postgres connection "master"
[0m08:17:19.536685 [debug] [MainThread]: On master: COMMIT
[0m08:17:19.537005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:17:19.537246 [debug] [MainThread]: On master: Close
[0m08:17:19.537588 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:19.537809 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:17:19.538096 [info ] [MainThread]: 
[0m08:17:19.538373 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:17:19.539627 [debug] [MainThread]: Command end result
[0m08:17:19.559974 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:17:19.561375 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:17:19.565826 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:17:19.566068 [info ] [MainThread]: 
[0m08:17:19.566374 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:17:19.566671 [info ] [MainThread]: 
[0m08:17:19.567036 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:17:19.567382 [info ] [MainThread]: 
[0m08:17:19.567691 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:17:19.567948 [info ] [MainThread]: 
[0m08:17:19.568267 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:17:19.569007 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7854004, "process_in_blocks": "0", "process_kernel_time": 0.142581, "process_mem_max_rss": "123384", "process_out_blocks": "7519", "process_user_time": 2.315442}
[0m08:17:19.569310 [debug] [MainThread]: Command `dbt build` failed at 08:17:19.569255 after 0.79 seconds
[0m08:17:19.569612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff820d2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828aa540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828ab4d0>]}
[0m08:17:19.569864 [debug] [MainThread]: Flushing usage events
[0m08:17:20.021969 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:41.921867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84346450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843474a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83d170e0>]}


============================== 08:24:41.928155 | 6d06ed1a-ec27-4a28-b71a-bb6f8e50e436 ==============================
[0m08:24:41.928155 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:24:41.928621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m08:24:42.034625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836ea3c0>]}
[0m08:24:42.069989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82bff6b0>]}
[0m08:24:42.070624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:24:42.121942 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:24:42.208340 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:24:42.208692 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:24:42.239095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82a79af0>]}
[0m08:24:42.300138 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:24:42.303778 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:24:42.350697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b7f5c0>]}
[0m08:24:42.351283 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:24:42.353303 [info ] [MainThread]: 
[0m08:24:42.353667 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:42.354019 [info ] [MainThread]: 
[0m08:24:42.354525 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:24:42.357516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:24:42.381222 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:24:42.381623 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:24:42.381892 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:42.387612 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:24:42.388632 [debug] [ThreadPool]: On list_staging: Close
[0m08:24:42.389238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:24:42.389631 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:24:42.393619 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:24:42.393884 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:24:42.394147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:42.397960 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.398318 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:24:42.398594 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:24:42.399126 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:24:42.399822 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:24:42.400097 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:24:42.400327 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:24:42.401314 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m08:24:42.401565 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:24:42.402537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:24:42.407594 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:24:42.407865 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:24:42.408089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:24:42.411725 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.411979 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:24:42.412243 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:24:42.414489 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:24:42.415329 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:24:42.415663 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:24:42.418788 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.419052 [debug] [MainThread]: On master: BEGIN
[0m08:24:42.419299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:24:42.422991 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.423322 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.423690 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:24:42.439740 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:24:42.440596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81bc8140>]}
[0m08:24:42.440957 [debug] [MainThread]: On master: ROLLBACK
[0m08:24:42.441306 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.441536 [debug] [MainThread]: On master: BEGIN
[0m08:24:42.441919 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:24:42.442191 [debug] [MainThread]: On master: COMMIT
[0m08:24:42.442439 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.442662 [debug] [MainThread]: On master: COMMIT
[0m08:24:42.443005 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:24:42.443234 [debug] [MainThread]: On master: Close
[0m08:24:42.446136 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:24:42.446582 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:24:42.446954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:24:42.447254 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:24:42.451834 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:24:42.453256 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:24:42.476977 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:24:42.478028 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:24:42.478323 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:24:42.478594 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.482489 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.482802 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:24:42.483089 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:24:42.483530 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:24:42.483828 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:24:42.484185 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:24:42.486961 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:24:42.488173 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff843a46b0>]}
[0m08:24:42.488653 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:24:42.489131 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:24:42.489509 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:24:42.489969 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:24:42.490324 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:24:42.491235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:24:42.491556 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:24:42.493940 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.494738 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:24:42.497038 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.497676 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.497919 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:24:42.498137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.501854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.502130 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.502394 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:24:42.504081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:24:42.508736 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.509058 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:24:42.509741 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:24:42.519874 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:24:42.520190 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.520491 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:24:42.521340 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:24:42.525452 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:24:42.528720 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:24:42.528993 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:24:42.529397 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:24:42.531034 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:24:42.531494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fed580>]}
[0m08:24:42.531940 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:24:42.532372 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:24:42.532744 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:24:42.533203 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:24:42.533517 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:24:42.533854 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:24:42.534094 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:24:42.534377 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:24:42.534923 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:24:42.535233 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:24:42.535472 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:24:42.535743 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:24:42.536222 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:24:42.536519 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:24:42.536733 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:24:42.537000 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:24:42.537515 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:24:42.537799 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:24:42.538007 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:24:42.538260 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:24:42.538782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:24:42.539044 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:24:42.548405 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:24:42.549379 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:24:42.560912 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:24:42.561928 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:24:42.562231 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:24:42.562538 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.566529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.566820 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:24:42.567067 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:24:42.568116 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:24:42.570399 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:24:42.570734 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:24:42.571154 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:24:42.571699 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:24:42.572034 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:24:42.572439 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:24:42.572827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:24:42.573166 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:24:42.576311 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:24:42.577128 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:24:42.578789 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:24:42.579383 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:24:42.579645 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:24:42.579890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.583468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.583751 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:24:42.583990 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:24:42.584922 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:24:42.585960 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:24:42.586293 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:24:42.586681 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:24:42.587099 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:24:42.587369 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:24:42.587677 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:24:42.588103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:24:42.588522 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:24:42.591277 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:24:42.592151 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:24:42.593805 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:24:42.594422 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:24:42.594663 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:24:42.594874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.598387 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.598670 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:24:42.598904 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:24:42.599892 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:24:42.600841 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:24:42.601149 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:24:42.601532 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:24:42.601925 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:24:42.602541 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:24:42.602927 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:24:42.603405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:24:42.603763 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:24:42.605865 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:24:42.606597 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:24:42.621589 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:24:42.622337 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:24:42.622604 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:24:42.622866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:24:42.626664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.626948 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:24:42.627188 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:24:42.627877 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:24:42.628154 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:24:42.628539 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:24:42.630300 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:24:42.630671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d06ed1a-ec27-4a28-b71a-bb6f8e50e436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81938b30>]}
[0m08:24:42.631113 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:24:42.631604 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:24:42.631977 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:24:42.632599 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:24:42.632895 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:24:42.633233 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:24:42.633580 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:24:42.633812 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:24:42.634066 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:24:42.634575 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:24:42.634871 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:24:42.635096 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:24:42.635366 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:24:42.635815 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:24:42.636110 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:24:42.636359 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:24:42.636614 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:24:42.637078 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:24:42.637359 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:24:42.638284 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.638534 [debug] [MainThread]: On master: BEGIN
[0m08:24:42.638766 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:24:42.642795 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:24:42.643101 [debug] [MainThread]: On master: COMMIT
[0m08:24:42.643335 [debug] [MainThread]: Using postgres connection "master"
[0m08:24:42.643557 [debug] [MainThread]: On master: COMMIT
[0m08:24:42.643864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:24:42.644095 [debug] [MainThread]: On master: Close
[0m08:24:42.644395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:42.644613 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:24:42.644901 [info ] [MainThread]: 
[0m08:24:42.645174 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:24:42.646281 [debug] [MainThread]: Command end result
[0m08:24:42.666187 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:24:42.667725 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:24:42.672153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:24:42.672409 [info ] [MainThread]: 
[0m08:24:42.672673 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:24:42.673039 [info ] [MainThread]: 
[0m08:24:42.673391 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:24:42.673691 [info ] [MainThread]: 
[0m08:24:42.674073 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:24:42.674312 [info ] [MainThread]: 
[0m08:24:42.674652 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:24:42.675413 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7883453, "process_in_blocks": "0", "process_kernel_time": 0.154936, "process_mem_max_rss": "123300", "process_out_blocks": "7519", "process_user_time": 2.344046}
[0m08:24:42.675709 [debug] [MainThread]: Command `dbt build` failed at 08:24:42.675653 after 0.79 seconds
[0m08:24:42.675971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88317110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836e4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836e5610>]}
[0m08:24:42.676218 [debug] [MainThread]: Flushing usage events
[0m08:24:42.681680 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:36:33.739898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa922b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8977830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa91ccfe0>]}


============================== 08:36:33.746458 | bce4b69c-1ca0-45c1-818f-f76b0443ade7 ==============================
[0m08:36:33.746458 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:36:33.746970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m08:36:33.851354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa89ff4d0>]}
[0m08:36:33.887201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa92bc0e0>]}
[0m08:36:33.887893 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:36:33.937644 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:36:34.022727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:36:34.023120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:36:34.063113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa787c350>]}
[0m08:36:34.131912 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:36:34.135839 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:36:34.182629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7529130>]}
[0m08:36:34.183108 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:36:34.185055 [info ] [MainThread]: 
[0m08:36:34.185401 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:36:34.185706 [info ] [MainThread]: 
[0m08:36:34.186123 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:36:34.188962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:36:34.212500 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:36:34.212986 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:36:34.213270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:34.218972 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m08:36:34.220052 [debug] [ThreadPool]: On list_staging: Close
[0m08:36:34.220720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:36:34.221132 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:36:34.225306 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:36:34.225627 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:36:34.225884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:34.229818 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.230095 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:36:34.230414 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:36:34.230955 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:36:34.231666 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:36:34.231935 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:36:34.232175 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:36:34.232885 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:36:34.233137 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:36:34.234176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:36:34.239510 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:36:34.239795 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:36:34.240004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:36:34.243795 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.244103 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:36:34.244398 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:36:34.246566 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:36:34.247455 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:36:34.247829 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:36:34.251218 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.251495 [debug] [MainThread]: On master: BEGIN
[0m08:36:34.251747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:34.255515 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.255783 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.256108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:36:34.272107 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:36:34.273065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa68cc260>]}
[0m08:36:34.273472 [debug] [MainThread]: On master: ROLLBACK
[0m08:36:34.273880 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.274126 [debug] [MainThread]: On master: BEGIN
[0m08:36:34.274552 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:36:34.274786 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.275018 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.275237 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.275555 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:34.275808 [debug] [MainThread]: On master: Close
[0m08:36:34.278899 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:36:34.279343 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:36:34.279770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:36:34.280055 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:36:34.284796 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:36:34.286804 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:36:34.312409 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:36:34.313819 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:36:34.314157 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:36:34.314451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.318657 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.318959 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:36:34.319239 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:36:34.319703 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:36:34.319939 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:36:34.320316 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:36:34.322995 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:36:34.324228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9194680>]}
[0m08:36:34.324751 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:36:34.325210 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:36:34.325583 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:36:34.325953 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:36:34.326286 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:36:34.327109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:36:34.327409 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:36:34.330068 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.331152 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:36:34.333593 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.334299 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.334553 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:36:34.334775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.338791 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.339103 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.339390 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:36:34.341107 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:36:34.346164 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.346458 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:36:34.346981 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:36:34.357195 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:36:34.357622 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.357901 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:36:34.358865 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:36:34.363142 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:36:34.366480 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:36:34.366782 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:36:34.367223 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:36:34.368956 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:36:34.369445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadb5460>]}
[0m08:36:34.369956 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:36:34.370381 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:36:34.370766 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:36:34.371156 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:36:34.371582 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:36:34.371880 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:36:34.372100 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:36:34.372377 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:36:34.372856 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:36:34.373145 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:36:34.373352 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:36:34.373626 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:36:34.374074 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:36:34.374347 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:36:34.374565 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:36:34.374809 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:36:34.375258 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:36:34.375554 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:36:34.375772 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:36:34.376036 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:36:34.376549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:36:34.376809 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:36:34.386479 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:36:34.387592 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:36:34.399708 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:36:34.400909 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:36:34.401193 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:36:34.401465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.405572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.405839 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:36:34.406076 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:36:34.407214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:36:34.409637 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:36:34.410008 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:36:34.410503 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:36:34.410998 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:36:34.411315 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:36:34.411677 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:36:34.412047 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:36:34.412367 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:36:34.415785 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:36:34.416676 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:36:34.418322 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:36:34.419012 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:36:34.419273 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:36:34.419496 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.423458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.423765 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:36:34.424006 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:36:34.424967 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:36:34.426076 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:36:34.426403 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:36:34.426845 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:36:34.427280 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:36:34.427590 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:36:34.427980 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:36:34.428434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:36:34.428830 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:36:34.431901 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:36:34.432872 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:36:34.434495 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:36:34.435158 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:36:34.435402 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:36:34.435640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.439347 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.439605 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:36:34.439846 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:36:34.440962 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:36:34.442060 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:36:34.442396 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:36:34.442862 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:36:34.443297 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:36:34.444078 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:36:34.444484 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:36:34.445114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:36:34.445384 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:36:34.447649 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:36:34.448331 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:36:34.464053 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:36:34.464977 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:36:34.465264 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:36:34.465509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:36:34.469465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.469796 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:36:34.470054 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:36:34.470735 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:36:34.470991 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:36:34.471356 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:36:34.473190 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:36:34.473610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bce4b69c-1ca0-45c1-818f-f76b0443ade7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5d7f020>]}
[0m08:36:34.474151 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:36:34.474591 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:36:34.474971 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:36:34.475620 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:36:34.475932 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:36:34.476412 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:36:34.476906 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:36:34.477144 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:36:34.477425 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:36:34.477967 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:36:34.478253 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:36:34.478463 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:36:34.478746 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:36:34.479215 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:36:34.479507 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:36:34.479766 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:36:34.480017 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:36:34.480477 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:36:34.480762 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:36:34.481692 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.481937 [debug] [MainThread]: On master: BEGIN
[0m08:36:34.482169 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:36:34.486197 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:36:34.486460 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.486786 [debug] [MainThread]: Using postgres connection "master"
[0m08:36:34.487025 [debug] [MainThread]: On master: COMMIT
[0m08:36:34.487334 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:36:34.487575 [debug] [MainThread]: On master: Close
[0m08:36:34.487877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:34.488088 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:36:34.488385 [info ] [MainThread]: 
[0m08:36:34.488721 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m08:36:34.489762 [debug] [MainThread]: Command end result
[0m08:36:34.510532 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:36:34.512108 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:36:34.516648 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:36:34.516925 [info ] [MainThread]: 
[0m08:36:34.517244 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:36:34.517498 [info ] [MainThread]: 
[0m08:36:34.517813 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:36:34.518068 [info ] [MainThread]: 
[0m08:36:34.518340 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:36:34.518633 [info ] [MainThread]: 
[0m08:36:34.518915 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:36:34.519662 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.81506777, "process_in_blocks": "0", "process_kernel_time": 0.14743, "process_mem_max_rss": "123424", "process_out_blocks": "7519", "process_user_time": 2.363876}
[0m08:36:34.519975 [debug] [MainThread]: Command `dbt build` failed at 08:36:34.519913 after 0.82 seconds
[0m08:36:34.520275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b02c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8a72bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa0fb260>]}
[0m08:36:34.520561 [debug] [MainThread]: Flushing usage events
[0m08:36:34.526039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:46:17.963367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f671190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f599970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f671e80>]}


============================== 08:46:17.970122 | 8559ea3e-6f07-4239-8f42-367726c1de01 ==============================
[0m08:46:17.970122 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:46:17.970647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:46:18.072461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4d46e0>]}
[0m08:46:18.107578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f634500>]}
[0m08:46:18.108182 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:46:18.157689 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:46:18.241667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:46:18.242038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:46:18.274425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e404ce0>]}
[0m08:46:18.336243 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:46:18.340055 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:46:18.386634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e0c9ee0>]}
[0m08:46:18.387131 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:46:18.388910 [info ] [MainThread]: 
[0m08:46:18.389211 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:46:18.389450 [info ] [MainThread]: 
[0m08:46:18.389839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:46:18.392736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:46:18.416755 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:46:18.417170 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:46:18.417420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:18.422498 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:46:18.423498 [debug] [ThreadPool]: On list_staging: Close
[0m08:46:18.424167 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:46:18.424677 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:46:18.428722 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:46:18.429080 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:46:18.429413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:46:18.433913 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.434232 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:46:18.434462 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:46:18.434971 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:46:18.435675 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:46:18.435917 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:46:18.436116 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:46:18.436672 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:46:18.436958 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:46:18.438389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:46:18.443852 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:46:18.444163 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:46:18.444425 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:46:18.448362 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.448639 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:46:18.448908 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:46:18.451184 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:46:18.452118 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:46:18.452456 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:46:18.455638 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.455903 [debug] [MainThread]: On master: BEGIN
[0m08:46:18.456139 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:18.459652 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:46:18.459898 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.460222 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:46:18.475943 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m08:46:18.476728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4c4440>]}
[0m08:46:18.477090 [debug] [MainThread]: On master: ROLLBACK
[0m08:46:18.477429 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.477667 [debug] [MainThread]: On master: BEGIN
[0m08:46:18.478050 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:46:18.478285 [debug] [MainThread]: On master: COMMIT
[0m08:46:18.478522 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.478763 [debug] [MainThread]: On master: COMMIT
[0m08:46:18.479066 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:46:18.479305 [debug] [MainThread]: On master: Close
[0m08:46:18.482229 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:46:18.482650 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:46:18.483077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:46:18.483359 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:46:18.487910 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:46:18.489335 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:46:18.514029 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:46:18.515055 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:46:18.515340 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:46:18.515631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.519523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.519795 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:46:18.520075 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:46:18.520519 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:46:18.520782 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:46:18.521144 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:46:18.523803 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:46:18.525014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d4dba70>]}
[0m08:46:18.525476 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:46:18.526137 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:46:18.526505 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:46:18.527068 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:46:18.527469 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:46:18.528524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:46:18.528905 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:46:18.531376 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.532212 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:46:18.534547 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.535190 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.535444 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:46:18.535663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.539326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.539577 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.539859 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:46:18.541535 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:46:18.545923 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.546290 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:46:18.546781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:46:18.556451 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:46:18.556781 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.557088 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:46:18.557922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m08:46:18.562211 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:46:18.565510 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:46:18.565787 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:46:18.566134 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:46:18.567777 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:46:18.568223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff919857f0>]}
[0m08:46:18.568726 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:46:18.569129 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:46:18.569457 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:46:18.569876 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:46:18.570332 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:46:18.570655 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:46:18.570889 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:46:18.571183 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:46:18.571672 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:46:18.571974 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:46:18.572196 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:46:18.572467 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:46:18.572962 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:46:18.573250 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:46:18.573470 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:46:18.573742 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:46:18.574207 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:46:18.574506 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:46:18.574729 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:46:18.574993 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:46:18.575485 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:46:18.575765 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:46:18.584725 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:46:18.585853 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:46:18.597561 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:46:18.598624 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:46:18.598898 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:46:18.599148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.602938 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.603197 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:46:18.603444 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:46:18.604484 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:46:18.606793 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:46:18.607123 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:46:18.607547 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:46:18.607961 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:46:18.608240 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:46:18.608564 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:46:18.608933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:46:18.609203 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:46:18.611975 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:46:18.612901 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:46:18.614480 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:46:18.615199 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:46:18.615461 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:46:18.615727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.619100 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:46:18.619351 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:46:18.619593 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:46:18.620470 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:46:18.621521 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:46:18.621867 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:46:18.622265 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:46:18.622660 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:46:18.622932 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:46:18.623204 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:46:18.623489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:46:18.623832 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:46:18.626406 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:46:18.627408 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:46:18.628939 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:46:18.629517 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:46:18.629772 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:46:18.629989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.633327 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:46:18.633563 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:46:18.633815 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:46:18.634810 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:46:18.635792 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:46:18.636112 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:46:18.636497 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:46:18.636919 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:46:18.637534 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:46:18.637899 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:46:18.638245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:46:18.638648 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:46:18.640739 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:46:18.641389 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:46:18.656388 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:46:18.657170 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:46:18.657443 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:46:18.657686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:18.661624 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:46:18.661859 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:46:18.662091 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:46:18.662784 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:46:18.663074 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:46:18.663412 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:46:18.665225 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:46:18.665572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8559ea3e-6f07-4239-8f42-367726c1de01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d31ba70>]}
[0m08:46:18.666015 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:46:18.666439 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:46:18.666800 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:46:18.667447 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:46:18.667740 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:46:18.668260 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:46:18.668580 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:46:18.668822 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:46:18.669088 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:46:18.669561 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:46:18.669860 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:46:18.670081 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:46:18.670345 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:46:18.670785 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:46:18.671072 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:46:18.671282 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:46:18.671539 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:46:18.672013 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:46:18.672287 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:46:18.673151 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.673398 [debug] [MainThread]: On master: BEGIN
[0m08:46:18.673643 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:46:18.677082 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:46:18.677363 [debug] [MainThread]: On master: COMMIT
[0m08:46:18.677598 [debug] [MainThread]: Using postgres connection "master"
[0m08:46:18.677841 [debug] [MainThread]: On master: COMMIT
[0m08:46:18.678142 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:46:18.678367 [debug] [MainThread]: On master: Close
[0m08:46:18.678677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:18.678908 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:46:18.679205 [info ] [MainThread]: 
[0m08:46:18.679473 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m08:46:18.680484 [debug] [MainThread]: Command end result
[0m08:46:18.700306 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:46:18.701663 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:46:18.706121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:46:18.706357 [info ] [MainThread]: 
[0m08:46:18.706655 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:46:18.706917 [info ] [MainThread]: 
[0m08:46:18.707184 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:46:18.707394 [info ] [MainThread]: 
[0m08:46:18.707656 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:46:18.707867 [info ] [MainThread]: 
[0m08:46:18.708096 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:46:18.708819 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.78029525, "process_in_blocks": "0", "process_kernel_time": 0.156951, "process_mem_max_rss": "123300", "process_out_blocks": "7519", "process_user_time": 2.346268}
[0m08:46:18.709118 [debug] [MainThread]: Command `dbt build` failed at 08:46:18.709061 after 0.78 seconds
[0m08:46:18.709389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3d6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb6f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c99bb90>]}
[0m08:46:18.709672 [debug] [MainThread]: Flushing usage events
[0m08:46:19.196123 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:15.619572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a471130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a471d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a473c80>]}


============================== 08:47:15.626440 | 80b652dd-3c12-4ea9-b211-df48596e8a4e ==============================
[0m08:47:15.626440 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:47:15.626929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:47:15.728574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ed2420>]}
[0m08:47:15.763693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89ee40e0>]}
[0m08:47:15.764304 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:47:15.813758 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:47:15.899279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:15.899665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:15.930336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891b7590>]}
[0m08:47:15.991446 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:47:15.995058 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:47:16.039729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee96d0>]}
[0m08:47:16.040151 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:47:16.041928 [info ] [MainThread]: 
[0m08:47:16.042254 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:16.042607 [info ] [MainThread]: 
[0m08:47:16.043122 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:47:16.046045 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:47:16.069355 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:47:16.069769 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:47:16.070055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:16.075076 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:47:16.076474 [debug] [ThreadPool]: On list_staging: Close
[0m08:47:16.077139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:47:16.077550 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:47:16.081518 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:16.081809 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:47:16.082056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:16.085957 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.086270 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:16.086567 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:47:16.087094 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:47:16.087885 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:47:16.088160 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:16.088420 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:47:16.089037 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:47:16.089306 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:47:16.093671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:47:16.099120 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:47:16.099433 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:47:16.099691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:16.103607 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.103887 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:47:16.104213 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:47:16.106350 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:47:16.107284 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:47:16.107657 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:47:16.110843 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.111115 [debug] [MainThread]: On master: BEGIN
[0m08:47:16.111355 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:47:16.114818 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:47:16.115085 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.115423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:47:16.131075 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m08:47:16.131916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee96d0>]}
[0m08:47:16.132279 [debug] [MainThread]: On master: ROLLBACK
[0m08:47:16.132637 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.132889 [debug] [MainThread]: On master: BEGIN
[0m08:47:16.133306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:47:16.133612 [debug] [MainThread]: On master: COMMIT
[0m08:47:16.133863 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.134094 [debug] [MainThread]: On master: COMMIT
[0m08:47:16.134414 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:47:16.134651 [debug] [MainThread]: On master: Close
[0m08:47:16.137453 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:47:16.137863 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:47:16.138228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:47:16.138514 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:47:16.143684 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:47:16.145640 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:47:16.170507 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:47:16.171599 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:47:16.171900 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:47:16.172180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.176147 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.176474 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:47:16.176767 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:47:16.177238 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:47:16.177557 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:47:16.177946 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:47:16.180589 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:47:16.181815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ab942c0>]}
[0m08:47:16.182302 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:47:16.182921 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:47:16.183309 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:47:16.183802 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:47:16.184148 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:47:16.185021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:47:16.185315 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:47:16.187915 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.188729 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:47:16.191385 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.192532 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.192847 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:47:16.193127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.197150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.197442 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.197783 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:47:16.199741 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:47:16.205028 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.205362 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:47:16.205952 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:47:16.216108 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:47:16.216462 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.216750 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:47:16.217447 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:47:16.221696 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:47:16.225053 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:16.225340 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:47:16.225718 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:47:16.227379 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:47:16.227868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c7453a0>]}
[0m08:47:16.228332 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:47:16.228785 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:47:16.229147 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:47:16.229562 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:47:16.230004 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:47:16.230341 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:47:16.230601 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:47:16.230873 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:47:16.231365 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:47:16.231670 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:47:16.231896 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:47:16.232174 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:47:16.232762 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:47:16.233059 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:47:16.233287 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:47:16.233573 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:47:16.234046 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:47:16.234369 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:16.234601 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:47:16.234861 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:47:16.235358 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:47:16.235646 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:16.245118 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:16.246083 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:16.258001 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:16.259080 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:16.259359 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:47:16.259623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.263331 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.263623 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:16.263872 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:47:16.264887 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:16.267161 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:47:16.267552 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:47:16.268116 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:47:16.268634 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:16.268999 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:16.269394 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:47:16.269958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:47:16.270282 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:16.273316 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:16.274125 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:16.275835 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:16.276499 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:16.276746 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:47:16.276970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.280548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.280843 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:16.281101 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:47:16.281998 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:16.283063 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:47:16.283392 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:47:16.283815 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.01s]
[0m08:47:16.284296 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:16.284659 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:16.284992 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:47:16.285353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:47:16.285765 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:16.288904 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:16.289961 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:16.291670 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:16.292274 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:16.292525 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:47:16.292748 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.296306 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.296600 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:16.296839 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:47:16.297872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:16.298925 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:47:16.299246 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:47:16.299651 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.01s]
[0m08:47:16.300099 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:16.300914 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:47:16.301324 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:47:16.301728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:47:16.302000 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:47:16.304380 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:47:16.305096 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:47:16.320879 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:47:16.321638 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:47:16.321912 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:47:16.322173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:16.325807 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.326112 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:47:16.326362 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:47:16.327052 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:47:16.327340 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:47:16.327715 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:47:16.329505 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:47:16.329861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80b652dd-3c12-4ea9-b211-df48596e8a4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88ee8bf0>]}
[0m08:47:16.330295 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:47:16.330721 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:47:16.331087 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:47:16.331690 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:47:16.332035 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:47:16.332551 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:47:16.332827 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:47:16.333050 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:47:16.333340 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:47:16.333904 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:47:16.334207 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:47:16.334444 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:47:16.334704 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:47:16.335160 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:47:16.335463 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:47:16.335691 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:47:16.335953 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:47:16.336429 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:47:16.336718 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:47:16.337721 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.337980 [debug] [MainThread]: On master: BEGIN
[0m08:47:16.338215 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:16.341963 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:47:16.342233 [debug] [MainThread]: On master: COMMIT
[0m08:47:16.342468 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:16.342724 [debug] [MainThread]: On master: COMMIT
[0m08:47:16.343058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:47:16.343295 [debug] [MainThread]: On master: Close
[0m08:47:16.343620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:16.343844 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:47:16.344145 [info ] [MainThread]: 
[0m08:47:16.344471 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m08:47:16.345700 [debug] [MainThread]: Command end result
[0m08:47:16.366426 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:47:16.367702 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:47:16.372009 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:47:16.372250 [info ] [MainThread]: 
[0m08:47:16.372536 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:47:16.372844 [info ] [MainThread]: 
[0m08:47:16.373205 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:47:16.373509 [info ] [MainThread]: 
[0m08:47:16.373842 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:47:16.374143 [info ] [MainThread]: 
[0m08:47:16.374433 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:47:16.375177 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.78983396, "process_in_blocks": "0", "process_kernel_time": 0.134452, "process_mem_max_rss": "123288", "process_out_blocks": "7519", "process_user_time": 2.339481}
[0m08:47:16.375536 [debug] [MainThread]: Command `dbt build` failed at 08:47:16.375479 after 0.79 seconds
[0m08:47:16.375813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a15df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891b5190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5d5460>]}
[0m08:47:16.376067 [debug] [MainThread]: Flushing usage events
[0m08:47:16.825376 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:47:48.526284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4d37050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2af7c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2af6cc0>]}


============================== 08:47:48.532500 | 49d525f0-ce6c-4a93-8a98-43e49bddd5dd ==============================
[0m08:47:48.532500 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:47:48.533031 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:47:48.672821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb179e300>]}
[0m08:47:48.709606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2876d80>]}
[0m08:47:48.710697 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:47:48.762523 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:47:48.857523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:48.858002 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:48.898782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1680830>]}
[0m08:47:48.966825 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:47:48.970890 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:47:49.017927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb224e1e0>]}
[0m08:47:49.018407 [info ] [MainThread]: Found 3 models, 11 data tests, 1 source, 433 macros
[0m08:47:49.020530 [info ] [MainThread]: 
[0m08:47:49.020907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:47:49.021400 [info ] [MainThread]: 
[0m08:47:49.021916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:47:49.024828 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:47:49.048803 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:47:49.049293 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:47:49.049707 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:49.056548 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m08:47:49.057555 [debug] [ThreadPool]: On list_staging: Close
[0m08:47:49.058262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_public)
[0m08:47:49.058778 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_public"
"
[0m08:47:49.063388 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:49.063724 [debug] [ThreadPool]: On create_staging_public_public: BEGIN
[0m08:47:49.063995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:49.068405 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.068672 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:49.068920 [debug] [ThreadPool]: On create_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "create_staging_public_public"} */
create schema if not exists "public_public"
[0m08:47:49.069587 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m08:47:49.070358 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:47:49.070678 [debug] [ThreadPool]: Using postgres connection "create_staging_public_public"
[0m08:47:49.070946 [debug] [ThreadPool]: On create_staging_public_public: COMMIT
[0m08:47:49.071683 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m08:47:49.071956 [debug] [ThreadPool]: On create_staging_public_public: Close
[0m08:47:49.073103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_public, now list_staging_public_public)
[0m08:47:49.078660 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:47:49.078927 [debug] [ThreadPool]: On list_staging_public_public: BEGIN
[0m08:47:49.079158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:49.082934 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.083185 [debug] [ThreadPool]: Using postgres connection "list_staging_public_public"
[0m08:47:49.083452 [debug] [ThreadPool]: On list_staging_public_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m08:47:49.085824 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.002 seconds
[0m08:47:49.086691 [debug] [ThreadPool]: On list_staging_public_public: ROLLBACK
[0m08:47:49.087011 [debug] [ThreadPool]: On list_staging_public_public: Close
[0m08:47:49.090438 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.090748 [debug] [MainThread]: On master: BEGIN
[0m08:47:49.091043 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:47:49.094856 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.095117 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.095476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:47:49.111568 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:47:49.112459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb06c8530>]}
[0m08:47:49.112830 [debug] [MainThread]: On master: ROLLBACK
[0m08:47:49.113188 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.113427 [debug] [MainThread]: On master: BEGIN
[0m08:47:49.113820 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:47:49.114056 [debug] [MainThread]: On master: COMMIT
[0m08:47:49.114317 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.114552 [debug] [MainThread]: On master: COMMIT
[0m08:47:49.114861 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:47:49.115095 [debug] [MainThread]: On master: Close
[0m08:47:49.118175 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:47:49.118586 [info ] [Thread-1 (]: 1 of 14 START sql view model public_public.dim_car ............................. [RUN]
[0m08:47:49.118975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_public, now model.car_sales_dbt.dim_car)
[0m08:47:49.119295 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.dim_car
[0m08:47:49.123952 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.dim_car"
[0m08:47:49.125231 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.dim_car
[0m08:47:49.150236 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.dim_car"
[0m08:47:49.151453 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:47:49.151747 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: BEGIN
[0m08:47:49.152021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.156304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.156568 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.dim_car"
[0m08:47:49.156841 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.dim_car"} */

  create view "staging"."public_public"."dim_car__dbt_tmp"
    
    
  as (
    version: 2

models:
  - name: dim_car
    description: >
      Unique combination of make, model, and launch year.
    columns:
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: launch_year
        description: Launch year.
        tests: [not_null]
      - name: vehicle_type
        description: Vehicle type.
      - name: engine_size
        description: Engine size.
      - name: horsepower
        description: Horsepower.

  - name: fact_sales
    description: >
      Sales fact table aggregating total sales and average price per
      month × make × model.
    columns:
      - name: sale_month
        description: First day of the sales month.
        tests: [not_null]
      - name: make
        description: Vehicle manufacturer.
        tests: [not_null]
      - name: model
        description: Vehicle model.
        tests: [not_null]
      - name: total_sales_thousands
        description: Total sales in thousands.
      - name: avg_price_thousands
        description: Average price in thousands.
  );
[0m08:47:49.157328 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "version"
LINE 7:     version: 2
            ^

[0m08:47:49.157617 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: ROLLBACK
[0m08:47:49.158005 [debug] [Thread-1 (]: On model.car_sales_dbt.dim_car: Close
[0m08:47:49.160947 [debug] [Thread-1 (]: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:47:49.162335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb29df470>]}
[0m08:47:49.163028 [error] [Thread-1 (]: 1 of 14 ERROR creating sql view model public_public.dim_car .................... [[31mERROR[0m in 0.04s]
[0m08:47:49.163763 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:47:49.164105 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:47:49.164485 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'error'.  Reason: Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql.
[0m08:47:49.164836 [info ] [Thread-1 (]: 2 of 14 START sql view model public_public.stg_car_sales ....................... [RUN]
[0m08:47:49.165775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.dim_car, now model.car_sales_dbt.stg_car_sales)
[0m08:47:49.166077 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:47:49.168516 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.169362 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:47:49.171910 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.172679 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.172956 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:47:49.173216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.177153 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.177395 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.177651 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public_public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

with source as (

    select
        "Manufacturer"          as make,
        "Model"                 as model,
        "Sales_in_thousands"    as sales_thousands,
        "__year_resale_value"   as resale_value_after_1y,
        "Vehicle_type"          as vehicle_type,
        "Price_in_thousands"    as price_thousands,
        "Engine_size"           as engine_size,
        "Horsepower"            as horsepower,
        "Wheelbase"             as wheelbase,
        "Width"                 as width,
        "Length"                as length,
        "Curb_weight"           as curb_weight,
        "Fuel_capacity"         as fuel_capacity,
        "Fuel_efficiency"       as fuel_efficiency,
        extract(year from to_date("Latest_Launch", 'MM/DD/YYYY')) as year,
        to_date("Latest_Launch", 'MM/DD/YYYY') as launch_date,
        "Power_perf_factor"     as power_perf_factor
    from "staging"."public"."car_sales"

)

select *
from source
  );
[0m08:47:49.179452 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m08:47:49.184243 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.184671 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public_public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:47:49.185300 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:47:49.195707 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:47:49.196024 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.196307 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:47:49.197085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:47:49.201201 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_public"."stg_car_sales__dbt_backup"
[0m08:47:49.204555 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:47:49.204831 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public_public"."stg_car_sales__dbt_backup" cascade
[0m08:47:49.205205 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:47:49.206895 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:47:49.207393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4bb9580>]}
[0m08:47:49.207892 [info ] [Thread-1 (]: 2 of 14 OK created sql view model public_public.stg_car_sales .................. [[32mCREATE VIEW[0m in 0.04s]
[0m08:47:49.208404 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:47:49.208819 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:47:49.209314 [info ] [Thread-1 (]: 3 of 14 SKIP test dim_car_unique_key ........................................... [[33mSKIP[0m]
[0m08:47:49.209681 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.dim_car_unique_key.d5fdcff983
[0m08:47:49.210020 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:47:49.210283 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.dim_car_unique_key.d5fdcff983' to be skipped because of status 'skipped'. 
[0m08:47:49.210554 [info ] [Thread-1 (]: 4 of 14 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:47:49.211063 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:47:49.211377 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:47:49.211604 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:47:49.211878 [info ] [Thread-1 (]: 5 of 14 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:47:49.212411 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:47:49.212704 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:47:49.212922 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:47:49.213206 [info ] [Thread-1 (]: 6 of 14 SKIP test not_null_dim_car_car_year .................................... [[33mSKIP[0m]
[0m08:47:49.213734 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:47:49.214022 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:49.214254 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:47:49.214520 [info ] [Thread-1 (]: 7 of 14 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:47:49.215006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:47:49.215279 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:49.224660 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:49.225662 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:49.237403 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:49.238488 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:49.238740 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:47:49.238996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.243208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.243476 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:47:49.243731 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public_public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:47:49.244854 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:49.247179 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:47:49.247559 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:47:49.248017 [info ] [Thread-1 (]: 7 of 14 PASS not_null_stg_car_sales_make ....................................... [[32mPASS[0m in 0.03s]
[0m08:47:49.248475 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:47:49.248835 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:49.249180 [info ] [Thread-1 (]: 8 of 14 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:47:49.249532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:47:49.249894 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:49.253210 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:49.254225 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:49.256173 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:49.257315 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:49.257644 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:47:49.257929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.262566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:47:49.262913 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:47:49.263241 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public_public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:47:49.264511 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:49.265821 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:47:49.266333 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:47:49.267112 [info ] [Thread-1 (]: 8 of 14 PASS not_null_stg_car_sales_model ...................................... [[32mPASS[0m in 0.02s]
[0m08:47:49.267800 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:47:49.268178 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:49.268613 [info ] [Thread-1 (]: 9 of 14 START test not_null_stg_car_sales_year ................................. [RUN]
[0m08:47:49.269049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5)
[0m08:47:49.269430 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:49.273181 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:49.274120 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:49.275968 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:49.276782 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:49.277057 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: BEGIN
[0m08:47:49.277362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.281601 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.281863 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"
[0m08:47:49.282112 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select year
from "staging"."public_public"."stg_car_sales"
where year is null



  
  
      
    ) dbt_internal_test
[0m08:47:49.283256 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m08:47:49.284256 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: ROLLBACK
[0m08:47:49.284574 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5: Close
[0m08:47:49.285053 [info ] [Thread-1 (]: 9 of 14 PASS not_null_stg_car_sales_year ....................................... [[32mPASS[0m in 0.02s]
[0m08:47:49.285554 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5
[0m08:47:49.286466 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:47:49.286904 [info ] [Thread-1 (]: 10 of 14 START sql table model public_public.fact_sales ........................ [RUN]
[0m08:47:49.287271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_year.bf6741d6b5, now model.car_sales_dbt.fact_sales)
[0m08:47:49.287557 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.fact_sales
[0m08:47:49.289928 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.fact_sales"
[0m08:47:49.290630 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.fact_sales
[0m08:47:49.305960 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.fact_sales"
[0m08:47:49.306779 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:47:49.307080 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: BEGIN
[0m08:47:49.307364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:47:49.311361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.311610 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.fact_sales"
[0m08:47:49.311849 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.fact_sales"} */

  
    

  create  table "staging"."public_public"."fact_sales__dbt_tmp"
  
  
    as
  
  (
    

with base as (
  select
    *,
    date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as sale_month
  from "staging"."public_public"."stg_car_sales"
)

select
  sale_month,
  make     as car_make,
  model    as car_model,
  count(*) as total_sales,
  avg(price) as avg_price
from base
group by 1, 2, 3
order by 1 desc, 2, 3
  );
  
[0m08:47:49.312528 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                         ^

[0m08:47:49.312798 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: ROLLBACK
[0m08:47:49.313183 [debug] [Thread-1 (]: On model.car_sales_dbt.fact_sales: Close
[0m08:47:49.315039 [debug] [Thread-1 (]: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:47:49.315458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49d525f0-ce6c-4a93-8a98-43e49bddd5dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb16802f0>]}
[0m08:47:49.315902 [error] [Thread-1 (]: 10 of 14 ERROR creating sql table model public_public.fact_sales ............... [[31mERROR[0m in 0.03s]
[0m08:47:49.316354 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:47:49.316759 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'error'.  Reason: Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql.
[0m08:47:49.317787 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:47:49.318077 [info ] [Thread-1 (]: 11 of 14 SKIP test fact_sales_car_relationship ................................. [[33mSKIP[0m]
[0m08:47:49.318386 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.fact_sales_car_relationship.51322f6241
[0m08:47:49.318708 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:47:49.318938 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.fact_sales_car_relationship.51322f6241' to be skipped because of status 'skipped'. 
[0m08:47:49.319236 [info ] [Thread-1 (]: 12 of 14 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:47:49.319774 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:47:49.320082 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:47:49.320330 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:47:49.320592 [info ] [Thread-1 (]: 13 of 14 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:47:49.321086 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:47:49.321400 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:47:49.321619 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:47:49.321882 [info ] [Thread-1 (]: 14 of 14 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:47:49.322395 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:47:49.322668 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:47:49.323584 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.323850 [debug] [MainThread]: On master: BEGIN
[0m08:47:49.324088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:49.328033 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:47:49.328299 [debug] [MainThread]: On master: COMMIT
[0m08:47:49.328539 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:49.328762 [debug] [MainThread]: On master: COMMIT
[0m08:47:49.329064 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:47:49.329305 [debug] [MainThread]: On master: Close
[0m08:47:49.329624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:49.329902 [debug] [MainThread]: Connection 'model.car_sales_dbt.fact_sales' was properly closed.
[0m08:47:49.330236 [info ] [MainThread]: 
[0m08:47:49.330574 [info ] [MainThread]: Finished running 1 table model, 11 data tests, 2 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m08:47:49.331672 [debug] [MainThread]: Command end result
[0m08:47:49.351856 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:47:49.353231 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:47:49.357680 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:47:49.357916 [info ] [MainThread]: 
[0m08:47:49.358187 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m08:47:49.358471 [info ] [MainThread]: 
[0m08:47:49.358789 [error] [MainThread]:   Database Error in model dim_car (models/dim_car.sql)
  syntax error at or near "version"
  LINE 7:     version: 2
              ^
  compiled code at target/run/car_sales_dbt/models/dim_car.sql
[0m08:47:49.359062 [info ] [MainThread]: 
[0m08:47:49.359472 [error] [MainThread]:   Database Error in model fact_sales (models/fact_sales.sql)
  column "saledate" does not exist
  LINE 17:     date_trunc('month', to_date(saledate, 'YYYY-MM-DD')) as ...
                                           ^
  compiled code at target/run/car_sales_dbt/models/fact_sales.sql
[0m08:47:49.359726 [info ] [MainThread]: 
[0m08:47:49.360050 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=8 TOTAL=14
[0m08:47:49.360860 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.8696009, "process_in_blocks": "0", "process_kernel_time": 0.157267, "process_mem_max_rss": "123400", "process_out_blocks": "7519", "process_user_time": 2.406094}
[0m08:47:49.361193 [debug] [MainThread]: Command `dbt build` failed at 08:47:49.361120 after 0.87 seconds
[0m08:47:49.361485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2af6cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2838140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2838e90>]}
[0m08:47:49.361759 [debug] [MainThread]: Flushing usage events
[0m08:47:49.849762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:58.522447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96062ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96062150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967e09e0>]}


============================== 08:55:58.529014 | 4fe56f6d-0ebd-4821-afb5-65139acfdcf2 ==============================
[0m08:55:58.529014 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:55:58.529491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m08:55:58.631092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fe56f6d-0ebd-4821-afb5-65139acfdcf2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9522f3b0>]}
[0m08:56:18.483604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff845971a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff821e7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8225f920>]}


============================== 08:56:18.489724 | a55474d2-dc01-4d81-8d08-df239936a491 ==============================
[0m08:56:18.489724 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:56:18.490221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:56:18.591534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81e327b0>]}
[0m08:56:18.626153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81aebfb0>]}
[0m08:56:18.626771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:56:18.676490 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:56:18.747925 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m08:56:18.748662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c8f980>]}
[0m08:56:19.473989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80ab3aa0>]}
[0m08:56:19.524647 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:56:19.528560 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:56:19.574089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80c2ecf0>]}
[0m08:56:19.574520 [info ] [MainThread]: Found 3 models, 12 data tests, 433 macros
[0m08:56:19.576328 [info ] [MainThread]: 
[0m08:56:19.576664 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:19.577047 [info ] [MainThread]: 
[0m08:56:19.577665 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:56:19.580514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:56:19.604114 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:56:19.604516 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:56:19.604870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:19.610128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:56:19.611088 [debug] [ThreadPool]: On list_staging: Close
[0m08:56:19.612114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m08:56:19.616435 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m08:56:19.616714 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m08:56:19.616959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:56:19.620713 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.621031 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m08:56:19.621353 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:56:19.623652 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m08:56:19.625051 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m08:56:19.625412 [debug] [ThreadPool]: On list_staging_public: Close
[0m08:56:19.631776 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.632054 [debug] [MainThread]: On master: BEGIN
[0m08:56:19.632415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:56:19.636212 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.636702 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.637152 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:56:19.653458 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:56:19.654365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a60230>]}
[0m08:56:19.654752 [debug] [MainThread]: On master: ROLLBACK
[0m08:56:19.655101 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.655331 [debug] [MainThread]: On master: BEGIN
[0m08:56:19.655745 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:56:19.656024 [debug] [MainThread]: On master: COMMIT
[0m08:56:19.656400 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.656653 [debug] [MainThread]: On master: COMMIT
[0m08:56:19.656970 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:56:19.657214 [debug] [MainThread]: On master: Close
[0m08:56:19.660176 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:56:19.660619 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m08:56:19.661121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m08:56:19.661429 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:56:19.667116 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.668368 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:56:19.693548 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.694654 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.694953 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:56:19.695238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:19.699284 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.699702 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.699958 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m08:56:19.701227 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:56:19.705876 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.706200 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:56:19.706729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:56:19.718468 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:56:19.718863 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.719156 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:56:19.719899 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:56:19.724063 [debug] [Thread-1 (]: Applying DROP to: "staging"."public"."stg_car_sales__dbt_backup"
[0m08:56:19.727293 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:56:19.727559 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public"."stg_car_sales__dbt_backup" cascade
[0m08:56:19.727932 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:56:19.729561 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:56:19.730749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a55474d2-dc01-4d81-8d08-df239936a491', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84419700>]}
[0m08:56:19.731280 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_car_sales ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:56:19.731771 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:56:19.732655 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:56:19.732974 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:56:19.733392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:56:19.733720 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:56:19.741561 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:56:19.742760 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:56:19.754929 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:56:19.756014 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:56:19.756299 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:56:19.756576 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:19.760596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.760901 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:56:19.761140 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:56:19.761686 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 16: select make
                ^

[0m08:56:19.761971 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:56:19.762323 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:56:19.765293 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m08:56:19.765707 [error] [Thread-1 (]: 2 of 15 ERROR not_null_stg_car_sales_make ...................................... [[31mERROR[0m in 0.03s]
[0m08:56:19.766201 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:56:19.766663 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:56:19.767124 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql.
[0m08:56:19.767391 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:56:19.768240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:56:19.768610 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:56:19.771730 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:56:19.772435 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:56:19.774056 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:56:19.774742 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:56:19.775002 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:56:19.775233 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:19.779926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m08:56:19.780243 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:56:19.780529 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:56:19.781170 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 16: select model
                ^
HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".

[0m08:56:19.781523 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:56:19.782085 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:56:19.784059 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m08:56:19.784548 [error] [Thread-1 (]: 3 of 15 ERROR not_null_stg_car_sales_model ..................................... [[31mERROR[0m in 0.02s]
[0m08:56:19.785183 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:56:19.785853 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:56:19.786477 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql.
[0m08:56:19.786836 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_car_sales_sale_date ............................ [RUN]
[0m08:56:19.787611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02)
[0m08:56:19.788012 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:56:19.791065 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:56:19.791903 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:56:19.793564 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:56:19.794299 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:56:19.794552 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: BEGIN
[0m08:56:19.794804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:56:19.798801 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.799119 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:56:19.799370 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_date
from "staging"."public"."stg_car_sales"
where sale_date is null



  
  
      
    ) dbt_internal_test
[0m08:56:19.799887 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sale_date" does not exist
LINE 16: select sale_date
                ^

[0m08:56:19.800248 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: ROLLBACK
[0m08:56:19.800708 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: Close
[0m08:56:19.802623 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m08:56:19.803083 [error] [Thread-1 (]: 4 of 15 ERROR not_null_stg_car_sales_sale_date ................................. [[31mERROR[0m in 0.02s]
[0m08:56:19.803700 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:56:19.804414 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql.
[0m08:56:19.805199 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:56:19.805537 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m08:56:19.805945 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:56:19.806312 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:56:19.806544 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m08:56:19.806845 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m08:56:19.807488 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:56:19.807869 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m08:56:19.808096 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m08:56:19.808341 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_car_fuel .................................... [[33mSKIP[0m]
[0m08:56:19.809032 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m08:56:19.809337 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:56:19.809555 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057' to be skipped because of status 'skipped'. 
[0m08:56:19.809842 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:56:19.810341 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:56:19.810650 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:56:19.810869 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:56:19.811127 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:56:19.811595 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:56:19.811928 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:56:19.812143 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:56:19.812399 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m08:56:19.812937 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:56:19.813225 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m08:56:19.813444 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:56:19.813718 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m08:56:19.814262 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m08:56:19.814556 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:56:19.814793 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m08:56:19.815048 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:56:19.815535 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:56:19.815876 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:56:19.816096 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:56:19.816344 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:56:19.816839 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:56:19.817115 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:56:19.817331 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:56:19.817581 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:56:19.818110 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:56:19.818389 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m08:56:19.818605 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:56:19.818875 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m08:56:19.819398 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m08:56:19.819686 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m08:56:19.820572 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.820838 [debug] [MainThread]: On master: BEGIN
[0m08:56:19.821071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:56:19.824957 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:56:19.825265 [debug] [MainThread]: On master: COMMIT
[0m08:56:19.825521 [debug] [MainThread]: Using postgres connection "master"
[0m08:56:19.825764 [debug] [MainThread]: On master: COMMIT
[0m08:56:19.826088 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:56:19.826333 [debug] [MainThread]: On master: Close
[0m08:56:19.826665 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:19.826907 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' was properly closed.
[0m08:56:19.827231 [info ] [MainThread]: 
[0m08:56:19.827536 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m08:56:19.828822 [debug] [MainThread]: Command end result
[0m08:56:19.848822 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:56:19.850419 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:56:19.855091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:56:19.855336 [info ] [MainThread]: 
[0m08:56:19.855627 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m08:56:19.855982 [info ] [MainThread]: 
[0m08:56:19.856440 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m08:56:19.856879 [info ] [MainThread]: 
[0m08:56:19.857271 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m08:56:19.857579 [info ] [MainThread]: 
[0m08:56:19.858071 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m08:56:19.858348 [info ] [MainThread]: 
[0m08:56:19.858773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=11 TOTAL=15
[0m08:56:19.859832 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.4100994, "process_in_blocks": "40", "process_kernel_time": 0.142109, "process_mem_max_rss": "125664", "process_out_blocks": "8323", "process_user_time": 2.968282}
[0m08:56:19.860222 [debug] [MainThread]: Command `dbt build` failed at 08:56:19.860159 after 1.41 seconds
[0m08:56:19.860747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828d47d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ba5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80a5d4c0>]}
[0m08:56:19.861103 [debug] [MainThread]: Flushing usage events
[0m08:56:21.247853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:19.058535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9985f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9985e480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff991be7e0>]}


============================== 08:58:19.065058 | 40733220-ced7-4928-9d95-6fcb2b85d017 ==============================
[0m08:58:19.065058 [info ] [MainThread]: Running with dbt=1.9.6
[0m08:58:19.065559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:19.167790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ffefc0>]}
[0m08:58:19.203090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9985f170>]}
[0m08:58:19.203684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m08:58:19.254183 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m08:58:19.327174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:58:19.327567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:58:19.353944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f23da0>]}
[0m08:58:19.406019 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:58:19.409544 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:58:19.453937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97bf79e0>]}
[0m08:58:19.454373 [info ] [MainThread]: Found 3 models, 12 data tests, 433 macros
[0m08:58:19.456155 [info ] [MainThread]: 
[0m08:58:19.456489 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:19.456875 [info ] [MainThread]: 
[0m08:58:19.457405 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:58:19.460341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m08:58:19.483480 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m08:58:19.483881 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m08:58:19.484154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:19.489143 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m08:58:19.490134 [debug] [ThreadPool]: On list_staging: Close
[0m08:58:19.491205 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m08:58:19.495616 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m08:58:19.495902 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m08:58:19.496147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:58:19.500206 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m08:58:19.500492 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m08:58:19.500771 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m08:58:19.503668 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.003 seconds
[0m08:58:19.505100 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m08:58:19.505447 [debug] [ThreadPool]: On list_staging_public: Close
[0m08:58:19.511977 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.512254 [debug] [MainThread]: On master: BEGIN
[0m08:58:19.512491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:58:19.515930 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m08:58:19.516270 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.516586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:58:19.532555 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m08:58:19.533515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96fd52b0>]}
[0m08:58:19.533886 [debug] [MainThread]: On master: ROLLBACK
[0m08:58:19.534236 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.534477 [debug] [MainThread]: On master: BEGIN
[0m08:58:19.534890 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m08:58:19.535179 [debug] [MainThread]: On master: COMMIT
[0m08:58:19.535427 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.535662 [debug] [MainThread]: On master: COMMIT
[0m08:58:19.535979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:58:19.536216 [debug] [MainThread]: On master: Close
[0m08:58:19.539057 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m08:58:19.539464 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m08:58:19.539826 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m08:58:19.540128 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m08:58:19.546258 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.547574 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m08:58:19.571590 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.572693 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.572987 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m08:58:19.573262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:19.577275 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:58:19.577573 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.577809 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m08:58:19.579121 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m08:58:19.583303 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.583595 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m08:58:19.584241 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m08:58:19.594295 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:58:19.594630 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.594913 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m08:58:19.595565 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m08:58:19.599478 [debug] [Thread-1 (]: Applying DROP to: "staging"."public"."stg_car_sales__dbt_backup"
[0m08:58:19.602721 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m08:58:19.602995 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public"."stg_car_sales__dbt_backup" cascade
[0m08:58:19.603330 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m08:58:19.604936 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m08:58:19.606174 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40733220-ced7-4928-9d95-6fcb2b85d017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b48d490>]}
[0m08:58:19.606683 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_car_sales ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m08:58:19.607182 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m08:58:19.607947 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:58:19.608244 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_car_sales_make ................................. [RUN]
[0m08:58:19.608638 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m08:58:19.608928 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:58:19.616670 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:58:19.617598 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:58:19.629654 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:58:19.630544 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:58:19.630825 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m08:58:19.631155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:19.635053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:58:19.635419 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m08:58:19.635724 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m08:58:19.636396 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 16: select make
                ^

[0m08:58:19.636719 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m08:58:19.637107 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m08:58:19.639803 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m08:58:19.640277 [error] [Thread-1 (]: 2 of 15 ERROR not_null_stg_car_sales_make ...................................... [[31mERROR[0m in 0.03s]
[0m08:58:19.640790 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m08:58:19.641142 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:58:19.641464 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql.
[0m08:58:19.641806 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_car_sales_model ................................ [RUN]
[0m08:58:19.642979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m08:58:19.643288 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:58:19.646482 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:58:19.647301 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:58:19.649012 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:58:19.649700 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:58:19.649963 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m08:58:19.650190 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:19.653710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m08:58:19.654024 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m08:58:19.654273 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m08:58:19.654771 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 16: select model
                ^
HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".

[0m08:58:19.655055 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m08:58:19.655406 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m08:58:19.657259 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m08:58:19.657621 [error] [Thread-1 (]: 3 of 15 ERROR not_null_stg_car_sales_model ..................................... [[31mERROR[0m in 0.01s]
[0m08:58:19.658072 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m08:58:19.658380 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:58:19.658697 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql.
[0m08:58:19.659069 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_car_sales_sale_date ............................ [RUN]
[0m08:58:19.659762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02)
[0m08:58:19.660040 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:58:19.664235 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:58:19.664994 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:58:19.666578 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:58:19.667315 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:58:19.667587 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: BEGIN
[0m08:58:19.667860 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:58:19.671412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m08:58:19.671744 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m08:58:19.672013 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_date
from "staging"."public"."stg_car_sales"
where sale_date is null



  
  
      
    ) dbt_internal_test
[0m08:58:19.672516 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sale_date" does not exist
LINE 16: select sale_date
                ^

[0m08:58:19.672792 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: ROLLBACK
[0m08:58:19.673151 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: Close
[0m08:58:19.675015 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m08:58:19.675413 [error] [Thread-1 (]: 4 of 15 ERROR not_null_stg_car_sales_sale_date ................................. [[31mERROR[0m in 0.02s]
[0m08:58:19.676024 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m08:58:19.676502 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql.
[0m08:58:19.677375 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m08:58:19.677671 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m08:58:19.678192 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m08:58:19.678675 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m08:58:19.678950 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m08:58:19.679323 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m08:58:19.680364 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m08:58:19.680685 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m08:58:19.680919 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m08:58:19.681197 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_car_fuel .................................... [[33mSKIP[0m]
[0m08:58:19.681808 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m08:58:19.682144 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:58:19.682368 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057' to be skipped because of status 'skipped'. 
[0m08:58:19.682625 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m08:58:19.683135 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m08:58:19.683440 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:58:19.683657 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m08:58:19.683928 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m08:58:19.684506 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m08:58:19.684798 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:58:19.685033 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m08:58:19.685295 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m08:58:19.685780 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m08:58:19.686076 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m08:58:19.686293 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m08:58:19.686552 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m08:58:19.687103 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m08:58:19.687389 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:58:19.687601 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m08:58:19.687884 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m08:58:19.688417 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m08:58:19.688709 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:58:19.688936 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m08:58:19.689220 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m08:58:19.689821 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m08:58:19.690135 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:58:19.690361 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m08:58:19.690630 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m08:58:19.691183 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m08:58:19.691466 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m08:58:19.691673 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m08:58:19.691929 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m08:58:19.692487 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m08:58:19.692768 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m08:58:19.693728 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.694000 [debug] [MainThread]: On master: BEGIN
[0m08:58:19.694235 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:58:19.698344 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m08:58:19.698618 [debug] [MainThread]: On master: COMMIT
[0m08:58:19.698861 [debug] [MainThread]: Using postgres connection "master"
[0m08:58:19.699106 [debug] [MainThread]: On master: COMMIT
[0m08:58:19.699435 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m08:58:19.699671 [debug] [MainThread]: On master: Close
[0m08:58:19.699987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:19.700209 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' was properly closed.
[0m08:58:19.700515 [info ] [MainThread]: 
[0m08:58:19.700762 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m08:58:19.701775 [debug] [MainThread]: Command end result
[0m08:58:19.719800 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m08:58:19.721156 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m08:58:19.725487 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m08:58:19.725732 [info ] [MainThread]: 
[0m08:58:19.726014 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m08:58:19.726290 [info ] [MainThread]: 
[0m08:58:19.726631 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m08:58:19.726929 [info ] [MainThread]: 
[0m08:58:19.727280 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m08:58:19.727577 [info ] [MainThread]: 
[0m08:58:19.727941 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m08:58:19.728277 [info ] [MainThread]: 
[0m08:58:19.728583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=11 TOTAL=15
[0m08:58:19.729348 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.70673203, "process_in_blocks": "0", "process_kernel_time": 0.140873, "process_mem_max_rss": "122860", "process_out_blocks": "7462", "process_user_time": 2.289947}
[0m08:58:19.729666 [debug] [MainThread]: Command `dbt build` failed at 08:58:19.729606 after 0.71 seconds
[0m08:58:19.729940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bec080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bea960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98bea7b0>]}
[0m08:58:19.730212 [debug] [MainThread]: Flushing usage events
[0m08:58:20.222578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:03:11.858754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a34560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9724f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94a34440>]}


============================== 09:03:11.865203 | 8cdc7a89-2312-4cea-ac05-a35eaead3003 ==============================
[0m09:03:11.865203 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:03:11.865745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:03:11.967757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b3f1a0>]}
[0m09:03:12.003446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff954833e0>]}
[0m09:03:12.004072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:03:12.053876 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:03:12.126034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:03:12.126404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:03:12.152107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938307d0>]}
[0m09:03:12.204145 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:03:12.207687 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:03:12.252132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934c9df0>]}
[0m09:03:12.252583 [info ] [MainThread]: Found 3 models, 12 data tests, 433 macros
[0m09:03:12.254458 [info ] [MainThread]: 
[0m09:03:12.254832 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:03:12.255163 [info ] [MainThread]: 
[0m09:03:12.255680 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:03:12.258633 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:03:12.282422 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:03:12.282796 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:03:12.283067 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:03:12.288176 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:03:12.289541 [debug] [ThreadPool]: On list_staging: Close
[0m09:03:12.290592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:03:12.295023 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:03:12.295303 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:03:12.295578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:03:12.299446 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.299731 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:03:12.299985 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:03:12.302104 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:03:12.303488 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:03:12.303835 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:03:12.310076 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.310343 [debug] [MainThread]: On master: BEGIN
[0m09:03:12.310601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:03:12.314046 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:03:12.314308 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.314618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:03:12.330272 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:03:12.331243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96e223c0>]}
[0m09:03:12.331617 [debug] [MainThread]: On master: ROLLBACK
[0m09:03:12.331948 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.332179 [debug] [MainThread]: On master: BEGIN
[0m09:03:12.332573 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:03:12.332886 [debug] [MainThread]: On master: COMMIT
[0m09:03:12.333172 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.333397 [debug] [MainThread]: On master: COMMIT
[0m09:03:12.333732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:03:12.333980 [debug] [MainThread]: On master: Close
[0m09:03:12.336886 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:03:12.337312 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:03:12.337729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:03:12.338033 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:03:12.344151 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.345405 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:03:12.370442 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.371543 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.371815 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:03:12.372045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:12.375990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.376331 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.376601 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m09:03:12.377818 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:03:12.382186 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.382551 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m09:03:12.383134 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:03:12.393262 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:03:12.393597 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.393904 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:03:12.394583 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:03:12.398696 [debug] [Thread-1 (]: Applying DROP to: "staging"."public"."stg_car_sales__dbt_backup"
[0m09:03:12.402067 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:03:12.402345 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public"."stg_car_sales__dbt_backup" cascade
[0m09:03:12.402709 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:03:12.404373 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:03:12.405646 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cdc7a89-2312-4cea-ac05-a35eaead3003', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d85580>]}
[0m09:03:12.406153 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_car_sales ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m09:03:12.406686 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:03:12.407468 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:03:12.407786 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_car_sales_make ................................. [RUN]
[0m09:03:12.408190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m09:03:12.408479 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:03:12.416548 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:03:12.417502 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:03:12.429607 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:03:12.430803 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:03:12.431089 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m09:03:12.431399 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:12.435307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.435606 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:03:12.435851 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m09:03:12.436401 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 16: select make
                ^

[0m09:03:12.436710 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m09:03:12.437078 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m09:03:12.439836 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:03:12.440220 [error] [Thread-1 (]: 2 of 15 ERROR not_null_stg_car_sales_make ...................................... [[31mERROR[0m in 0.03s]
[0m09:03:12.440720 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:03:12.441023 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:03:12.441375 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql.
[0m09:03:12.441672 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_car_sales_model ................................ [RUN]
[0m09:03:12.442498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m09:03:12.442786 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:03:12.445669 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:03:12.446470 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:03:12.448080 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:03:12.448815 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:03:12.449091 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m09:03:12.449364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:12.453125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.453416 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:03:12.453656 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m09:03:12.454180 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 16: select model
                ^
HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".

[0m09:03:12.454457 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m09:03:12.454794 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m09:03:12.456614 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:03:12.456973 [error] [Thread-1 (]: 3 of 15 ERROR not_null_stg_car_sales_model ..................................... [[31mERROR[0m in 0.01s]
[0m09:03:12.457530 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:03:12.457949 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:03:12.458310 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql.
[0m09:03:12.458616 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_car_sales_sale_date ............................ [RUN]
[0m09:03:12.459174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02)
[0m09:03:12.459534 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:03:12.463750 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m09:03:12.464775 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:03:12.466405 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m09:03:12.467034 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m09:03:12.467275 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: BEGIN
[0m09:03:12.467509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:03:12.471186 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.471605 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"
[0m09:03:12.471920 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sale_date
from "staging"."public"."stg_car_sales"
where sale_date is null



  
  
      
    ) dbt_internal_test
[0m09:03:12.472486 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "sale_date" does not exist
LINE 16: select sale_date
                ^

[0m09:03:12.473027 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: ROLLBACK
[0m09:03:12.473536 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02: Close
[0m09:03:12.475523 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m09:03:12.476570 [error] [Thread-1 (]: 4 of 15 ERROR not_null_stg_car_sales_sale_date ................................. [[31mERROR[0m in 0.02s]
[0m09:03:12.477266 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:03:12.477922 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql.
[0m09:03:12.478956 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:03:12.479329 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:03:12.479664 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:03:12.480003 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:03:12.480213 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:03:12.480474 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:03:12.481192 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:03:12.481474 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:03:12.481691 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:03:12.481957 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_car_fuel .................................... [[33mSKIP[0m]
[0m09:03:12.482687 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:03:12.482986 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:03:12.483205 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057' to be skipped because of status 'skipped'. 
[0m09:03:12.483463 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m09:03:12.483986 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:03:12.484300 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:03:12.484534 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m09:03:12.484812 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m09:03:12.485377 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:03:12.485656 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:03:12.485878 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m09:03:12.486138 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m09:03:12.486672 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:03:12.486954 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:03:12.487175 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m09:03:12.487451 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:03:12.487931 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:03:12.488214 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:03:12.488443 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:03:12.488705 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m09:03:12.489286 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:03:12.489590 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:03:12.489803 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m09:03:12.490073 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m09:03:12.490575 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:03:12.490879 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:03:12.491103 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m09:03:12.491376 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:03:12.491844 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:03:12.492121 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:03:12.492329 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:03:12.492594 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:03:12.493084 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:03:12.493364 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:03:12.494256 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.494520 [debug] [MainThread]: On master: BEGIN
[0m09:03:12.494759 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:03:12.498728 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:03:12.499077 [debug] [MainThread]: On master: COMMIT
[0m09:03:12.499325 [debug] [MainThread]: Using postgres connection "master"
[0m09:03:12.499622 [debug] [MainThread]: On master: COMMIT
[0m09:03:12.499958 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:03:12.500194 [debug] [MainThread]: On master: Close
[0m09:03:12.500493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:03:12.500719 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' was properly closed.
[0m09:03:12.501046 [info ] [MainThread]: 
[0m09:03:12.501320 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m09:03:12.502374 [debug] [MainThread]: Command end result
[0m09:03:12.520777 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:03:12.522153 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:03:12.526495 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:03:12.526719 [info ] [MainThread]: 
[0m09:03:12.527006 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:03:12.527296 [info ] [MainThread]: 
[0m09:03:12.527661 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:03:12.527928 [info ] [MainThread]: 
[0m09:03:12.528264 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:03:12.528624 [info ] [MainThread]: 
[0m09:03:12.528919 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_sale_date (models/schema.yml)
  column "sale_date" does not exist
  LINE 16: select sale_date
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_sale_date.sql
[0m09:03:12.529172 [info ] [MainThread]: 
[0m09:03:12.529548 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=11 TOTAL=15
[0m09:03:12.530446 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.7060195, "process_in_blocks": "0", "process_kernel_time": 0.14422, "process_mem_max_rss": "122816", "process_out_blocks": "7462", "process_user_time": 2.294509}
[0m09:03:12.530817 [debug] [MainThread]: Command `dbt build` failed at 09:03:12.530748 after 0.71 seconds
[0m09:03:12.531130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95194b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff951972f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95196180>]}
[0m09:03:12.531437 [debug] [MainThread]: Flushing usage events
[0m09:03:13.030815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:04:56.877780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0181d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa291b6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa291f140>]}


============================== 09:04:56.884051 | 883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1 ==============================
[0m09:04:56.884051 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:04:56.884572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'profiles_dir': '/home/airflow/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:04:56.985153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fbf4ce0>]}
[0m09:04:57.020042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0f4d640>]}
[0m09:04:57.020633 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:04:57.069136 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:04:57.140845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:57.141476 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m09:04:57.393978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ebf71a0>]}
[0m09:04:57.444357 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:04:57.447953 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:04:57.492293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e387350>]}
[0m09:04:57.492711 [info ] [MainThread]: Found 3 models, 12 data tests, 433 macros
[0m09:04:57.494587 [info ] [MainThread]: 
[0m09:04:57.494886 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:04:57.495151 [info ] [MainThread]: 
[0m09:04:57.495591 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:04:57.498433 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:04:57.521259 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:04:57.521644 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:04:57.521912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:57.526779 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:04:57.527762 [debug] [ThreadPool]: On list_staging: Close
[0m09:04:57.529042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:04:57.533575 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:04:57.533879 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:04:57.534148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:04:57.537929 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.538200 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:04:57.538468 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:04:57.540523 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:04:57.541812 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:04:57.542188 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:04:57.548646 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.548953 [debug] [MainThread]: On master: BEGIN
[0m09:04:57.549258 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:04:57.552798 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.553095 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.553427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:04:57.569181 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:04:57.570080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e387a10>]}
[0m09:04:57.570425 [debug] [MainThread]: On master: ROLLBACK
[0m09:04:57.570755 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.571002 [debug] [MainThread]: On master: BEGIN
[0m09:04:57.571384 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:04:57.571690 [debug] [MainThread]: On master: COMMIT
[0m09:04:57.571985 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.572211 [debug] [MainThread]: On master: COMMIT
[0m09:04:57.572517 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:04:57.572750 [debug] [MainThread]: On master: Close
[0m09:04:57.575566 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:04:57.575973 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:04:57.576360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:04:57.576667 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:04:57.581720 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.582959 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:04:57.607808 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.608925 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.609213 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:04:57.609482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:57.613431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.613759 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.614069 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  public.car_sales
  );
[0m09:04:57.615359 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:04:57.621346 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.621733 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m09:04:57.622453 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:04:57.632517 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:04:57.632862 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.633140 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:04:57.633857 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:04:57.638295 [debug] [Thread-1 (]: Applying DROP to: "staging"."public"."stg_car_sales__dbt_backup"
[0m09:04:57.641691 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:04:57.641983 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public"."stg_car_sales__dbt_backup" cascade
[0m09:04:57.642417 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:04:57.644192 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:04:57.645471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '883ff72c-7f25-4bd1-97e0-7dd6a73dc6e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2449130>]}
[0m09:04:57.646034 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_car_sales ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m09:04:57.646520 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:04:57.647341 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:04:57.647640 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_car_sales_make ................................. [RUN]
[0m09:04:57.648096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m09:04:57.648385 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:04:57.656521 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:04:57.657713 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:04:57.669583 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:04:57.670520 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:04:57.670808 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m09:04:57.671080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:57.675114 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.675422 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:04:57.675681 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m09:04:57.676309 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 16: select make
                ^

[0m09:04:57.676602 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m09:04:57.676972 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m09:04:57.679862 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:04:57.680280 [error] [Thread-1 (]: 2 of 15 ERROR not_null_stg_car_sales_make ...................................... [[31mERROR[0m in 0.03s]
[0m09:04:57.680804 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:04:57.681162 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:04:57.681506 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql.
[0m09:04:57.681799 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_car_sales_model ................................ [RUN]
[0m09:04:57.682607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m09:04:57.682896 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:04:57.685812 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:04:57.686633 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:04:57.688272 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:04:57.688892 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:04:57.689125 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m09:04:57.689346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:57.692900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.693244 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:04:57.693481 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m09:04:57.694048 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 16: select model
                ^
HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".

[0m09:04:57.694351 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m09:04:57.694723 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m09:04:57.696543 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:04:57.697007 [error] [Thread-1 (]: 3 of 15 ERROR not_null_stg_car_sales_model ..................................... [[31mERROR[0m in 0.01s]
[0m09:04:57.697517 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:04:57.698088 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:04:57.698472 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql.
[0m09:04:57.698778 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_car_sales_saledate ............................. [RUN]
[0m09:04:57.699543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a)
[0m09:04:57.699866 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:04:57.702717 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:04:57.703554 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:04:57.705137 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:04:57.705848 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:04:57.706127 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: BEGIN
[0m09:04:57.706371 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:57.710053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.710358 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:04:57.710679 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select saledate
from "staging"."public"."stg_car_sales"
where saledate is null



  
  
      
    ) dbt_internal_test
[0m09:04:57.711248 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 16: select saledate
                ^

[0m09:04:57.711543 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: ROLLBACK
[0m09:04:57.712135 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: Close
[0m09:04:57.714203 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql
[0m09:04:57.714698 [error] [Thread-1 (]: 4 of 15 ERROR not_null_stg_car_sales_saledate .................................. [[31mERROR[0m in 0.02s]
[0m09:04:57.715818 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:04:57.716546 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql.
[0m09:04:57.717723 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:04:57.718125 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:04:57.718490 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:04:57.718866 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:04:57.719089 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:04:57.719376 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:04:57.720080 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:04:57.720399 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:04:57.720627 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:04:57.720916 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_car_fuel .................................... [[33mSKIP[0m]
[0m09:04:57.721613 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:04:57.721927 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:04:57.722153 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057' to be skipped because of status 'skipped'. 
[0m09:04:57.722417 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m09:04:57.722924 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:04:57.723218 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:04:57.723436 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m09:04:57.723700 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m09:04:57.724249 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:04:57.724541 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:04:57.724754 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m09:04:57.725020 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m09:04:57.725563 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:04:57.725866 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:04:57.726079 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m09:04:57.726330 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:04:57.726797 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:04:57.727105 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:04:57.727332 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:04:57.727599 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m09:04:57.728095 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:04:57.728393 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:04:57.728605 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m09:04:57.728880 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m09:04:57.729362 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:04:57.729649 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:04:57.729874 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m09:04:57.730133 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:04:57.730628 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:04:57.730926 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:04:57.731149 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:04:57.731412 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:04:57.731918 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:04:57.732208 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:04:57.733142 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.733402 [debug] [MainThread]: On master: BEGIN
[0m09:04:57.733635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:04:57.737630 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:04:57.738065 [debug] [MainThread]: On master: COMMIT
[0m09:04:57.738328 [debug] [MainThread]: Using postgres connection "master"
[0m09:04:57.738566 [debug] [MainThread]: On master: COMMIT
[0m09:04:57.738925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:04:57.739175 [debug] [MainThread]: On master: Close
[0m09:04:57.739501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:57.739732 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a' was properly closed.
[0m09:04:57.740060 [info ] [MainThread]: 
[0m09:04:57.740336 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m09:04:57.741498 [debug] [MainThread]: Command end result
[0m09:04:57.761154 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:04:57.762521 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:04:57.766737 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:04:57.766973 [info ] [MainThread]: 
[0m09:04:57.767254 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:04:57.767592 [info ] [MainThread]: 
[0m09:04:57.767907 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:04:57.768232 [info ] [MainThread]: 
[0m09:04:57.768570 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:04:57.768791 [info ] [MainThread]: 
[0m09:04:57.769139 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql
[0m09:04:57.769438 [info ] [MainThread]: 
[0m09:04:57.769731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=11 TOTAL=15
[0m09:04:57.770540 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.92739993, "process_in_blocks": "0", "process_kernel_time": 0.156393, "process_mem_max_rss": "128388", "process_out_blocks": "8327", "process_user_time": 2.464437}
[0m09:04:57.770875 [debug] [MainThread]: Command `dbt build` failed at 09:04:57.770799 after 0.93 seconds
[0m09:04:57.771170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa010efc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08a9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa08ab0b0>]}
[0m09:04:57.771440 [debug] [MainThread]: Flushing usage events
[0m09:04:58.243782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:06:53.858660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82877b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83111130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff828754f0>]}


============================== 09:06:53.865100 | bbef197b-60d1-48cc-b654-e0151fd53201 ==============================
[0m09:06:53.865100 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:06:53.865621 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:06:53.969028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff822480b0>]}
[0m09:06:54.004401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83004740>]}
[0m09:06:54.005025 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:06:54.055647 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:06:54.129888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:06:54.130478 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m09:06:54.379063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81664200>]}
[0m09:06:54.429030 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:06:54.432706 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:06:54.476684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff815ab9e0>]}
[0m09:06:54.477089 [info ] [MainThread]: Found 3 models, 12 data tests, 433 macros
[0m09:06:54.478882 [info ] [MainThread]: 
[0m09:06:54.479167 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:06:54.479433 [info ] [MainThread]: 
[0m09:06:54.479839 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:06:54.482616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:06:54.505848 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:06:54.506241 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:06:54.506518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:06:54.511589 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:06:54.512622 [debug] [ThreadPool]: On list_staging: Close
[0m09:06:54.514223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:06:54.518809 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:06:54.519114 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:06:54.519378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:06:54.523253 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:06:54.523528 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:06:54.523850 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:06:54.526182 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:06:54.527696 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:06:54.528048 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:06:54.534456 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.534734 [debug] [MainThread]: On master: BEGIN
[0m09:06:54.534973 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:06:54.538445 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:06:54.538775 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.539116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:06:54.555135 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m09:06:54.556060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80bde7e0>]}
[0m09:06:54.556411 [debug] [MainThread]: On master: ROLLBACK
[0m09:06:54.556750 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.556981 [debug] [MainThread]: On master: BEGIN
[0m09:06:54.557362 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:06:54.557661 [debug] [MainThread]: On master: COMMIT
[0m09:06:54.557895 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.558116 [debug] [MainThread]: On master: COMMIT
[0m09:06:54.558417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:06:54.558662 [debug] [MainThread]: On master: Close
[0m09:06:54.561429 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:06:54.561845 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:06:54.562205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:06:54.562511 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:06:54.567554 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.568811 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:06:54.594010 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.595265 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.595584 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:06:54.595872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:54.599919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:06:54.600233 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.600490 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  *
from
  car_sales
  );
[0m09:06:54.601791 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m09:06:54.607255 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.607558 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
alter table "staging"."public"."stg_car_sales__dbt_tmp" rename to "stg_car_sales"
[0m09:06:54.608136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:06:54.618211 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:06:54.618530 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.618808 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: COMMIT
[0m09:06:54.619471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m09:06:54.623533 [debug] [Thread-1 (]: Applying DROP to: "staging"."public"."stg_car_sales__dbt_backup"
[0m09:06:54.626898 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:06:54.627162 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */
drop view if exists "staging"."public"."stg_car_sales__dbt_backup" cascade
[0m09:06:54.627518 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:06:54.629140 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:06:54.630385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bbef197b-60d1-48cc-b654-e0151fd53201', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bb92b0>]}
[0m09:06:54.630900 [info ] [Thread-1 (]: 1 of 15 OK created sql view model public.stg_car_sales ......................... [[32mCREATE VIEW[0m in 0.07s]
[0m09:06:54.631358 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:06:54.632171 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:06:54.632486 [info ] [Thread-1 (]: 2 of 15 START test not_null_stg_car_sales_make ................................. [RUN]
[0m09:06:54.632868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.car_sales_dbt.stg_car_sales, now test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49)
[0m09:06:54.633145 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:06:54.640962 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:06:54.641904 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:06:54.653822 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:06:54.655013 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:06:54.655296 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: BEGIN
[0m09:06:54.655568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:54.659493 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:06:54.659831 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"
[0m09:06:54.660093 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select make
from "staging"."public"."stg_car_sales"
where make is null



  
  
      
    ) dbt_internal_test
[0m09:06:54.660740 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "make" does not exist
LINE 16: select make
                ^

[0m09:06:54.661034 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: ROLLBACK
[0m09:06:54.661402 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49: Close
[0m09:06:54.664320 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:06:54.664736 [error] [Thread-1 (]: 2 of 15 ERROR not_null_stg_car_sales_make ...................................... [[31mERROR[0m in 0.03s]
[0m09:06:54.665259 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:06:54.665586 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:06:54.665934 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql.
[0m09:06:54.666212 [info ] [Thread-1 (]: 3 of 15 START test not_null_stg_car_sales_model ................................ [RUN]
[0m09:06:54.667148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49, now test.car_sales_dbt.not_null_stg_car_sales_model.0739091153)
[0m09:06:54.667508 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:06:54.670605 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:06:54.671419 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:06:54.673104 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:06:54.673725 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:06:54.673960 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: BEGIN
[0m09:06:54.674175 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:54.677687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m09:06:54.677969 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"
[0m09:06:54.678205 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_model.0739091153"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select model
from "staging"."public"."stg_car_sales"
where model is null



  
  
      
    ) dbt_internal_test
[0m09:06:54.678728 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "model" does not exist
LINE 16: select model
                ^
HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".

[0m09:06:54.679011 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: ROLLBACK
[0m09:06:54.679352 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_model.0739091153: Close
[0m09:06:54.681147 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:06:54.681496 [error] [Thread-1 (]: 3 of 15 ERROR not_null_stg_car_sales_model ..................................... [[31mERROR[0m in 0.01s]
[0m09:06:54.681967 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:06:54.682445 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:06:54.682909 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql.
[0m09:06:54.683205 [info ] [Thread-1 (]: 4 of 15 START test not_null_stg_car_sales_saledate ............................. [RUN]
[0m09:06:54.684130 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.car_sales_dbt.not_null_stg_car_sales_model.0739091153, now test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a)
[0m09:06:54.684477 [debug] [Thread-1 (]: Began compiling node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:06:54.687669 [debug] [Thread-1 (]: Writing injected SQL for node "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:06:54.688520 [debug] [Thread-1 (]: Began executing node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:06:54.690200 [debug] [Thread-1 (]: Writing runtime sql for node "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:06:54.690907 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:06:54.691187 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: BEGIN
[0m09:06:54.691463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:06:54.695140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:06:54.695619 [debug] [Thread-1 (]: Using postgres connection "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"
[0m09:06:54.695943 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select saledate
from "staging"."public"."stg_car_sales"
where saledate is null



  
  
      
    ) dbt_internal_test
[0m09:06:54.696485 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "saledate" does not exist
LINE 16: select saledate
                ^

[0m09:06:54.697063 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: ROLLBACK
[0m09:06:54.697549 [debug] [Thread-1 (]: On test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a: Close
[0m09:06:54.699573 [debug] [Thread-1 (]: Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql
[0m09:06:54.700446 [error] [Thread-1 (]: 4 of 15 ERROR not_null_stg_car_sales_saledate .................................. [[31mERROR[0m in 0.02s]
[0m09:06:54.701778 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a
[0m09:06:54.702178 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a' to be skipped because of status 'error'.  Reason: Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql.
[0m09:06:54.702995 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:06:54.703335 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:06:54.703716 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:06:54.704036 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:06:54.704263 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:06:54.704522 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:06:54.705239 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:06:54.705546 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:06:54.705781 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:06:54.706037 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_car_fuel .................................... [[33mSKIP[0m]
[0m09:06:54.706649 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057
[0m09:06:54.706963 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:06:54.707189 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_fuel.96384ac057' to be skipped because of status 'skipped'. 
[0m09:06:54.707452 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_car_make .................................... [[33mSKIP[0m]
[0m09:06:54.707946 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d
[0m09:06:54.708240 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:06:54.708451 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_make.7c9674e76d' to be skipped because of status 'skipped'. 
[0m09:06:54.708728 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_car_model ................................... [[33mSKIP[0m]
[0m09:06:54.709243 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9
[0m09:06:54.709534 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:06:54.709766 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_model.ca3d1adbc9' to be skipped because of status 'skipped'. 
[0m09:06:54.710033 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_car_year ................................... [[33mSKIP[0m]
[0m09:06:54.710523 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87
[0m09:06:54.710810 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:06:54.711032 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_car_year.33253bbd87' to be skipped because of status 'skipped'. 
[0m09:06:54.711303 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:06:54.711958 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:06:54.712234 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:06:54.712440 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:06:54.712716 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_car_make ................................ [[33mSKIP[0m]
[0m09:06:54.713205 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c
[0m09:06:54.713494 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:06:54.713728 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_make.80ef3f625c' to be skipped because of status 'skipped'. 
[0m09:06:54.714001 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_car_model ............................... [[33mSKIP[0m]
[0m09:06:54.714465 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012
[0m09:06:54.714747 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:06:54.714967 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_car_model.abb7fbe012' to be skipped because of status 'skipped'. 
[0m09:06:54.715225 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:06:54.715719 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:06:54.715996 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:06:54.716205 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:06:54.716472 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:06:54.716956 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:06:54.717234 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:06:54.718135 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.718389 [debug] [MainThread]: On master: BEGIN
[0m09:06:54.718637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:06:54.722565 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:06:54.722881 [debug] [MainThread]: On master: COMMIT
[0m09:06:54.723143 [debug] [MainThread]: Using postgres connection "master"
[0m09:06:54.723387 [debug] [MainThread]: On master: COMMIT
[0m09:06:54.723732 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:06:54.723972 [debug] [MainThread]: On master: Close
[0m09:06:54.724285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:06:54.724513 [debug] [MainThread]: Connection 'test.car_sales_dbt.not_null_stg_car_sales_saledate.0fd1eeb13a' was properly closed.
[0m09:06:54.724840 [info ] [MainThread]: 
[0m09:06:54.725111 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m09:06:54.726116 [debug] [MainThread]: Command end result
[0m09:06:54.746015 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:06:54.747392 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:06:54.751649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:06:54.751894 [info ] [MainThread]: 
[0m09:06:54.752150 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m09:06:54.752657 [info ] [MainThread]: 
[0m09:06:54.752999 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_make (models/schema.yml)
  column "make" does not exist
  LINE 16: select make
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_make.sql
[0m09:06:54.753243 [info ] [MainThread]: 
[0m09:06:54.753569 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_model (models/schema.yml)
  column "model" does not exist
  LINE 16: select model
                  ^
  HINT:  Perhaps you meant to reference the column "stg_car_sales.Model".
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_model.sql
[0m09:06:54.753872 [info ] [MainThread]: 
[0m09:06:54.754221 [error] [MainThread]:   Database Error in test not_null_stg_car_sales_saledate (models/schema.yml)
  column "saledate" does not exist
  LINE 16: select saledate
                  ^
  compiled code at target/run/car_sales_dbt/models/schema.yml/not_null_stg_car_sales_saledate.sql
[0m09:06:54.754492 [info ] [MainThread]: 
[0m09:06:54.754870 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=3 SKIP=11 TOTAL=15
[0m09:06:54.755722 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9317749, "process_in_blocks": "0", "process_kernel_time": 0.147093, "process_mem_max_rss": "128544", "process_out_blocks": "8327", "process_user_time": 2.499592}
[0m09:06:54.756043 [debug] [MainThread]: Command `dbt build` failed at 09:06:54.755985 after 0.93 seconds
[0m09:06:54.756342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8270e660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8077f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82f9a330>]}
[0m09:06:54.756706 [debug] [MainThread]: Flushing usage events
[0m09:06:54.762253 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:15:40.731495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb13d4d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb30e3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0bed640>]}


============================== 09:15:40.738028 | a54bc517-6e9c-4c08-9a5c-c88a9075d868 ==============================
[0m09:15:40.738028 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:15:40.738530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:15:40.841134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a54bc517-6e9c-4c08-9a5c-c88a9075d868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf7dbbf0>]}
[0m09:15:40.876886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a54bc517-6e9c-4c08-9a5c-c88a9075d868', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb07a1a00>]}
[0m09:15:40.877563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:15:40.927656 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:15:41.001708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:15:41.002465 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m09:15:41.002839 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m09:15:41.003139 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m09:15:41.003435 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m09:15:41.230642 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.car_sales_dbt.stg_car_sales' (models/stg_car_sales.sql) depends on a source named 'raw.car_sales' which was not found
[0m09:15:41.231659 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.5352083, "process_in_blocks": "0", "process_kernel_time": 0.119832, "process_mem_max_rss": "114844", "process_out_blocks": "5157", "process_user_time": 2.197933}
[0m09:15:41.232114 [debug] [MainThread]: Command `dbt build` failed at 09:15:41.232019 after 0.54 seconds
[0m09:15:41.232488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5d3e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf5d3ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf3841a0>]}
[0m09:15:41.232841 [debug] [MainThread]: Flushing usage events
[0m09:15:41.722405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:16:34.907687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ae3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f355e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94271160>]}


============================== 09:16:34.914039 | c27f1332-92f2-43f3-a7d6-b9500e952bd3 ==============================
[0m09:16:34.914039 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:16:34.914543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m09:16:35.015600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c27f1332-92f2-43f3-a7d6-b9500e952bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cd6120>]}
[0m09:16:35.050898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c27f1332-92f2-43f3-a7d6-b9500e952bd3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9591da60>]}
[0m09:16:35.051569 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:16:35.102186 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:16:35.175596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:16:35.176400 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m09:16:35.176748 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m09:16:35.177042 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m09:16:35.177339 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m09:16:35.404967 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.car_sales_dbt.stg_car_sales' (models/stg_car_sales.sql) depends on a source named 'raw.car_sales' which was not found
[0m09:16:35.405967 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.5331184, "process_in_blocks": "0", "process_kernel_time": 0.107838, "process_mem_max_rss": "114844", "process_out_blocks": "5157", "process_user_time": 2.181732}
[0m09:16:35.406364 [debug] [MainThread]: Command `dbt build` failed at 09:16:35.406267 after 0.53 seconds
[0m09:16:35.406716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cd9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942a7710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942a74a0>]}
[0m09:16:35.407068 [debug] [MainThread]: Flushing usage events
[0m09:16:35.991015 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:22.231715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8913b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892ab590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff892ab620>]}


============================== 09:19:22.238149 | 1a7f239c-e1bc-475e-b6cb-4ce8464dc540 ==============================
[0m09:19:22.238149 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:19:22.238664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'send_anonymous_usage_stats': 'True'}
[0m09:19:22.340268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879cb470>]}
[0m09:19:22.377079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88602f30>]}
[0m09:19:22.377925 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:22.428660 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:19:22.503704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:19:22.504498 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/schema.yml
[0m09:19:22.504872 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/fact_sales.sql
[0m09:19:22.505170 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/stg_car_sales.sql
[0m09:19:22.505462 [debug] [MainThread]: Partial parsing: updated file: car_sales_dbt://models/dim_car.sql
[0m09:19:22.842850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff871471a0>]}
[0m09:19:22.900608 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:19:22.904525 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:19:22.950071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a48b60>]}
[0m09:19:22.950493 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 433 macros
[0m09:19:22.952329 [info ] [MainThread]: 
[0m09:19:22.952681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:19:22.952999 [info ] [MainThread]: 
[0m09:19:22.953397 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:22.956324 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:19:22.981736 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:19:22.982185 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:19:22.982468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:22.988222 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m09:19:22.989275 [debug] [ThreadPool]: On list_staging: Close
[0m09:19:22.990617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:19:22.995356 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:19:22.995695 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:19:22.995947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:22.999768 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:19:23.000088 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:19:23.000376 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:19:23.002569 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:19:23.004038 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:19:23.004389 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:19:23.011141 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.011448 [debug] [MainThread]: On master: BEGIN
[0m09:19:23.011738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:23.015449 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:19:23.015754 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.016089 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:23.032256 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m09:19:23.033284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85d22e40>]}
[0m09:19:23.033663 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:23.034002 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.034233 [debug] [MainThread]: On master: BEGIN
[0m09:19:23.034645 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:23.034881 [debug] [MainThread]: On master: COMMIT
[0m09:19:23.035110 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.035327 [debug] [MainThread]: On master: COMMIT
[0m09:19:23.035624 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:23.035879 [debug] [MainThread]: On master: Close
[0m09:19:23.039000 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:19:23.039415 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:19:23.039786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:19:23.040084 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:19:23.045555 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:19:23.046843 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:19:23.071435 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:19:23.072506 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:19:23.072805 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:19:23.073081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:23.076990 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:19:23.077249 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:19:23.077507 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  Manufacturer   as make,
  Model          as model,
  Sales_in_thousands      as sales_in_thousands,
  __year_resale_value     as year_resale_value,
  Vehicle_type   as vehicle_type,
  Price_in_thousands      as price_in_thousands,
  Engine_size    as engine_size,
  Horsepower     as horsepower,
  Wheelbase      as wheelbase,
  Width          as width,
  Length         as length,
  Curb_weight    as curb_weight,
  Fuel_capacity  as fuel_capacity,
  Fuel_efficiency as fuel_efficiency,
  Latest_Launch  as sale_date,
  Power_perf_factor as power_perf_factor
from "staging"."raw"."car_sales"
  );
[0m09:19:23.078040 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.car_sales" does not exist
LINE 26: from "staging"."raw"."car_sales"
              ^

[0m09:19:23.078283 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m09:19:23.078656 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:19:23.081456 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:19:23.082742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a7f239c-e1bc-475e-b6cb-4ce8464dc540', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff859eb320>]}
[0m09:19:23.083236 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.stg_car_sales ..................... [[31mERROR[0m in 0.04s]
[0m09:19:23.083720 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:19:23.084187 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m09:19:23.085112 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:19:23.085457 [info ] [Thread-1 (]: 2 of 15 SKIP test not_null_stg_car_sales_make .................................. [[33mSKIP[0m]
[0m09:19:23.085826 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:19:23.086135 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:19:23.086353 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m09:19:23.086646 [info ] [Thread-1 (]: 3 of 15 SKIP test not_null_stg_car_sales_model ................................. [[33mSKIP[0m]
[0m09:19:23.087144 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:19:23.087424 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:19:23.087669 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m09:19:23.087948 [info ] [Thread-1 (]: 4 of 15 SKIP test not_null_stg_car_sales_sale_date ............................. [[33mSKIP[0m]
[0m09:19:23.088426 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:19:23.088737 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'skipped'. 
[0m09:19:23.089263 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:19:23.089550 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:19:23.089878 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:19:23.090166 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:19:23.090375 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:19:23.090639 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:19:23.091284 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:19:23.091571 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:19:23.091778 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:19:23.092028 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_make ........................................ [[33mSKIP[0m]
[0m09:19:23.092604 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:19:23.092882 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:19:23.093101 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_make.a10286b91a' to be skipped because of status 'skipped'. 
[0m09:19:23.093362 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_model ....................................... [[33mSKIP[0m]
[0m09:19:23.093827 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:19:23.094106 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:19:23.094320 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_model.c130eac0d8' to be skipped because of status 'skipped'. 
[0m09:19:23.094597 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_power_perf_factor ........................... [[33mSKIP[0m]
[0m09:19:23.095070 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:19:23.095344 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:19:23.095563 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988' to be skipped because of status 'skipped'. 
[0m09:19:23.095822 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_year_resale_value .......................... [[33mSKIP[0m]
[0m09:19:23.096277 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:19:23.096558 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:19:23.096772 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d' to be skipped because of status 'skipped'. 
[0m09:19:23.097034 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:19:23.097470 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:19:23.097798 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:19:23.098002 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:19:23.098254 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_make .................................... [[33mSKIP[0m]
[0m09:19:23.098716 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:19:23.098996 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:19:23.099207 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1' to be skipped because of status 'skipped'. 
[0m09:19:23.099462 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_model ................................... [[33mSKIP[0m]
[0m09:19:23.099921 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:19:23.100184 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:19:23.100396 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_model.3941a44e83' to be skipped because of status 'skipped'. 
[0m09:19:23.100665 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:19:23.101104 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:19:23.101374 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:19:23.101591 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:19:23.101850 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:19:23.102302 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:19:23.102580 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:19:23.103433 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.103740 [debug] [MainThread]: On master: BEGIN
[0m09:19:23.103983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:23.107717 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:19:23.107966 [debug] [MainThread]: On master: COMMIT
[0m09:19:23.108214 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:23.108442 [debug] [MainThread]: On master: COMMIT
[0m09:19:23.108777 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:23.109008 [debug] [MainThread]: On master: Close
[0m09:19:23.109320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:23.109551 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m09:19:23.109848 [info ] [MainThread]: 
[0m09:19:23.110109 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m09:19:23.110819 [debug] [MainThread]: Command end result
[0m09:19:23.130582 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:19:23.131952 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:19:23.136046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:19:23.136281 [info ] [MainThread]: 
[0m09:19:23.136586 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:19:23.136830 [info ] [MainThread]: 
[0m09:19:23.137094 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:19:23.137339 [info ] [MainThread]: 
[0m09:19:23.137585 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m09:19:23.138283 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9413462, "process_in_blocks": "0", "process_kernel_time": 0.159305, "process_mem_max_rss": "129056", "process_out_blocks": "8311", "process_user_time": 2.668618}
[0m09:19:23.138602 [debug] [MainThread]: Command `dbt build` failed at 09:19:23.138546 after 0.94 seconds
[0m09:19:23.138873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885e7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87514200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87114890>]}
[0m09:19:23.139128 [debug] [MainThread]: Flushing usage events
[0m09:19:23.145102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:19:55.240403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaddac890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad57f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadc0af90>]}


============================== 09:19:55.246548 | b82ce32d-e86b-486a-a9b3-5c6995911cc6 ==============================
[0m09:19:55.246548 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:19:55.247025 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dbt_project/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:19:55.347739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0c42f0>]}
[0m09:19:55.382933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadef30e0>]}
[0m09:19:55.383515 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:19:55.432875 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:19:55.512032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:19:55.512423 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:19:55.542787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac381430>]}
[0m09:19:55.604501 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:19:55.608342 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:19:55.653741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac08b3e0>]}
[0m09:19:55.654181 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 433 macros
[0m09:19:55.656126 [info ] [MainThread]: 
[0m09:19:55.656452 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:19:55.656750 [info ] [MainThread]: 
[0m09:19:55.657321 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:19:55.660173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:19:55.682955 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:19:55.683331 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:19:55.683658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:19:55.688579 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:19:55.689557 [debug] [ThreadPool]: On list_staging: Close
[0m09:19:55.690918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:19:55.695524 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:19:55.695810 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:19:55.696060 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:19:55.699797 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:19:55.700107 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:19:55.700422 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:19:55.702524 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:19:55.704037 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:19:55.704460 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:19:55.710736 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.711002 [debug] [MainThread]: On master: BEGIN
[0m09:19:55.711261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:19:55.714880 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:19:55.715169 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.715521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:19:55.731535 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m09:19:55.733539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab5c2bd0>]}
[0m09:19:55.733906 [debug] [MainThread]: On master: ROLLBACK
[0m09:19:55.734261 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.734503 [debug] [MainThread]: On master: BEGIN
[0m09:19:55.734907 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:19:55.735183 [debug] [MainThread]: On master: COMMIT
[0m09:19:55.735438 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.735661 [debug] [MainThread]: On master: COMMIT
[0m09:19:55.735972 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:55.736203 [debug] [MainThread]: On master: Close
[0m09:19:55.739068 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:19:55.739501 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:19:55.739874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:19:55.740180 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:19:55.745647 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:19:55.746923 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:19:55.771087 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:19:55.772221 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:19:55.772521 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:19:55.772796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:19:55.776770 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:19:55.777107 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:19:55.777395 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  Manufacturer   as make,
  Model          as model,
  Sales_in_thousands      as sales_in_thousands,
  __year_resale_value     as year_resale_value,
  Vehicle_type   as vehicle_type,
  Price_in_thousands      as price_in_thousands,
  Engine_size    as engine_size,
  Horsepower     as horsepower,
  Wheelbase      as wheelbase,
  Width          as width,
  Length         as length,
  Curb_weight    as curb_weight,
  Fuel_capacity  as fuel_capacity,
  Fuel_efficiency as fuel_efficiency,
  Latest_Launch  as sale_date,
  Power_perf_factor as power_perf_factor
from "staging"."raw"."car_sales"
  );
[0m09:19:55.777896 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.car_sales" does not exist
LINE 26: from "staging"."raw"."car_sales"
              ^

[0m09:19:55.778181 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m09:19:55.778555 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:19:55.781179 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:19:55.782441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b82ce32d-e86b-486a-a9b3-5c6995911cc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd784d0>]}
[0m09:19:55.783003 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.stg_car_sales ..................... [[31mERROR[0m in 0.04s]
[0m09:19:55.783539 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:19:55.783953 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m09:19:55.784805 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:19:55.785153 [info ] [Thread-1 (]: 2 of 15 SKIP test not_null_stg_car_sales_make .................................. [[33mSKIP[0m]
[0m09:19:55.785648 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:19:55.786000 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:19:55.786340 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m09:19:55.786641 [info ] [Thread-1 (]: 3 of 15 SKIP test not_null_stg_car_sales_model ................................. [[33mSKIP[0m]
[0m09:19:55.787297 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:19:55.787597 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:19:55.787827 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m09:19:55.788097 [info ] [Thread-1 (]: 4 of 15 SKIP test not_null_stg_car_sales_sale_date ............................. [[33mSKIP[0m]
[0m09:19:55.788610 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:19:55.788886 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'skipped'. 
[0m09:19:55.789411 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:19:55.789696 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:19:55.790075 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:19:55.790376 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:19:55.790598 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:19:55.790857 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:19:55.791485 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:19:55.791783 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:19:55.792001 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:19:55.792287 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_make ........................................ [[33mSKIP[0m]
[0m09:19:55.792856 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:19:55.793174 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:19:55.793414 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_make.a10286b91a' to be skipped because of status 'skipped'. 
[0m09:19:55.793678 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_model ....................................... [[33mSKIP[0m]
[0m09:19:55.794246 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:19:55.794535 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:19:55.794754 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_model.c130eac0d8' to be skipped because of status 'skipped'. 
[0m09:19:55.795014 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_power_perf_factor ........................... [[33mSKIP[0m]
[0m09:19:55.795616 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:19:55.795908 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:19:55.796125 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988' to be skipped because of status 'skipped'. 
[0m09:19:55.796398 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_year_resale_value .......................... [[33mSKIP[0m]
[0m09:19:55.796882 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:19:55.797168 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:19:55.797402 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d' to be skipped because of status 'skipped'. 
[0m09:19:55.797657 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:19:55.798199 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:19:55.798497 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:19:55.798714 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:19:55.798983 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_make .................................... [[33mSKIP[0m]
[0m09:19:55.799530 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:19:55.799801 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:19:55.800016 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1' to be skipped because of status 'skipped'. 
[0m09:19:55.800287 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_model ................................... [[33mSKIP[0m]
[0m09:19:55.800881 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:19:55.801186 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:19:55.801425 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_model.3941a44e83' to be skipped because of status 'skipped'. 
[0m09:19:55.801683 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:19:55.802303 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:19:55.802582 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:19:55.802795 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:19:55.803050 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:19:55.803573 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:19:55.803872 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:19:55.804810 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.805069 [debug] [MainThread]: On master: BEGIN
[0m09:19:55.805307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:19:55.809182 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:19:55.809528 [debug] [MainThread]: On master: COMMIT
[0m09:19:55.809787 [debug] [MainThread]: Using postgres connection "master"
[0m09:19:55.810028 [debug] [MainThread]: On master: COMMIT
[0m09:19:55.810364 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:19:55.810613 [debug] [MainThread]: On master: Close
[0m09:19:55.810930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:19:55.811160 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m09:19:55.811485 [info ] [MainThread]: 
[0m09:19:55.811778 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:19:55.812802 [debug] [MainThread]: Command end result
[0m09:19:55.832365 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:19:55.833872 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:19:55.838518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:19:55.838781 [info ] [MainThread]: 
[0m09:19:55.839044 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:19:55.839412 [info ] [MainThread]: 
[0m09:19:55.839868 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:19:55.840368 [info ] [MainThread]: 
[0m09:19:55.840788 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m09:19:55.841797 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.63510454, "process_in_blocks": "0", "process_kernel_time": 0.125209, "process_mem_max_rss": "122056", "process_out_blocks": "7448", "process_user_time": 2.209695}
[0m09:19:55.842160 [debug] [MainThread]: Command `dbt build` failed at 09:19:55.842085 after 0.64 seconds
[0m09:19:55.842488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffadd2a420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae063260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad82db80>]}
[0m09:19:55.842847 [debug] [MainThread]: Flushing usage events
[0m09:19:55.848173 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:19.962936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81ed2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f83650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff847bf050>]}


============================== 09:20:19.968961 | bc92f344-7386-44b8-a0b5-d9b1caebc281 ==============================
[0m09:20:19.968961 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:20:19.969431 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dbt_project/logs', 'profiles_dir': '/home/airflow/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:20:20.069497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819e8320>]}
[0m09:20:20.104787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8211f6b0>]}
[0m09:20:20.105418 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:20:20.154147 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:20:20.233092 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:20:20.233471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:20:20.264810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819dd250>]}
[0m09:20:20.325995 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:20:20.329695 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:20:20.375056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80b07f80>]}
[0m09:20:20.375546 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 433 macros
[0m09:20:20.377365 [info ] [MainThread]: 
[0m09:20:20.377673 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:20.377896 [info ] [MainThread]: 
[0m09:20:20.378264 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:20:20.381055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:20:20.404198 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:20:20.404577 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:20:20.404920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:20.409893 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:20:20.410875 [debug] [ThreadPool]: On list_staging: Close
[0m09:20:20.411936 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:20:20.416160 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:20:20.416443 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:20:20.416685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:20:20.420266 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:20:20.420551 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:20:20.420817 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:20:20.422876 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:20:20.424229 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:20:20.424565 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:20:20.430696 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.430960 [debug] [MainThread]: On master: BEGIN
[0m09:20:20.431219 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:20:20.434687 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:20:20.434927 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.435241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:20:20.451119 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m09:20:20.453045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80eb7e60>]}
[0m09:20:20.453415 [debug] [MainThread]: On master: ROLLBACK
[0m09:20:20.453757 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.453989 [debug] [MainThread]: On master: BEGIN
[0m09:20:20.454389 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:20:20.454622 [debug] [MainThread]: On master: COMMIT
[0m09:20:20.454852 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.455076 [debug] [MainThread]: On master: COMMIT
[0m09:20:20.455381 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:20.455611 [debug] [MainThread]: On master: Close
[0m09:20:20.458341 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:20:20.458737 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:20:20.459134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:20:20.459460 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:20:20.465019 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:20:20.466326 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:20:20.490392 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:20:20.491462 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:20:20.491766 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:20:20.492051 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:20:20.495962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:20:20.496247 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:20:20.496510 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  Manufacturer   as make,
  Model          as model,
  Sales_in_thousands      as sales_in_thousands,
  __year_resale_value     as year_resale_value,
  Vehicle_type   as vehicle_type,
  Price_in_thousands      as price_in_thousands,
  Engine_size    as engine_size,
  Horsepower     as horsepower,
  Wheelbase      as wheelbase,
  Width          as width,
  Length         as length,
  Curb_weight    as curb_weight,
  Fuel_capacity  as fuel_capacity,
  Fuel_efficiency as fuel_efficiency,
  Latest_Launch  as sale_date,
  Power_perf_factor as power_perf_factor
from "staging"."raw"."car_sales"
  );
[0m09:20:20.496988 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.car_sales" does not exist
LINE 26: from "staging"."raw"."car_sales"
              ^

[0m09:20:20.497246 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m09:20:20.497602 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:20:20.500169 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:20:20.501411 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc92f344-7386-44b8-a0b5-d9b1caebc281', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826a8ad0>]}
[0m09:20:20.501979 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.stg_car_sales ..................... [[31mERROR[0m in 0.04s]
[0m09:20:20.502487 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:20:20.502901 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m09:20:20.503854 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:20:20.504187 [info ] [Thread-1 (]: 2 of 15 SKIP test not_null_stg_car_sales_make .................................. [[33mSKIP[0m]
[0m09:20:20.504514 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:20:20.504816 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:20:20.505066 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m09:20:20.505371 [info ] [Thread-1 (]: 3 of 15 SKIP test not_null_stg_car_sales_model ................................. [[33mSKIP[0m]
[0m09:20:20.505866 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:20:20.506174 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:20:20.506390 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m09:20:20.506650 [info ] [Thread-1 (]: 4 of 15 SKIP test not_null_stg_car_sales_sale_date ............................. [[33mSKIP[0m]
[0m09:20:20.507137 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:20:20.507410 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'skipped'. 
[0m09:20:20.507954 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:20:20.508253 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:20:20.508577 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:20:20.508867 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:20:20.509079 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:20:20.509341 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:20:20.509896 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:20:20.510190 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:20:20.510409 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:20:20.510659 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_make ........................................ [[33mSKIP[0m]
[0m09:20:20.511215 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:20:20.511503 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:20:20.511712 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_make.a10286b91a' to be skipped because of status 'skipped'. 
[0m09:20:20.511961 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_model ....................................... [[33mSKIP[0m]
[0m09:20:20.512411 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:20:20.512685 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:20:20.512887 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_model.c130eac0d8' to be skipped because of status 'skipped'. 
[0m09:20:20.513155 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_power_perf_factor ........................... [[33mSKIP[0m]
[0m09:20:20.513628 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:20:20.513930 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:20:20.514169 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988' to be skipped because of status 'skipped'. 
[0m09:20:20.514439 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_year_resale_value .......................... [[33mSKIP[0m]
[0m09:20:20.514901 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:20:20.515184 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:20:20.515394 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d' to be skipped because of status 'skipped'. 
[0m09:20:20.515645 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:20:20.516094 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:20:20.516366 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:20:20.516567 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:20:20.516813 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_make .................................... [[33mSKIP[0m]
[0m09:20:20.517277 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:20:20.517556 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:20:20.517759 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1' to be skipped because of status 'skipped'. 
[0m09:20:20.518007 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_model ................................... [[33mSKIP[0m]
[0m09:20:20.518458 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:20:20.518730 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:20:20.518931 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_model.3941a44e83' to be skipped because of status 'skipped'. 
[0m09:20:20.519182 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:20:20.519621 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:20:20.519891 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:20:20.520105 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:20:20.520360 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:20:20.520856 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:20:20.521125 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:20:20.521947 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.522208 [debug] [MainThread]: On master: BEGIN
[0m09:20:20.522439 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:20:20.526341 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:20:20.526589 [debug] [MainThread]: On master: COMMIT
[0m09:20:20.526831 [debug] [MainThread]: Using postgres connection "master"
[0m09:20:20.527051 [debug] [MainThread]: On master: COMMIT
[0m09:20:20.527406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:20:20.527657 [debug] [MainThread]: On master: Close
[0m09:20:20.527967 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:20.528198 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m09:20:20.528502 [info ] [MainThread]: 
[0m09:20:20.528799 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:20:20.529548 [debug] [MainThread]: Command end result
[0m09:20:20.548664 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:20:20.550035 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:20:20.554379 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:20:20.554636 [info ] [MainThread]: 
[0m09:20:20.554953 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:20:20.555263 [info ] [MainThread]: 
[0m09:20:20.555574 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:20:20.555837 [info ] [MainThread]: 
[0m09:20:20.556115 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m09:20:20.556828 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6280449, "process_in_blocks": "0", "process_kernel_time": 0.123763, "process_mem_max_rss": "122124", "process_out_blocks": "7448", "process_user_time": 2.206776}
[0m09:20:20.557179 [debug] [MainThread]: Command `dbt build` failed at 09:20:20.557112 after 0.63 seconds
[0m09:20:20.557480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff819ddd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ffc2a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff826a8ad0>]}
[0m09:20:20.557774 [debug] [MainThread]: Flushing usage events
[0m09:20:20.562727 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:21:42.639133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff950975f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff955b1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95146d20>]}


============================== 09:21:42.645486 | b2103a49-a4fb-47c4-af1d-63f4be0667d1 ==============================
[0m09:21:42.645486 [info ] [MainThread]: Running with dbt=1.9.6
[0m09:21:42.645978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/airflow/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --project-dir /opt/airflow/dbt_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:21:42.749020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94bb68d0>]}
[0m09:21:42.783935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94b1a0c0>]}
[0m09:21:42.784544 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:21:42.835612 [debug] [MainThread]: checksum: dd6dc1e5178459e3de3bf2eeb7c86bed4be2266c311fce8c15d86eb4ff94e7ad, vars: {}, profile: , target: , version: 1.9.6
[0m09:21:42.914930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:21:42.915313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:21:42.946558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e75310>]}
[0m09:21:43.007491 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:21:43.011181 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:21:43.056435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b6ff80>]}
[0m09:21:43.056843 [info ] [MainThread]: Found 3 models, 12 data tests, 1 source, 433 macros
[0m09:21:43.058619 [info ] [MainThread]: 
[0m09:21:43.058942 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:21:43.059214 [info ] [MainThread]: 
[0m09:21:43.059596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:21:43.062478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m09:21:43.085558 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m09:21:43.085939 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m09:21:43.086223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:21:43.091307 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.005 seconds
[0m09:21:43.092307 [debug] [ThreadPool]: On list_staging: Close
[0m09:21:43.093314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_public)
[0m09:21:43.097650 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:21:43.097941 [debug] [ThreadPool]: On list_staging_public: BEGIN
[0m09:21:43.098197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:21:43.101837 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:21:43.102113 [debug] [ThreadPool]: Using postgres connection "list_staging_public"
[0m09:21:43.102400 [debug] [ThreadPool]: On list_staging_public: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "list_staging_public"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m09:21:43.104460 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.002 seconds
[0m09:21:43.105802 [debug] [ThreadPool]: On list_staging_public: ROLLBACK
[0m09:21:43.106150 [debug] [ThreadPool]: On list_staging_public: Close
[0m09:21:43.112377 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.112645 [debug] [MainThread]: On master: BEGIN
[0m09:21:43.112869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:21:43.116251 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:21:43.116466 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.116756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:21:43.132511 [debug] [MainThread]: SQL status: SELECT 0 in 0.015 seconds
[0m09:21:43.134439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fdb3b0>]}
[0m09:21:43.134790 [debug] [MainThread]: On master: ROLLBACK
[0m09:21:43.135129 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.135422 [debug] [MainThread]: On master: BEGIN
[0m09:21:43.135815 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:21:43.136066 [debug] [MainThread]: On master: COMMIT
[0m09:21:43.136298 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.136533 [debug] [MainThread]: On master: COMMIT
[0m09:21:43.136840 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:21:43.137072 [debug] [MainThread]: On master: Close
[0m09:21:43.139900 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.stg_car_sales
[0m09:21:43.140305 [info ] [Thread-1 (]: 1 of 15 START sql view model public.stg_car_sales .............................. [RUN]
[0m09:21:43.140692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public, now model.car_sales_dbt.stg_car_sales)
[0m09:21:43.140981 [debug] [Thread-1 (]: Began compiling node model.car_sales_dbt.stg_car_sales
[0m09:21:43.146421 [debug] [Thread-1 (]: Writing injected SQL for node "model.car_sales_dbt.stg_car_sales"
[0m09:21:43.147692 [debug] [Thread-1 (]: Began executing node model.car_sales_dbt.stg_car_sales
[0m09:21:43.172444 [debug] [Thread-1 (]: Writing runtime sql for node "model.car_sales_dbt.stg_car_sales"
[0m09:21:43.173494 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:21:43.173785 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: BEGIN
[0m09:21:43.174076 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:21:43.177935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m09:21:43.178236 [debug] [Thread-1 (]: Using postgres connection "model.car_sales_dbt.stg_car_sales"
[0m09:21:43.178509 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: /* {"app": "dbt", "dbt_version": "1.9.6", "profile_name": "default", "target_name": "dev", "node_id": "model.car_sales_dbt.stg_car_sales"} */

  create view "staging"."public"."stg_car_sales__dbt_tmp"
    
    
  as (
    

select
  Manufacturer   as make,
  Model          as model,
  Sales_in_thousands      as sales_in_thousands,
  __year_resale_value     as year_resale_value,
  Vehicle_type   as vehicle_type,
  Price_in_thousands      as price_in_thousands,
  Engine_size    as engine_size,
  Horsepower     as horsepower,
  Wheelbase      as wheelbase,
  Width          as width,
  Length         as length,
  Curb_weight    as curb_weight,
  Fuel_capacity  as fuel_capacity,
  Fuel_efficiency as fuel_efficiency,
  Latest_Launch  as sale_date,
  Power_perf_factor as power_perf_factor
from "staging"."raw"."car_sales"
  );
[0m09:21:43.178974 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.car_sales" does not exist
LINE 26: from "staging"."raw"."car_sales"
              ^

[0m09:21:43.179217 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: ROLLBACK
[0m09:21:43.179576 [debug] [Thread-1 (]: On model.car_sales_dbt.stg_car_sales: Close
[0m09:21:43.182227 [debug] [Thread-1 (]: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:21:43.183492 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2103a49-a4fb-47c4-af1d-63f4be0667d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92e6f9b0>]}
[0m09:21:43.184026 [error] [Thread-1 (]: 1 of 15 ERROR creating sql view model public.stg_car_sales ..................... [[31mERROR[0m in 0.04s]
[0m09:21:43.184627 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.stg_car_sales
[0m09:21:43.185046 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.stg_car_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql.
[0m09:21:43.185939 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:21:43.186282 [info ] [Thread-1 (]: 2 of 15 SKIP test not_null_stg_car_sales_make .................................. [[33mSKIP[0m]
[0m09:21:43.186642 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49
[0m09:21:43.186972 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:21:43.187200 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_make.24aa4d2c49' to be skipped because of status 'skipped'. 
[0m09:21:43.187495 [info ] [Thread-1 (]: 3 of 15 SKIP test not_null_stg_car_sales_model ................................. [[33mSKIP[0m]
[0m09:21:43.187971 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_model.0739091153
[0m09:21:43.188265 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:21:43.188489 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_model.0739091153' to be skipped because of status 'skipped'. 
[0m09:21:43.188737 [info ] [Thread-1 (]: 4 of 15 SKIP test not_null_stg_car_sales_sale_date ............................. [[33mSKIP[0m]
[0m09:21:43.189212 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02
[0m09:21:43.189502 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_stg_car_sales_sale_date.cf4ed58a02' to be skipped because of status 'skipped'. 
[0m09:21:43.190043 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.dim_car
[0m09:21:43.190318 [info ] [Thread-1 (]: 5 of 15 SKIP relation public.dim_car ........................................... [[33mSKIP[0m]
[0m09:21:43.190643 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.dim_car
[0m09:21:43.190945 [debug] [Thread-1 (]: Began running node model.car_sales_dbt.fact_sales
[0m09:21:43.191161 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.dim_car' to be skipped because of status 'skipped'. 
[0m09:21:43.191421 [info ] [Thread-1 (]: 6 of 15 SKIP relation public.fact_sales ........................................ [[33mSKIP[0m]
[0m09:21:43.191944 [debug] [Thread-1 (]: Finished running node model.car_sales_dbt.fact_sales
[0m09:21:43.192250 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:21:43.192474 [debug] [Thread-4 (]: Marking all children of 'model.car_sales_dbt.fact_sales' to be skipped because of status 'skipped'. 
[0m09:21:43.192731 [info ] [Thread-1 (]: 7 of 15 SKIP test not_null_dim_car_make ........................................ [[33mSKIP[0m]
[0m09:21:43.193262 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_make.a10286b91a
[0m09:21:43.193566 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:21:43.193773 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_make.a10286b91a' to be skipped because of status 'skipped'. 
[0m09:21:43.194021 [info ] [Thread-1 (]: 8 of 15 SKIP test not_null_dim_car_model ....................................... [[33mSKIP[0m]
[0m09:21:43.194482 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_model.c130eac0d8
[0m09:21:43.194761 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:21:43.194967 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_model.c130eac0d8' to be skipped because of status 'skipped'. 
[0m09:21:43.195233 [info ] [Thread-1 (]: 9 of 15 SKIP test not_null_dim_car_power_perf_factor ........................... [[33mSKIP[0m]
[0m09:21:43.195691 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988
[0m09:21:43.196005 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:21:43.196216 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_power_perf_factor.00a452d988' to be skipped because of status 'skipped'. 
[0m09:21:43.196490 [info ] [Thread-1 (]: 10 of 15 SKIP test not_null_dim_car_year_resale_value .......................... [[33mSKIP[0m]
[0m09:21:43.196931 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d
[0m09:21:43.197200 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:21:43.197433 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_dim_car_year_resale_value.1a4ded615d' to be skipped because of status 'skipped'. 
[0m09:21:43.197727 [info ] [Thread-1 (]: 11 of 15 SKIP test not_null_fact_sales_avg_price ............................... [[33mSKIP[0m]
[0m09:21:43.198165 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e
[0m09:21:43.198451 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:21:43.198653 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_avg_price.139b83ff4e' to be skipped because of status 'skipped'. 
[0m09:21:43.198904 [info ] [Thread-1 (]: 12 of 15 SKIP test not_null_fact_sales_make .................................... [[33mSKIP[0m]
[0m09:21:43.199336 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1
[0m09:21:43.199621 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:21:43.199823 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_make.2ddf6574f1' to be skipped because of status 'skipped'. 
[0m09:21:43.200070 [info ] [Thread-1 (]: 13 of 15 SKIP test not_null_fact_sales_model ................................... [[33mSKIP[0m]
[0m09:21:43.200509 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_model.3941a44e83
[0m09:21:43.200776 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:21:43.200979 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_model.3941a44e83' to be skipped because of status 'skipped'. 
[0m09:21:43.201225 [info ] [Thread-1 (]: 14 of 15 SKIP test not_null_fact_sales_sale_month .............................. [[33mSKIP[0m]
[0m09:21:43.201660 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6
[0m09:21:43.201935 [debug] [Thread-1 (]: Began running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:21:43.202136 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_sale_month.ea5e70c4e6' to be skipped because of status 'skipped'. 
[0m09:21:43.202383 [info ] [Thread-1 (]: 15 of 15 SKIP test not_null_fact_sales_total_sales ............................. [[33mSKIP[0m]
[0m09:21:43.202851 [debug] [Thread-1 (]: Finished running node test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531
[0m09:21:43.203126 [debug] [Thread-4 (]: Marking all children of 'test.car_sales_dbt.not_null_fact_sales_total_sales.2feb308531' to be skipped because of status 'skipped'. 
[0m09:21:43.204025 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.204275 [debug] [MainThread]: On master: BEGIN
[0m09:21:43.204523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:21:43.208194 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m09:21:43.208444 [debug] [MainThread]: On master: COMMIT
[0m09:21:43.208680 [debug] [MainThread]: Using postgres connection "master"
[0m09:21:43.208895 [debug] [MainThread]: On master: COMMIT
[0m09:21:43.209194 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:21:43.209462 [debug] [MainThread]: On master: Close
[0m09:21:43.209766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:21:43.209984 [debug] [MainThread]: Connection 'model.car_sales_dbt.stg_car_sales' was properly closed.
[0m09:21:43.210270 [info ] [MainThread]: 
[0m09:21:43.210525 [info ] [MainThread]: Finished running 2 table models, 12 data tests, 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m09:21:43.211216 [debug] [MainThread]: Command end result
[0m09:21:43.230255 [debug] [MainThread]: Wrote artifact WritableManifest to /opt/airflow/dbt_project/target/manifest.json
[0m09:21:43.231555 [debug] [MainThread]: Wrote artifact SemanticManifest to /opt/airflow/dbt_project/target/semantic_manifest.json
[0m09:21:43.235739 [debug] [MainThread]: Wrote artifact RunExecutionResult to /opt/airflow/dbt_project/target/run_results.json
[0m09:21:43.235970 [info ] [MainThread]: 
[0m09:21:43.236230 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:21:43.236452 [info ] [MainThread]: 
[0m09:21:43.236711 [error] [MainThread]:   Database Error in model stg_car_sales (models/stg_car_sales.sql)
  relation "raw.car_sales" does not exist
  LINE 26: from "staging"."raw"."car_sales"
                ^
  compiled code at target/run/car_sales_dbt/models/stg_car_sales.sql
[0m09:21:43.236917 [info ] [MainThread]: 
[0m09:21:43.237143 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=14 TOTAL=15
[0m09:21:43.237806 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.6328829, "process_in_blocks": "0", "process_kernel_time": 0.119138, "process_mem_max_rss": "122104", "process_out_blocks": "7448", "process_user_time": 2.229591}
[0m09:21:43.238124 [debug] [MainThread]: Command `dbt build` failed at 09:21:43.238069 after 0.63 seconds
[0m09:21:43.238492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff953c7ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9566b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959928d0>]}
[0m09:21:43.238860 [debug] [MainThread]: Flushing usage events
[0m09:21:43.243941 [debug] [MainThread]: An error was encountered while trying to flush usage events
